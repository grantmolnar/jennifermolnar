<!DOCTYPE html>
<html class="staticrypt-html">
    <head>
        <meta charset="utf-8" />
        <title>Private preview</title>
        <meta name="viewport" content="width=device-width, initial-scale=1" />

        <!-- do not cache this page -->
        <meta http-equiv="cache-control" content="max-age=0" />
        <meta http-equiv="cache-control" content="no-cache" />
        <meta http-equiv="expires" content="0" />
        <meta http-equiv="expires" content="Tue, 01 Jan 1980 1:00:00 GMT" />
        <meta http-equiv="pragma" content="no-cache" />

        <style>
            .staticrypt-hr {
                margin-top: 20px;
                margin-bottom: 20px;
                border: 0;
                border-top: 1px solid #eee;
            }

            .staticrypt-page {
                width: 360px;
                padding: 8% 0 0;
                margin: auto;
                box-sizing: border-box;
            }

            .staticrypt-form {
                position: relative;
                z-index: 1;
                background: #ffffff;
                max-width: 360px;
                margin: 0 auto 100px;
                padding: 45px;
                text-align: center;
                box-shadow: 0 0 20px 0 rgba(0, 0, 0, 0.2), 0 5px 5px 0 rgba(0, 0, 0, 0.24);
            }

            .staticrypt-form input[type="password"],
            input[type="text"] {
                background: inherit;
                border: 0;
                box-sizing: border-box; /* This ensures padding is included in the total width */
                font-size: 14px;
                outline: 0;
                padding: 15px 30px 15px 15px; /* Adjust the padding to ensure there is space for the icon */
                width: 100%;
            }

            .staticrypt-password-container {
                position: relative;
                outline: 0;
                background: #f2f2f2;
                width: 100%;
                border: 0;
                margin: 0 0 15px;
                box-sizing: border-box;
            }

            .staticrypt-toggle-password-visibility {
                cursor: pointer;
                height: 20px;
                opacity: 60%;
                padding: 13px;
                position: absolute;
                right: 0;
                top: 50%;
                transform: translateY(-50%);
                width: 20px;
            }

            .staticrypt-form .staticrypt-decrypt-button {
                text-transform: uppercase;
                outline: 0;
                background: #4CAF50;
                width: 100%;
                border: 0;
                padding: 15px;
                color: #ffffff;
                font-size: 14px;
                cursor: pointer;
            }

            .staticrypt-form .staticrypt-decrypt-button:hover,
            .staticrypt-form .staticrypt-decrypt-button:active,
            .staticrypt-form .staticrypt-decrypt-button:focus {
                background: #4CAF50;
                filter: brightness(92%);
            }

            .staticrypt-html {
                height: 100%;
            }

            .staticrypt-body {
                height: 100%;
                margin: 0;
            }

            .staticrypt-content {
                height: 100%;
                margin-bottom: 1em;
                background: #76B852;
                font-family: "Arial", sans-serif;
                -webkit-font-smoothing: antialiased;
                -moz-osx-font-smoothing: grayscale;
            }

            .staticrypt-instructions {
                margin-top: -1em;
                margin-bottom: 1em;
            }

            .staticrypt-title {
                font-size: 1.5em;
            }

            label.staticrypt-remember {
                display: flex;
                align-items: center;
                margin-bottom: 1em;
            }

            .staticrypt-remember input[type="checkbox"] {
                transform: scale(1.5);
                margin-right: 1em;
            }

            .hidden {
                display: none !important;
            }

            .staticrypt-spinner-container {
                height: 100%;
                display: flex;
                align-items: center;
                justify-content: center;
            }

            .staticrypt-spinner {
                display: inline-block;
                width: 2rem;
                height: 2rem;
                vertical-align: text-bottom;
                border: 0.25em solid gray;
                border-right-color: transparent;
                border-radius: 50%;
                -webkit-animation: spinner-border 0.75s linear infinite;
                animation: spinner-border 0.75s linear infinite;
                animation-duration: 0.75s;
                animation-timing-function: linear;
                animation-delay: 0s;
                animation-iteration-count: infinite;
                animation-direction: normal;
                animation-fill-mode: none;
                animation-play-state: running;
                animation-name: spinner-border;
            }

            @keyframes spinner-border {
                100% {
                    transform: rotate(360deg);
                }
            }

            @media screen and (-webkit-min-device-pixel-ratio: 0) {
                .staticrypt-form input[type="password"],
                input[type="text"] {
                    font-size: 16px;
                }
            }
        </style>
    </head>

    <body class="staticrypt-body">
        <div id="staticrypt_loading" class="staticrypt-spinner-container">
            <div class="staticrypt-spinner"></div>
        </div>

        <div id="staticrypt_content" class="staticrypt-content hidden">
            <div class="staticrypt-page">
                <div class="staticrypt-form">
                    <div class="staticrypt-instructions">
                        <p class="staticrypt-title">Private preview</p>
                        <p>Enter the preview password.</p>
                    </div>

                    <hr class="staticrypt-hr" />

                    <form id="staticrypt-form" action="#" method="post">
                        <div class="staticrypt-password-container">
                            <input
                                id="staticrypt-password"
                                type="password"
                                name="password"
                                placeholder="Password"
                                autofocus
                            />

                            <img
                                class="staticrypt-toggle-password-visibility"
                                alt="Show password"
                                title="Show password"
                                src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA2NDAgNTEyIj48IS0tIUZvbnQgQXdlc29tZSBGcmVlIDYuNS4yIGJ5IEBmb250YXdlc29tZSAtIGh0dHBzOi8vZm9udGF3ZXNvbWUuY29tIExpY2Vuc2UgLSBodHRwczovL2ZvbnRhd2Vzb21lLmNvbS9saWNlbnNlL2ZyZWUgQ29weXJpZ2h0IDIwMjQgRm9udGljb25zLCBJbmMuLS0+PHBhdGggZD0iTTM4LjggNS4xQzI4LjQtMy4xIDEzLjMtMS4yIDUuMSA5LjJTLTEuMiAzNC43IDkuMiA0Mi45bDU5MiA0NjRjMTAuNCA4LjIgMjUuNSA2LjMgMzMuNy00LjFzNi4zLTI1LjUtNC4xLTMzLjdMNTI1LjYgMzg2LjdjMzkuNi00MC42IDY2LjQtODYuMSA3OS45LTExOC40YzMuMy03LjkgMy4zLTE2LjcgMC0yNC42Yy0xNC45LTM1LjctNDYuMi04Ny43LTkzLTEzMS4xQzQ2NS41IDY4LjggNDAwLjggMzIgMzIwIDMyYy02OC4yIDAtMTI1IDI2LjMtMTY5LjMgNjAuOEwzOC44IDUuMXpNMjIzLjEgMTQ5LjVDMjQ4LjYgMTI2LjIgMjgyLjcgMTEyIDMyMCAxMTJjNzkuNSAwIDE0NCA2NC41IDE0NCAxNDRjMCAyNC45LTYuMyA0OC4zLTE3LjQgNjguN0w0MDggMjk0LjVjOC40LTE5LjMgMTAuNi00MS40IDQuOC02My4zYy0xMS4xLTQxLjUtNDcuOC02OS40LTg4LjYtNzEuMWMtNS44LS4yLTkuMiA2LjEtNy40IDExLjdjMi4xIDYuNCAzLjMgMTMuMiAzLjMgMjAuM2MwIDEwLjItMi40IDE5LjgtNi42IDI4LjNsLTkwLjMtNzAuOHpNMzczIDM4OS45Yy0xNi40IDYuNS0zNC4zIDEwLjEtNTMgMTAuMWMtNzkuNSAwLTE0NC02NC41LTE0NC0xNDRjMC02LjkgLjUtMTMuNiAxLjQtMjAuMkw4My4xIDE2MS41QzYwLjMgMTkxLjIgNDQgMjIwLjggMzQuNSAyNDMuN2MtMy4zIDcuOS0zLjMgMTYuNyAwIDI0LjZjMTQuOSAzNS43IDQ2LjIgODcuNyA5MyAxMzEuMUMxNzQuNSA0NDMuMiAyMzkuMiA0ODAgMzIwIDQ4MGM0Ny44IDAgODkuOS0xMi45IDEyNi4yLTMyLjVMMzczIDM4OS45eiIvPjwvc3ZnPg=="
                            />
                        </div>

                        <label id="staticrypt-remember-label" class="staticrypt-remember hidden">
                            <input id="staticrypt-remember" type="checkbox" name="remember" />
                            Remember me
                        </label>

                        <input type="submit" class="staticrypt-decrypt-button" value="DECRYPT" />
                    </form>
                </div>
            </div>
        </div>

        <script>
            // these variables will be filled when generating the file - the template format is 'variable_name'
            const staticryptInitiator = ((function(){
  const exports = {};
  const cryptoEngine = ((function(){
  const exports = {};
  const { subtle } = crypto;

const IV_BITS = 16 * 8;
const HEX_BITS = 4;
const ENCRYPTION_ALGO = "AES-CBC";

/**
 * Translates between utf8 encoded hexadecimal strings
 * and Uint8Array bytes.
 */
const HexEncoder = {
    /**
     * hex string -> bytes
     * @param {string} hexString
     * @returns {Uint8Array}
     */
    parse: function (hexString) {
        if (hexString.length % 2 !== 0) throw "Invalid hexString";
        const arrayBuffer = new Uint8Array(hexString.length / 2);

        for (let i = 0; i < hexString.length; i += 2) {
            const byteValue = parseInt(hexString.substring(i, i + 2), 16);
            if (isNaN(byteValue)) {
                throw "Invalid hexString";
            }
            arrayBuffer[i / 2] = byteValue;
        }
        return arrayBuffer;
    },

    /**
     * bytes -> hex string
     * @param {Uint8Array} bytes
     * @returns {string}
     */
    stringify: function (bytes) {
        const hexBytes = [];

        for (let i = 0; i < bytes.length; ++i) {
            let byteString = bytes[i].toString(16);
            if (byteString.length < 2) {
                byteString = "0" + byteString;
            }
            hexBytes.push(byteString);
        }
        return hexBytes.join("");
    },
};

/**
 * Translates between utf8 strings and Uint8Array bytes.
 */
const UTF8Encoder = {
    parse: function (str) {
        return new TextEncoder().encode(str);
    },

    stringify: function (bytes) {
        return new TextDecoder().decode(bytes);
    },
};

/**
 * Salt and encrypt a msg with a password.
 */
async function encrypt(msg, hashedPassword) {
    // Must be 16 bytes, unpredictable, and preferably cryptographically random. However, it need not be secret.
    // https://developer.mozilla.org/en-US/docs/Web/API/SubtleCrypto/encrypt#parameters
    const iv = crypto.getRandomValues(new Uint8Array(IV_BITS / 8));

    const key = await subtle.importKey("raw", HexEncoder.parse(hashedPassword), ENCRYPTION_ALGO, false, ["encrypt"]);

    const encrypted = await subtle.encrypt(
        {
            name: ENCRYPTION_ALGO,
            iv: iv,
        },
        key,
        UTF8Encoder.parse(msg)
    );

    // iv will be 32 hex characters, we prepend it to the ciphertext for use in decryption
    return HexEncoder.stringify(iv) + HexEncoder.stringify(new Uint8Array(encrypted));
}
exports.encrypt = encrypt;

/**
 * Decrypt a salted msg using a password.
 *
 * @param {string} encryptedMsg
 * @param {string} hashedPassword
 * @returns {Promise<string>}
 */
async function decrypt(encryptedMsg, hashedPassword) {
    const ivLength = IV_BITS / HEX_BITS;
    const iv = HexEncoder.parse(encryptedMsg.substring(0, ivLength));
    const encrypted = encryptedMsg.substring(ivLength);

    const key = await subtle.importKey("raw", HexEncoder.parse(hashedPassword), ENCRYPTION_ALGO, false, ["decrypt"]);

    const outBuffer = await subtle.decrypt(
        {
            name: ENCRYPTION_ALGO,
            iv: iv,
        },
        key,
        HexEncoder.parse(encrypted)
    );

    return UTF8Encoder.stringify(new Uint8Array(outBuffer));
}
exports.decrypt = decrypt;

/**
 * Salt and hash the password so it can be stored in localStorage without opening a password reuse vulnerability.
 *
 * @param {string} password
 * @param {string} salt
 * @returns {Promise<string>}
 */
async function hashPassword(password, salt) {
    // we hash the password in multiple steps, each adding more iterations. This is because we used to allow less
    // iterations, so for backward compatibility reasons, we need to support going from that to more iterations.
    let hashedPassword = await hashLegacyRound(password, salt);

    hashedPassword = await hashSecondRound(hashedPassword, salt);

    return hashThirdRound(hashedPassword, salt);
}
exports.hashPassword = hashPassword;

/**
 * This hashes the password with 1k iterations. This is a low number, we need this function to support backwards
 * compatibility.
 *
 * @param {string} password
 * @param {string} salt
 * @returns {Promise<string>}
 */
function hashLegacyRound(password, salt) {
    return pbkdf2(password, salt, 1000, "SHA-1");
}
exports.hashLegacyRound = hashLegacyRound;

/**
 * Add a second round of iterations. This is because we used to use 1k, so for backwards compatibility with
 * remember-me/autodecrypt links, we need to support going from that to more iterations.
 *
 * @param hashedPassword
 * @param salt
 * @returns {Promise<string>}
 */
function hashSecondRound(hashedPassword, salt) {
    return pbkdf2(hashedPassword, salt, 14000, "SHA-256");
}
exports.hashSecondRound = hashSecondRound;

/**
 * Add a third round of iterations to bring total number to 600k. This is because we used to use 1k, then 15k, so for
 * backwards compatibility with remember-me/autodecrypt links, we need to support going from that to more iterations.
 *
 * @param hashedPassword
 * @param salt
 * @returns {Promise<string>}
 */
function hashThirdRound(hashedPassword, salt) {
    return pbkdf2(hashedPassword, salt, 585000, "SHA-256");
}
exports.hashThirdRound = hashThirdRound;

/**
 * Salt and hash the password so it can be stored in localStorage without opening a password reuse vulnerability.
 *
 * @param {string} password
 * @param {string} salt
 * @param {int} iterations
 * @param {string} hashAlgorithm
 * @returns {Promise<string>}
 */
async function pbkdf2(password, salt, iterations, hashAlgorithm) {
    const key = await subtle.importKey("raw", UTF8Encoder.parse(password), "PBKDF2", false, ["deriveBits"]);

    const keyBytes = await subtle.deriveBits(
        {
            name: "PBKDF2",
            hash: hashAlgorithm,
            iterations,
            salt: UTF8Encoder.parse(salt),
        },
        key,
        256
    );

    return HexEncoder.stringify(new Uint8Array(keyBytes));
}

function generateRandomSalt() {
    const bytes = crypto.getRandomValues(new Uint8Array(128 / 8));

    return HexEncoder.stringify(new Uint8Array(bytes));
}
exports.generateRandomSalt = generateRandomSalt;

async function signMessage(hashedPassword, message) {
    const key = await subtle.importKey(
        "raw",
        HexEncoder.parse(hashedPassword),
        {
            name: "HMAC",
            hash: "SHA-256",
        },
        false,
        ["sign"]
    );
    const signature = await subtle.sign("HMAC", key, UTF8Encoder.parse(message));

    return HexEncoder.stringify(new Uint8Array(signature));
}
exports.signMessage = signMessage;

function getRandomAlphanum() {
    const possibleCharacters = "abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789";

    let byteArray;
    let parsedInt;

    // Keep generating new random bytes until we get a value that falls
    // within a range that can be evenly divided by possibleCharacters.length
    do {
        byteArray = crypto.getRandomValues(new Uint8Array(1));
        // extract the lowest byte to get an int from 0 to 255 (probably unnecessary, since we're only generating 1 byte)
        parsedInt = byteArray[0] & 0xff;
    } while (parsedInt >= 256 - (256 % possibleCharacters.length));

    // Take the modulo of the parsed integer to get a random number between 0 and totalLength - 1
    const randomIndex = parsedInt % possibleCharacters.length;

    return possibleCharacters[randomIndex];
}

/**
 * Generate a random string of a given length.
 *
 * @param {int} length
 * @returns {string}
 */
function generateRandomString(length) {
    let randomString = "";

    for (let i = 0; i < length; i++) {
        randomString += getRandomAlphanum();
    }

    return randomString;
}
exports.generateRandomString = generateRandomString;

  return exports;
})());
const codec = ((function(){
  const exports = {};
  /**
 * Initialize the codec with the provided cryptoEngine - this return functions to encode and decode messages.
 *
 * @param cryptoEngine - the engine to use for encryption / decryption
 */
function init(cryptoEngine) {
    const exports = {};

    /**
     * Top-level function for encoding a message.
     * Includes password hashing, encryption, and signing.
     *
     * @param {string} msg
     * @param {string} password
     * @param {string} salt
     *
     * @returns {string} The encoded text
     */
    async function encode(msg, password, salt) {
        const hashedPassword = await cryptoEngine.hashPassword(password, salt);

        const encrypted = await cryptoEngine.encrypt(msg, hashedPassword);

        // we use the hashed password in the HMAC because this is effectively what will be used a password (so we can store
        // it in localStorage safely, we don't use the clear text password)
        const hmac = await cryptoEngine.signMessage(hashedPassword, encrypted);

        return hmac + encrypted;
    }
    exports.encode = encode;

    /**
     * Encode using a password that has already been hashed. This is useful to encode multiple messages in a row, that way
     * we don't need to hash the password multiple times.
     *
     * @param {string} msg
     * @param {string} hashedPassword
     *
     * @returns {string} The encoded text
     */
    async function encodeWithHashedPassword(msg, hashedPassword) {
        const encrypted = await cryptoEngine.encrypt(msg, hashedPassword);

        // we use the hashed password in the HMAC because this is effectively what will be used a password (so we can store
        // it in localStorage safely, we don't use the clear text password)
        const hmac = await cryptoEngine.signMessage(hashedPassword, encrypted);

        return hmac + encrypted;
    }
    exports.encodeWithHashedPassword = encodeWithHashedPassword;

    /**
     * Top-level function for decoding a message.
     * Includes signature check and decryption.
     *
     * @param {string} signedMsg
     * @param {string} hashedPassword
     * @param {string} salt
     * @param {int} backwardCompatibleAttempt
     * @param {string} originalPassword
     *
     * @returns {Object} {success: true, decoded: string} | {success: false, message: string}
     */
    async function decode(signedMsg, hashedPassword, salt, backwardCompatibleAttempt = 0, originalPassword = "") {
        const encryptedHMAC = signedMsg.substring(0, 64);
        const encryptedMsg = signedMsg.substring(64);
        const decryptedHMAC = await cryptoEngine.signMessage(hashedPassword, encryptedMsg);

        if (decryptedHMAC !== encryptedHMAC) {
            // we have been raising the number of iterations in the hashing algorithm multiple times, so to support the old
            // remember-me/autodecrypt links we need to try bringing the old hashes up to speed.
            originalPassword = originalPassword || hashedPassword;
            if (backwardCompatibleAttempt === 0) {
                const updatedHashedPassword = await cryptoEngine.hashThirdRound(originalPassword, salt);

                return decode(signedMsg, updatedHashedPassword, salt, backwardCompatibleAttempt + 1, originalPassword);
            }
            if (backwardCompatibleAttempt === 1) {
                let updatedHashedPassword = await cryptoEngine.hashSecondRound(originalPassword, salt);
                updatedHashedPassword = await cryptoEngine.hashThirdRound(updatedHashedPassword, salt);

                return decode(signedMsg, updatedHashedPassword, salt, backwardCompatibleAttempt + 1, originalPassword);
            }

            return { success: false, message: "Signature mismatch" };
        }

        return {
            success: true,
            decoded: await cryptoEngine.decrypt(encryptedMsg, hashedPassword),
        };
    }
    exports.decode = decode;

    return exports;
}
exports.init = init;

  return exports;
})());
const decode = codec.init(cryptoEngine).decode;

/**
 * Initialize the staticrypt module, that exposes functions callbable by the password_template.
 *
 * @param {{
 *  staticryptEncryptedMsgUniqueVariableName: string,
 *  isRememberEnabled: boolean,
 *  rememberDurationInDays: number,
 *  staticryptSaltUniqueVariableName: string,
 * }} staticryptConfig - object of data that is stored on the password_template at encryption time.
 *
 * @param {{
 *  rememberExpirationKey: string,
 *  rememberPassphraseKey: string,
 *  replaceHtmlCallback: function,
 *  clearLocalStorageCallback: function,
 * }} templateConfig - object of data that can be configured by a custom password_template.
 */
function init(staticryptConfig, templateConfig) {
    const exports = {};

    /**
     * Decrypt our encrypted page, replace the whole HTML.
     *
     * @param {string} hashedPassword
     * @returns {Promise<boolean>}
     */
    async function decryptAndReplaceHtml(hashedPassword) {
        const { staticryptEncryptedMsgUniqueVariableName, staticryptSaltUniqueVariableName } = staticryptConfig;
        const { replaceHtmlCallback } = templateConfig;

        const result = await decode(
            staticryptEncryptedMsgUniqueVariableName,
            hashedPassword,
            staticryptSaltUniqueVariableName
        );
        if (!result.success) {
            return false;
        }
        const plainHTML = result.decoded;

        // if the user configured a callback call it, otherwise just replace the whole HTML
        if (typeof replaceHtmlCallback === "function") {
            replaceHtmlCallback(plainHTML);
        } else {
            document.write(plainHTML);
            document.close();
        }

        return true;
    }

    /**
     * Attempt to decrypt the page and replace the whole HTML.
     *
     * @param {string} password
     * @param {boolean} isRememberChecked
     *
     * @returns {Promise<{isSuccessful: boolean, hashedPassword?: string}>} - we return an object, so that if we want to
     *   expose more information in the future we can do it without breaking the password_template
     */
    async function handleDecryptionOfPage(password, isRememberChecked) {
        const { staticryptSaltUniqueVariableName } = staticryptConfig;

        // decrypt and replace the whole page
        const hashedPassword = await cryptoEngine.hashPassword(password, staticryptSaltUniqueVariableName);
        return handleDecryptionOfPageFromHash(hashedPassword, isRememberChecked);
    }
    exports.handleDecryptionOfPage = handleDecryptionOfPage;

    async function handleDecryptionOfPageFromHash(hashedPassword, isRememberChecked) {
        const { isRememberEnabled, rememberDurationInDays } = staticryptConfig;
        const { rememberExpirationKey, rememberPassphraseKey } = templateConfig;

        const isDecryptionSuccessful = await decryptAndReplaceHtml(hashedPassword);

        if (!isDecryptionSuccessful) {
            return {
                isSuccessful: false,
                hashedPassword,
            };
        }

        // remember the hashedPassword and set its expiration if necessary
        if (isRememberEnabled && isRememberChecked) {
            window.localStorage.setItem(rememberPassphraseKey, hashedPassword);

            // set the expiration if the duration isn't 0 (meaning no expiration)
            if (rememberDurationInDays > 0) {
                window.localStorage.setItem(
                    rememberExpirationKey,
                    (new Date().getTime() + rememberDurationInDays * 24 * 60 * 60 * 1000).toString()
                );
            }
        }

        return {
            isSuccessful: true,
            hashedPassword,
        };
    }
    exports.handleDecryptionOfPageFromHash = handleDecryptionOfPageFromHash;

    /**
     * Clear localstorage from staticrypt related values
     */
    function clearLocalStorage() {
        const { clearLocalStorageCallback, rememberExpirationKey, rememberPassphraseKey } = templateConfig;

        if (typeof clearLocalStorageCallback === "function") {
            clearLocalStorageCallback();
        } else {
            localStorage.removeItem(rememberPassphraseKey);
            localStorage.removeItem(rememberExpirationKey);
        }
    }

    async function handleDecryptOnLoad() {
        let isSuccessful = await decryptOnLoadFromUrl();

        if (!isSuccessful) {
            isSuccessful = await decryptOnLoadFromRememberMe();
        }

        return { isSuccessful };
    }
    exports.handleDecryptOnLoad = handleDecryptOnLoad;

    /**
     * Clear storage if we are logging out
     *
     * @returns {boolean} - whether we logged out
     */
    function logoutIfNeeded() {
        const logoutKey = "staticrypt_logout";

        // handle logout through query param
        const queryParams = new URLSearchParams(window.location.search);
        if (queryParams.has(logoutKey)) {
            clearLocalStorage();
            return true;
        }

        // handle logout through URL fragment
        const hash = window.location.hash.substring(1);
        if (hash.includes(logoutKey)) {
            clearLocalStorage();
            return true;
        }

        return false;
    }

    /**
     * To be called on load: check if we want to try to decrypt and replace the HTML with the decrypted content, and
     * try to do it if needed.
     *
     * @returns {Promise<boolean>} true if we derypted and replaced the whole page, false otherwise
     */
    async function decryptOnLoadFromRememberMe() {
        const { rememberDurationInDays } = staticryptConfig;
        const { rememberExpirationKey, rememberPassphraseKey } = templateConfig;

        // if we are login out, terminate
        if (logoutIfNeeded()) {
            return false;
        }

        // if there is expiration configured, check if we're not beyond the expiration
        if (rememberDurationInDays && rememberDurationInDays > 0) {
            const expiration = localStorage.getItem(rememberExpirationKey),
                isExpired = expiration && new Date().getTime() > parseInt(expiration);

            if (isExpired) {
                clearLocalStorage();
                return false;
            }
        }

        const hashedPassword = localStorage.getItem(rememberPassphraseKey);

        if (hashedPassword) {
            // try to decrypt
            const isDecryptionSuccessful = await decryptAndReplaceHtml(hashedPassword);

            // if the decryption is unsuccessful the password might be wrong - silently clear the saved data and let
            // the user fill the password form again
            if (!isDecryptionSuccessful) {
                clearLocalStorage();
                return false;
            }

            return true;
        }

        return false;
    }

    async function decryptOnLoadFromUrl() {
        const passwordKey = "staticrypt_pwd";
        const rememberMeKey = "remember_me";

        // try to get the password from the query param (for backward compatibility - we now want to avoid this method,
        // since it sends the hashed password to the server which isn't needed)
        const queryParams = new URLSearchParams(window.location.search);
        const hashedPasswordQuery = queryParams.get(passwordKey);
        const rememberMeQuery = queryParams.get(rememberMeKey);

        const urlFragment = window.location.hash.substring(1);
        // get the password from the url fragment
        const hashedPasswordRegexMatch = urlFragment.match(new RegExp(passwordKey + "=([^&]*)"));
        const hashedPasswordFragment = hashedPasswordRegexMatch ? hashedPasswordRegexMatch[1] : null;
        const rememberMeFragment = urlFragment.includes(rememberMeKey);

        const hashedPassword = hashedPasswordFragment || hashedPasswordQuery;
        const rememberMe = rememberMeFragment || rememberMeQuery;

        if (hashedPassword) {
            return handleDecryptionOfPageFromHash(hashedPassword, rememberMe);
        }

        return false;
    }

    return exports;
}
exports.init = init;

  return exports;
})());
            const templateError = "Bad password!",
                templateToggleAltShow = "Show password",
                templateToggleAltHide = "Hide password",
                isRememberEnabled = true,
                staticryptConfig = {"staticryptEncryptedMsgUniqueVariableName":"02a0d5db975a6d399073ee4e70075186c6c836e8f253fbb7f2ec400ae4d9dc48d23c80d20bebbf18ef051ebf89f5f260a43c56d2cbe5e47a14b1a9f07dfd5ee974eb50f9083f18174fb3fa3820445fd8821ae9c04f305081fff907207f555b1920edef33d1e4e58c67770d8e00645756dda3850fe9caecddabe5827e6eb83892ab161aad4b2f19f4c78f289145b98f3e1d0d582f7d40303dbc72ec3a1836d29e6a348b61208ac4b95964f2ee94b6659781c9ea3b49ecdf220940164fa3fb3cec8e098498560048167f528843fa38ac5a9f703e62304dde98c7f24c7a1ddd731dd3b76f8858396914579ba89a711523fd20082e3e50fbb0dab7858c0630a35640259a9bb29fb12d8c5b7b3c7d486f985046512b8fba34b9b05e6e57da256d522720755921803f07ce4e1b3f162f486ecda34849d774f583f3b84234ea820501f1cac3b1cce8450601c93b4337591943849984e3d5cb5add8934c207011a62abd60e73528f52f30ab99d8ca35bdde2e5dbca408c7bcb04aee693efb8c333917105279e6b895492b209da370f93e9440929467b597af750d50c093302a53db31d93600dae499ebc85e29dedfef4d68ae258e61021e819b859fa459a6bd3eaa25f59f0243ad09a46106072303d5eb9856f29bc485555fd24c447c5c26bf28f97203cbcba4b3cbb3926bb19e3f228468b31c01be6c07ce3c6852a87a1445057beae3b0838144da1abbd190b584dbe168550d87067edede37571c7236219392845eed671ab117f6e06148a3d5dde371d5e6055beb83636129ffd05f94a4b242cd56219dc5dfb46d60a86ca96c29baf84916ff11857dcac844c8be3d47d74bc508b0fa6fde255914606e0de8e570521893ec1dcf4cdc2bed3ff7a9678e325d7978166890c02c206e82836b0bb072712401b0fc65b2c0199287f7d90c83c11b0592e673ae72179a45317d5ebfecbb0d75cbd3dfb99d76f1b2346375a02db8ea316239733c81d44b6db750b2767d81314877a16b89d0c24133fe506fea1c121afab86a41b719e3d694323713c8e62c7464967d9923368a6d99da6b7bd97bfd844279368d357c6659d30a67ddcc128685febb8b40b11d94be1b723c681bb2669060ed4a82e46366be2056bbe663e896bbf91d9d0ac2e6bdaec56644144dd7f0aea33c2c95497c054d08605c5f01671693ea749ce1c5ea72d7989cfac2bfc3b0e1e26effb0103c68efdd26de8a02f1b80cd042c91f5221e346ae640d2484707f9c7a323d769c3049b25c2db21bc1c775767bb0b6b4558901a39eb78c0ca300e7410ebc3a837a6225668f362ae9ac4eb69d6091b2f08402aa5e0c8775de641540d930719a04950d4aefe550f64eb5869422488803fea372a72017e89a00e47acadf5ce3ae2f7392d805fa805e0e6a811805a453e6cd722aa7b7989d89d835b946238ccf5cb5c694d96a9956b344e01e0d5ea09f291f49a6dd7d06b978f562724b64574c7858e2a8d046f1b6bd854d2474b20c476758242ad9333044f7b3ab6a794b13d70917de3f3028e6c57f94490505bc50c12ebfc8762bd2b9294af364b1574b60ce51ddc23ef598fae33f1a3f7597041d4ad4cb133802733e95dc46fcdb443900542bd352eb7a6f44a7287d56fc022ae7ddeebc198b8875758b448e1ad23be832238e253e20d09acbe8909f2b6b82bdd8d1257958ac27f9c826a8145e378e3534ede9417d2dff76f516019897d3ed2f7db9703f825b56d7b8ee0482cb0220d4a4b177940dc2e96cb259bd4168d82bb067d391887cfb4b90cfef118bf3afff7aa8d91af4736a5284678bced03efcd46d80145d16aae4076fb5d02c391bea170238e9a8d82a530326d3b22a062cbc4f059eabfb72e7980c494b64cbb61b84dee8d08d3adf7c8640a511c076ab655a3af70ab78c069d5dd63a6140e6db32819ff7f3c3580385ed13aaeb52099ae9314599d64a196edc5bce815c9c7f56bf6a15f404ceba8e9f1cd1eb82c25bf9f874aebed2789700093fdb34fa6cf0769aa6322c08f876a1d69db6f24aed086f33275a47b7e907626a1d4180bfafa85d5325c3e420c8e94f3ead2c4768040cbf53eb1da75add4009a0cc06f983009730abd55cf80641fadb45f61befeb33a946225c36fcbd6d92fa09e2793a8e0c8737510565e98f4cb1d1cabd8b8447e59af3e75c95156f3ddc9830b9ee36fbf417ddd3d0fd75edec0a0d7efb99438c38aa3662c9209a8785cb2321c20bcd239e0fa368ad4e2638c3eef5283231d5c868a3c5ff3f9a56d8f3100dc466c68f45bba41ef5999ceab3e311762c5655bf55fd258ad91a064160824a5a5cb58f0adf4cd08f741c0dc7e54f2f6d2ca414e856081d98b489e7a1490529f06fec0fa1e64f02b51a7c8f10abcfc3e679bb5e461d13e049084cdc136a5fbd077016489b009bc7ecd8eadddcfe1700023681780cd3e168bfb6fd957e8f24854e3389b6afaa8cf59db213639fe35b1429ed3b1809822eb0ccdf2baa1d61cf69b517e22497334ddfe38c29eb34f66f2c0172e576063f2612ec23f21568020aabd6b287c4a32c6d32de9f3b295c92b0433b79b12ab8487854c28551494e089ce1b03b422de1be48129656eeac00b7bdf0b28659fe05b9ecb0f73d3c2f1aaed695d8027018a752d9b08e537ae49b8db92f3482835967f04136f85f8660f5fe6b4554bb544185c1a867b60877efd818d2c9aefa48155f277e24c4be61b52755761cbe7d64c7f9600468c9048a37b4acf1ef134e969611620c9051caf68a1411ce90f1dff2292221a53b89cdb8e8393a880110a34a0f21943733b3ea0df9481f42eeb8ced5cd78b2646b46856cb801d50e00702857e872c684c49e45da581b1b70a1906c785d93ceb5009c68dc55818c308fc4b2ab673fc8b17a6cab35eb3c17d61ad919cc45decc9e71ae6504a7de209f50938c05fa91977eb0a01b96f75ab7ba54a6a8397d052ca1b4f7425ce0787f627c175a58fb56981534c812d2d7542ada11f9ab7d615660e47e48875be8d99abec496591528a703311f7e778341840878e1a52d4b3ae356a25a7b834717542cfabdf786551e552cc03336de05ea1a2779073c0e3598e08c52a6ce0b481b5ce80ce0c199337df5075ad2caa10ea0c3243d1e9ad228c924ee373ed95cae92a9dd8cc06fadc588195197003b4eaf1ffa7cb26d2ac7223dccc4436101e96def52210b8f5c96e6b0f7c87902160ba3712ddcbbb84a669a1d1990d7e6da72ebe4524451e3842ba5f8a95fddaefe387b743ffc3c4583736b539a17c01866d928892656929f82c2e1db4d95547e5cf48c6e330bf28170fbdca877f3262965d3b40710cfa20accbd7c208c210f9fd54b90d2cedb9bc15c0a94593eb0bc3d315cc4c8fbcecc67ed4a4c77549ef0d14726bcf20f0ea83d4f1125d9a19b3424ef1431be4ae60505a9bb7fb679938f0aba570724ad0975f8f7b804bab4a53d407dd9e3c1ffbea1d03ce786173f0ffc45ed16efcd7f4be61de0962716180d326269677de854565052c063b928ca7afe957a8583728f7475095e7a1838b2ee6d46f68cecfc55f3bf5fc4aaaf36c8fcda30cbe042329134b66d9fbf2fa07525382a0f7dcc6c9663b3e1b2160bc815ef87a8991d9848c0e4802ad94baab79c3354782cd64d0439fbf4c76beeac5f43eeaca93b213a3be23b1405159bdb428a6d9cad13af6318b4a60bcdf321bea6719ec5dd6d24fe287664d3fd49db4f96c131b5788117d1b926d9699870961a94e82ec2e7f6dcdf72c543260cb76f6fd5819c2f08274d1c2f303796eb603e585b41eaf65c3062e7ec168ab22bb15ab88c353168954bee5a1e2022f80b00ec6937083f0915bacff3cde2101c3789081bfb25e319a2c4b73bde26afa40a8d374c834f3d47d2fcbb5f665487649de8ec077617354c8905f7e5b3afc1bce597d8446c18d9a6dc30b19efbfd2d8202db2285918754c863241018d0eb22fa54e04a722042c89ccfc0dcb9ebed25c6e32ae54b2649746ff2a71b0cdeb563b977671c2ad680992ba43f5f0817300580f715799559c40e5a1fa7fd63dc5349b886bf4cb7747fe780224e3f5e7f746d6d6f22aa75462f2c230a6dbe17a80a8d1d8d29486ff7047952d4b3fb1779ce7dfbd4fdd365316eb852d2f8b7c3eaba3c6f79a14603b4a2e11842d279b41a0e0d63b24daf3581371f58b7bf896cb25a4d24d78ccf777266a55d36fe80f0f223bbb7f058d2656a69b6b5c8fd743893a0234d58c6b7f85d299448fbaea74d31eb5729f3a43fe4b848c9f7e6285d676df469e74591e14937782a05cc2251848b21dc1db007629e3e6a3a1b313326c7c04e2574b8bd341327300c8c2534e33fdd5e65540c45eb2733cb2685bd25bdb56c16d978565214754fb849642d2e664c7e3a19e184b96367cfa935ef4f8c34b9a9c66cdc16857ade876c505ff50d6d6743c97918c4bc96ca357fb52ff688a68cf95ee4f1759f1e3124fd7d2e25d8a82e1ce6757d8b4310ea5db9eed229d8a41b21058cd02924c9b187d578264543d73068408f62d7efd54e257622bb00d243a55f577f213311d10f6eea81a01f9a32cfd90d626aa4315b78d484a6233611dbe63f13aeb3ef2de011c1f8ccc22a3c3606b975ae94a9e532d17138dff88889e2fb9d9c863d8b14d04d400aace53949280054272153d7ce5be92fa42829bf7e76005a9ff247bb88462a722c148a73b95a48f7de4343be599095d44189259716d5c9a584b6360bfe19df2818877da19c597e3851b7c748f34f519d7aa74a99290b01db3c1976097c9808da09285c2693a598fd953b6a102932554c2c307755f55870294cbcca7a6ed8de4ceb0fa63acb79da3f9bf22f06530d1229fe2b68ee8a4bb4ec62a8cc7e9acd54fbcbe6d42b4c71b713b6676fda06e9eecff036441970771d94fc89e855a2fac1fa1db0e899ef5052a0a93eaacdbd1f31b72bb601c2c9670185584b75f03fe4e6a6cd12ed87bdb226a9abfae95ba45b82b1443679a341dd8caecde97981ccc173743ac312cb8a82b16188ac61f41a4e289fc0a68d58f3c2c2871aa1b6d5ba9139e6b95a5cb9a5f571abedf4baa456085dca70fc82cfa646cd4b93512e474d325edca531a825e4d770b1a3c1576754409fb67f07d005a8ea700e7345412017af37f90433a180cc99a8f20a71b6f07e6d63d1905d961c6c6c4ea705c95018a33dd6912324cc3665cd885523393e1fb7cc378423ca89c77d2c45385e9eda877ec2256f0410f5d093fee89fbd23a47810ac8e4b11551f4780b8ffc4d70790c23d1e727dec330fcb8b7324c29b44d7388f36ac2ffb103d96b96395d9ff886f96a9a77e1da59fe5fcfc81578daf8f61ab8c37877a1e55d0bc6fee8290ad3bf8d7e1d7bf47b4a86ebf616c5c2e8d8c51b1ae37fdc754452e49fa39771f45f33f9d1a726c53746f06b556f4cd851fdb09300aba311f3e26bafc44faa8d5e6a669da26c904fdb10a7531136cdfb2c36e6bcddb8abcd1fc74a3f4e4eae5228a1a2c169f24f80fff93cc6a65b26df6993a68abbbb0cea26530350e6dc9331922a009174cea3af86274375279b5897cda34aca3f210b406faf80cca9275ac0475f3665d9efacd7419ca85353321bafc26c29a03d6b27c9d2baa6ad00d774b57c9cced61d9354b3f0fd9f83171ded601e69dce2009c76b2dd9f8b5a76e1a47179ef29364c306917a832e62a04f80de95290b8c0185b484a0a6d40d00f90741d46dd374e43730eea43ee87a3acaee2d37a1300fba02c9e31ce3d4bbf9992468c29309525522a18c04cb3546d8a75c682f741b96a0c34cc1eb2cfa1b439c1666e9085bf47b1df61763230a06fa2845cd5cfeb6fb422e1be15c8a159b2aea3bcad447c87b6395a76aa45db1fe6c06a3a2e7c8d63a51cc6dcd54503d2a277c86d1e00621e5f1e325667a3a88628e74f4c330d91507274ae167073ed857119e4245c4a282f72054f78a510c81fe5bc459bf964c4b28d3d621118648f54da3dc839721e86ef4851b2ed404609e04773c5b715409fecc6250f60cda11732de4553005f48f3375ccd9dd8694f91313dcf228c975a9b6c2bb2681a490feff298c4a0c37c4153386be89fe8d3526e12a0b99b61296cc08e422a1ee24586a61f1c3d1f6046df3c7e8f4c8eb08f32195efa593ac5652bc36f2918e0140f057bae0ed9195cbcf86ca2f79e802d89d60c0c58fa727925a996d87b38530caeb0282f752a8d353907c6adf16723da7bc0f79881f862c036aae5597f931af4753f37417e445e39b0d545fdd455bf55cc975079af04489b4fb6c9bef10ac1fa079ed44fb7b85ea61ee7031026613fb037a41be3c50866b208729984917452f525b5c2616c34944c21ade947a4ffdec14e8575a34c86d9bb338e4b0646fce47671a45a4d10fbac6c5f490d09d589a456f940ba406cf69f1a5fe4a378abcf049c393d042d5a3c1c1ea63face769e084bf0b02ce73ff6bec591744ae8dd155e9a237673e26336bffa976468211d15f1930dbe6a84fbfc5c94eabe83bef4185fb4990feedd7e70ac0caea51cd2778c23351df99ba83fb1d93f971e93779bda548be59dd34fc13b2c48a284ad4bf6a8e8856eb557df59bab9ed66ed104c3437947387f4f92b05dc6a112d26c912198a7c768b07459e3ebf7bdb4cc834492d45ad5b1c0e60cf92696482df386ef24816bc1f88af1279b273e5a2e022ddb2659423eee844ec77cc27021d9c35f868a649529b93fced70c73a8a33119c47768bab20769d850075255a82218fdd957d5aa1cfee254b142a54691f8627db2f27ada1934089bf25bec4a9e486e5ca15e549e3c31fe9fca4f82a7e611465a09db31337ec776ab4d20e6580ac56cedd589d7e2cf65abf773f3a570026bf3d3fa21df5cb7f17255b895c6ed8364dbf7b8d7975b1d15b20c4c3a84ae05bf656d4b68be0a1ff2a5295a407e971848f66592e050e95d986f81397a2c167a2a2de29ad75e51d9748522ca3bf70b0076a2eb808af373b702fda5445faef0414a6c86ecfbcfd43adce4b65517df54debdb19967426065b692d6e242c11a2ed1df7a154da9a18fccc707c4b395f26a37e91707c764538dba6ddd0668e9096d82643618de90b8f4b1bdd2f44dc1f959b30c17ff36e49600b7ac86e518cae6927dd5b888b7353dd88eeb54887b2c0374619dd09cd6bb039a0dec8848050e3045b5948fd8487240c2f3e4b145e61bce351a0d2f8a46b8d8d0b0886712e6ea89224dec9389d24d79eec86734c1676205d857886b495d4ec0d34070400ea38dc570ae3b4c8ecc3004926dcf1e1aa57dfdcc52293faa1b2937e180a5be0a8914a55f3a530e60f5b56f0c2a8846af8fb42340049e48e286dc2d106fc344dc33973f9d5c40ace89972f9a732ea6c1802ff2ba00c7bdb381f6725d2246a3c30bbaac640de111ba4628cc42987f44ab00142ba9ba7ba8ce032af3e3e2fa60e6294f00a2ee714980908038b385ed5a581ecd209a4db8a4ab0756ff91ae29910cf4caef4cb3f526b049e4ea744ec69b6088bd01d3c9267b6ff22f5edf17b0a760714a370df10a03e17f4794c4c0bb11de619fa52f0144daa6d59ab967fdd81f6bef8c3534392f275d8bde9722d13c422f99e5215257f3e5313742d6b5d910fdc2bd88719a4d2d3b4712a73cea09940f4a35ea9c18ad930a8fb88f36441f3d4f97efd5ee2528b35080ac63d33fbcc8c06a586a829ee484a6b0085f666405a24aa7912e42d0fb3e14b9ce01833a2cad9b2b444ee08493586147189c29c1ba3020a86efdeb47c6f7d3481941b545acf04b66cad0480eff27bbd697842fb0032ed3685ebceea301655be1673f0d1b70ae2b80ae6de9d4b16371b7ac70c45af5ce3137f6052cefa563e5f70d5b1f4e80570df7f29c298446d6baaf1feff76859c4d7dd7b34876bbb8f519e5cf99e0ee6dbea3bf85458314a8237be672d17ad0b02c2e367bfbcf2a3a64a5a9b7eb52221e3d336d3e076ed23ff080c9e1d88d6e14190c2948448c0008ed2fd2aff5ec4a5380228e7832708ee8515be41e14cb73a22d2b5fcb55f431c0b7a6f3cd963c96baabc23e6a93ed5d8b3ca89e7da9a03448251f1fdf6e299c58ec5d0fa02d01ed69947083364962335d6bc54f081bdb8c7c55c141c147b7b0f2ec75406900b0438c596b981aa8079ec034fde296d67dd5e45518851011716a57e61edaa667f46084bd1686ad4be943345139848ccf6884ee1c349359de1a88c3939c0f7f4c5753f205c52d4b5d52a56e4cb12d8f2b36b08b1e15736d14d5dea898d3889af39d3b7c64ea10bad0422b820ef6696bae178a33f967d05838ac30daa1ad7b78c0384e2e78e9f6134b4e3033408848bdad1817023efcc8a1341f296fd61310e2999a06dadf76e90ad5a05861de1f6113e65e1f28fc45c32153834fd3995635183f96b2415c9d32f730f96795e1eb60c3b40f7ca7be15b15d7616665549154b7ad41e3f6aa99a485ee08a35f28f5a0ff7bae31c28f31ed894d28061e973ac7f2a95fc08f03e181faa5ffc8e0cb0e826c6c8aaeaab9012d3453a92559085db190186563aecb198db24d61b3d19e2083a5713b1ef1b70e599ffe5d9aba08f72388677e5d252f573b4df2c91acc1b8723a5985c1f4951dc6d90e3b360a1c2a162455527d5726bfb93af43d7c520d66d235635490d3263efeebebb82c37d996d706eecbe14bd409221493e52ecb7f9724db57e9e2afae32476a913ccaf6bb49285873d8db25075685940c7b8606a26e3fa67b0e2eea33b27f9db263d3c5e9d7ca260d3353e83fd23a850cdfb65842172747c74cc249be814e846752ea985d536f2e1c01aefc130381412013c7f57631b18e21ca5be605952957757ee661a339b9029df6183bd6843e8c5c1820846d1525d8193f52a7a563037fb212e2be22b34c2c7a9ac51856acaaf9da8f7359973ee34622adebac09d5bc7f9b6190192dddac7c0845c78c8f4f034916d213205212fd4e0176bff49d1c2b11746e42efc0997e85de3021b120dd4f779332399d84a1a41577b969d0645c2413ee7958af17e0565adecbb453cbe6c65e9fb250ddd5acadbebedc9637de051e10d22f4ce1b6249a3d83c4c644d9a9d5d825afe18bb4adae0d2251738c8db3d9448ddcecdfdfad96a0e448d078bd4b6cd8762a3ea5df9dafbd33650b7b9043d5010277bd4b943fa41c54af41c27cd2860e246ec87714eb18897c258ef00a07cf64418d9af7cc50283841d29cdc38863ee088a08e48a0c7f5bf74015e28709b87037328c146226ba76bd7479a528b294921a771c34bfabba736d566f45cb1530e78862ff10030abfdf0526636ee0282428a2b99f7dd5a4193b4474879fc2cf4bbe8af07853f61dad12d1b6d82488bebc9862dad8ec86192d24a38cabf654236436e122ab69694b49b095ad218554b0983a4baea0d6f5405024f0fe55484eeffd327a0936be9236347462a4f1674e550d8d12eee2d3838080cb7b66ba17fef43bf4697c09759f7e9dadd825364e0273d4251128ab70147b0d557d3f5010a5ab10aec16e38c7168e89558eeaa86a4600cc361350c009f74453aca8085b6d065db3c3b77ac094b6a18ba7a55b70f79104043e455490c7a04ab93afc5d107726b03d2a8cf87a6be3878cd1ad36b63ff4dae38591b60e91c539059f1de0ec9e4984316c2e25367d80af2aadf2a50397ff0ccf319b277d602566bebe212993084f7a210e651fed55b1d7a3bcb054c629a6d3e7825517fc54c34e8fc9292cf8e4760573497f9c7e1a1013541002b43d0ec35ef10a8ba884008658c8d1b04ef817aee8ecd7b74dcfbb82341e6d146014ce09db5cb1bfe85a148d715b52676882971dcc3be7b1c0f809374b9c05c6d0c5f7b5f277f9196bc4a69d9906fa62a8616f28ffeed2e6074f08844311ec3957ebf0a93518684a7a86fe957404be916c07c826f325768d046062447e851219228b3dfad9dc9c1773ced0c4140f9c55c3dca87de8484cc0973922130ae0d68833016bb0cfe280c6a4df8f6ace717ea93c859c91de2fb4a7874dfc7fcb338ee95bf6519a6095088e37d6fdd9dd4d76a5dbb5606be0599d21a4cf219ac8114ee2071f860d3339727547ad8a292b0c1b108e9abe7600d13176c49ec3ecaaf6e41eb348f56fe1982938fd7f84c9bccb69a9e554b22c0ebd60c0cb44d90e8652d9fbbd7465a44b3fb36bb5436a24a1913a9a6d1df1213d590a6637ed440d96ca7cd5f854a010ee3e8194a98800154cc5b60eb69fada112144956a8232f6a4cb4e7a2882a7a942dbf98826115f0a987730e41f9fcd19c614096084485df1d7025fb1ed493cdb3c963be9f940c7c0faf3ba281bd050a4a5d601bec090e4c6aa4d8fd105fb0078f7223e6f7af584b1326b70b6a05c0e7453a40563edce959ea77527de3e0744ba2a87f9eca2b770881c5676d09f3cfeaf507538fb4a9b1db4316ec5f21aab46fc54a5f26a821a0f040512d34709fe6fc0a5e26c71597096d6a98e72206fdfa998f8ae82cdbac26ae0c0573b7258f391aaba722f7c8d3bbf140241af3236562eefeeee99f9ff51636d17fab931c75c15ec2f6a8cf593fd57f6f25c2bc9095aa04eb87785273b2a61246cf39afa1e043c2346a4712f143c25ffd9ccebfee06d200a22c38d495d89fa211adadc113c1ce79acaa0c0b7dc210ae262ae52283383263cb79abe221853f2ce0a05625186f464f7c6fa79e9933358e336dd26856e6e3b174e63d34ae1dcc9f7a20866b236c86d2b75f0d3aed2bfa77168a52d142eaa7133a62f36279dbad1542dca1da55ee23ffbac24c73e942b7fd6f2e56cd01bfa364068a13c6498b9b4c4960488f93e6899bef62a4bc44d30f921a91176fd7b86834db2d7c0bde10d35335ea87befb0928754f109ab110a8130703dc003343f90e9eab55fade5eba0889e115bc4e833de306dd81ab317f67e988c667358527964cda8e6dded24e31cb9464afd08e7a8095a93bb78ae8a2310a1b9691e55f6bb1d9d8a674db22d957666f9c7028dbd3eff90c48f131749ec0ce369dfd19a695bd0f0862507886fa0b47c903d1b8636abe3c6611e636e89c078a14724b878970669f3b90a2bd8f217247e785c407b33de0a3e957d5c1a0d372dc137e5f2504fbdda9f57f20f6c26c4768974b4c96de55cd645eb19e0cbbe746956dcd985b14c4be09a1cc810fa141fbffecad4ac365bab9e0618860da4d7d0d7ee93a05647236a27307dbae2ca6421f00403fcb8827136d87002a99dd4ef439da9cd17f6fbbc1fbb57ba4f1485a31f5577ffc16db3edbeac909faeb46e46449a15c8fff4e78ab9a1d5bc2a2550d1e9259c1cde0b790654a01f92713517bb9f49339a78b6675044aa72c54d4ec10e2e74b1f847b591315f99292464d78d9e297f5018c0c0d1b96c45765022b9747bd3e860c695a38444d9cbca3ec1dcd193753e5992af4abedc18b8958fd2c75e937426a33390b3f0af8ca27418003731d6acfd5f59ee661d27998d060732bb9121a25e6f941452da410d8cf753e3245fe3043ac70468b83008c0f4cb1c48dec51a573b7b7e8451df4e3d702f22318096a9e36971b0c248b35162778256573f95c3f925ecfb77bb94b9c57f89e3ec1eee38e95a80506c94eaa0c0454209eae6303a6a30f35f931f7f132fdeb8de1335e198d7ee1a30d766ab0ba4aa69d33562402011af791ea627c4c14d6e14190a1dec2ea171c4b372b61a5336814bacf9c23af20cbfaed94eb8a7fa434886f95d7de17c9043731b3b307a99a47466096e9b90c4f851bb55622bdbe581ddabeb338e9bcf945d7092c66b8297563edbc7765cdc5b3901da9e40988a977d24e3852da7623bd5441275f8ae0f0fc7e36bde714eb847089ae9d63eb67848aceca0b582b56007188880d8d5d2e9e281322bc8ae8a87ac6fb139ef244b4ac1ac573767487c9731c178928fe558eb296348732df25f1318611a3f41507be61d556d7c281e5904c22b31b43c38967900f888e64c3c7b0f87f0bcee43613685901fa65bcdd2ddac6c18a1f0a44510042b3066252e259e67572b9cf7c46bf793e7d218636e8f92c1bca094adcfe926b3d0b2049e8eb36251115a3cb9826c16e607f7c4ad6911c00d2edb5df8c2ef9054d74c92f3fde24fdf84d85227ffd8c25371f40b5171798fb6c8ee820598373f22780d798f016fc9e05527781bdadd5dfc49cd9fcc1857cda631db499cbb762c4e0b11747a80be1790ad49a10dc98a77b31686f822a03f0f4662a677642e3953c18cabc94f6af6b290ea375c7f3bab6e2979c5cffb5eb4fce41bff77a2e8596c248950e1efe8efd103da0e23f02c7bbc8b5157ad83f7097a01d4808124919214b6f0d79b7d2b672757037fc2c1f9cbb1186ee31177c9abffad14bb981d85bbd94910874560b5f64957ca546e77ee7fc733e1fcb96d18606880c8726f6f9db97527c8a5e9e316b18b8bfb75709926c2dd8ed56908ae3a1e67c970f7380b7bf525fe2d1323957030a25b578c875d6e82b266ea626f26213654464c76e66b2af079877a62146b403ab3739abb5522a4ff353b51b75e0a084587f08ef6e6504ed6c9fd2219d6cfb22d6ce9d8456930d7781d0da8a34d16fef09381ab865b741cdf9d81d4b36f5778b8cf9f28bdd4df53377a6ab35c6dd692e7d369bde4e4693cce7edb31770f927450ba5802991f10a29c062f1036bd06bbbfa448cb6e1568115c3852e1f24c5be4d8f9a30956b8aff9c3b05977868fadc5d844be4373ce8ea12f4b57f2727132828d6733e243f890b75f454f8e1f6caafed76e1f6c1486e522b5d6caf09d1048399b36afbfe0ccc86e4adf1bffa1aa241787bd35954f534788fb37e23a33cacb3786de85a1eee64e6747c63bbd0d9a60458e9ad97aea296b09a47dcbf272d2e407756da59acd4ba2540c6772f3a6dae69947d99f79cfaa5c3845dd2c6a8144a2a4dbf3d9656e36f34c43887432791d1f3f88e80584d7907b4b012be54470a1b8852da33119b2c41d77a05c211d1c882d25f865f3ca8fb013dfaf486a991dc6617176e662afe233105d36f79d563e17c490bdcc779b3f9bfff3d091105189d77e17e920f4e932c643ef9b1907614f45d2ce5430f0b162257645107301cd144799165eeed65c7ab9457f978e4278c82bff48246213d8d6fd9373edd4123d55f753dcdbfec571245fb9eaf0d099eeb8da09ebf63d5005f57a628e168345bef2ba6120185b18a5d1c5bde7811cbc67f9e0b5ed936e5e97358b880697a32d7f04920916753b342c5c253ebee1c3dcbb832190186a2555c9d99a8b26543e60d242d1bc5be3e70576090d1eb3e2a2931337c31ccec00ac3e8bcdd25de748ac89def44c55e5a2ef8d1229a92d174c7f258ec1d9af0bb044adea6b8ce06361b5cc441f26b3db3a32805ce0dca63d0e490eda1ce83d49374a2509f8589303ff0ac6c8d54111a7f465f19f088237000944560daf11f310db78ee32aace6f4a25880d6d5ab8284110f881709ba867a8a6775fd2721df5524a0119710d46a7703e3394648446fd4305a6c2e52f9b97b49c39ffeba4dba14fa6fa44a486eb5a4e417b04f92a0313509be4dc2ccc96ba5ef8949acaf46a3b9c018ede2b035e9bbb56753fd54e19f34218c0a55457a6920bcc11929783f04b41df1d4b23c4bc1f63119ee48d44eb79e92a9d1c42aea7ea2450a0518780dc2266ff20f0fd22a823288c0fe0f08eae8605d804500eab59be7e7df91767e6bef320f4e99a861bb3402b721530f5d10cd0587f1868ce960731fcc15b0ffe3984a555f08ee8ecd56d1478609da387756860b00a1a290fd51b59f868cc4727a70d8ab04a317d1eeb166e7ba18c4d3cb7674e8f39d4c7479555c86fb2c346eb2eb48e70317bf63da49f026176d36934ad9c869386cdf9ee85a83b7680e24a007f7cb5c821bf7760440593b2b828dff2cdd14ac6ad74a3db6e740e0245ba813484e31b49960d9bb72ca6d69ba99e7152c03102579af27ed67b28176ec543d4af09febde67c3e9df9d89b7e13f29bef9f4ccec623fe0fdc224b0d5543d630b9e5eaf34e410b4596921809bbdea3e3f313d3e48a8184109350bad88e847e6cfe76408e20fde15c0fa4dcd9a0761f3a3fa4f840d67a3c1c3bc13994030da750ad7b3176c3bb3803598c7af694dfb08843feebf7878e9778b102868306787604b4178b5da697abf2a24b6f06704fd21b4c7b3f32d1853ec542a62e9b8601be41b051c6d72d290e6ef3790459ff2daf7cfe6baa5966f50699fc6cfe3ae82d13c6c0fe7b7f0a2d53c2967b295badd7813e72de28973c0886123ee629f7b904ed809b71f2c0823c7fa6360570f695b6cbc22a0f12a63d16637ebca8b78563496bc08ef2d357b4c549277df1928e5040d208da8d03caf3a7c112d57ac80194f85af54cf571a4cdf0308f0b8f0079709cd35cb9b6ef3b3c7914513b2070f10bf2a395d67454ec4b19b7097548cca826451dc9b6e42d4799a676e9dfe76e5fd61e290b2ba0b5f94400e48d2a21f13718e91a8eba982ccc5bd6dcb60421172b2a29238eada29cf2bc41aeab7c92a46d12c3f5180c2785afc728f6137fb45083fb3350abf699acd3b8497bcec60f51eb763cd47367a0ec7c46ec14539b14d96a5eadc93168f43577fdc3d44fbc9626e7ef64775510e3ffddf49ce603316bcbeab38502c3f9fe2f4ff90d729c763255f43d638317368388c4b4651432cea8c8f864fc58c6359da189db95664cac1f2324f218a757422181707aab8b46ec76d3d7c651e3ac1314879bfa5c5cec8825fd0229a926a3ba2eb2cae253aa2a36019fae2d7236e090051c954da9145a591f813070530ecce0ec6b567ddff8c16f5dadbe7fbfed618ea7b66435edd1f7bf4bb9b440bfa6e79fe8b20fe1bf7fe16aa7562c331546fc611f0ba4870c48760175d02355904ad2ae94eb4a55123ef1468c38c00615cfa40ec6d486a42dfaac3551e422be6232fd3eb46cd4e75e733eb7940d605a350408db1ff1612bb984385573b94208a85a4fc22bb528fd0813eb161881018bf75816ab02a48013b0ac8d530b18f0b7058a58baf4a00c1779e8125b23965d8457a8562a5db478c8c8d4e53e52057339e0811c269bd30345d6766cd7fe22909bc60f8fbbc2d3a9205a11d450ee1403e1ccb57c5fea27437bdef32e07a493628bf505cfd4fbb4e2ed19c9f5b56052be57261bd5831b5ba2c0afe3b6a20496e6186fa2394e1653c15d7cd9a","isRememberEnabled":true,"rememberDurationInDays":0,"staticryptSaltUniqueVariableName":"4290edf5ab9c348d0d7d0b9e329b1e38"};

            // you can edit these values to customize some of the behavior of StatiCrypt
            const templateConfig = {
                rememberExpirationKey: "staticrypt_expiration",
                rememberPassphraseKey: "staticrypt_passphrase",
                replaceHtmlCallback: null,
                clearLocalStorageCallback: null,
            };

            // init the staticrypt engine
            const staticrypt = staticryptInitiator.init(staticryptConfig, templateConfig);

            // try to automatically decrypt on load if there is a saved password
            window.onload = async function () {
                const { isSuccessful } = await staticrypt.handleDecryptOnLoad();

                // if we didn't decrypt anything on load, show the password prompt. Otherwise the content has already been
                // replaced, no need to do anything
                if (!isSuccessful) {
                    // hide loading screen
                    document.getElementById("staticrypt_loading").classList.add("hidden");
                    document.getElementById("staticrypt_content").classList.remove("hidden");
                    document.getElementById("staticrypt-password").focus();

                    // show the remember me checkbox
                    if (isRememberEnabled) {
                        document.getElementById("staticrypt-remember-label").classList.remove("hidden");
                    }
                }
            };

            // toggle password visibility
            const toggleIcon = document.querySelector(".staticrypt-toggle-password-visibility");
            // these two icons are coming from FontAwesome
            const imgSrcEyeClosed =
                "data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA2NDAgNTEyIj48IS0tIUZvbnQgQXdlc29tZSBGcmVlIDYuNS4yIGJ5IEBmb250YXdlc29tZSAtIGh0dHBzOi8vZm9udGF3ZXNvbWUuY29tIExpY2Vuc2UgLSBodHRwczovL2ZvbnRhd2Vzb21lLmNvbS9saWNlbnNlL2ZyZWUgQ29weXJpZ2h0IDIwMjQgRm9udGljb25zLCBJbmMuLS0+PHBhdGggZD0iTTM4LjggNS4xQzI4LjQtMy4xIDEzLjMtMS4yIDUuMSA5LjJTLTEuMiAzNC43IDkuMiA0Mi45bDU5MiA0NjRjMTAuNCA4LjIgMjUuNSA2LjMgMzMuNy00LjFzNi4zLTI1LjUtNC4xLTMzLjdMNTI1LjYgMzg2LjdjMzkuNi00MC42IDY2LjQtODYuMSA3OS45LTExOC40YzMuMy03LjkgMy4zLTE2LjcgMC0yNC42Yy0xNC45LTM1LjctNDYuMi04Ny43LTkzLTEzMS4xQzQ2NS41IDY4LjggNDAwLjggMzIgMzIwIDMyYy02OC4yIDAtMTI1IDI2LjMtMTY5LjMgNjAuOEwzOC44IDUuMXpNMjIzLjEgMTQ5LjVDMjQ4LjYgMTI2LjIgMjgyLjcgMTEyIDMyMCAxMTJjNzkuNSAwIDE0NCA2NC41IDE0NCAxNDRjMCAyNC45LTYuMyA0OC4zLTE3LjQgNjguN0w0MDggMjk0LjVjOC40LTE5LjMgMTAuNi00MS40IDQuOC02My4zYy0xMS4xLTQxLjUtNDcuOC02OS40LTg4LjYtNzEuMWMtNS44LS4yLTkuMiA2LjEtNy40IDExLjdjMi4xIDYuNCAzLjMgMTMuMiAzLjMgMjAuM2MwIDEwLjItMi40IDE5LjgtNi42IDI4LjNsLTkwLjMtNzAuOHpNMzczIDM4OS45Yy0xNi40IDYuNS0zNC4zIDEwLjEtNTMgMTAuMWMtNzkuNSAwLTE0NC02NC41LTE0NC0xNDRjMC02LjkgLjUtMTMuNiAxLjQtMjAuMkw4My4xIDE2MS41QzYwLjMgMTkxLjIgNDQgMjIwLjggMzQuNSAyNDMuN2MtMy4zIDcuOS0zLjMgMTYuNyAwIDI0LjZjMTQuOSAzNS43IDQ2LjIgODcuNyA5MyAxMzEuMUMxNzQuNSA0NDMuMiAyMzkuMiA0ODAgMzIwIDQ4MGM0Ny44IDAgODkuOS0xMi45IDEyNi4yLTMyLjVMMzczIDM4OS45eiIvPjwvc3ZnPg==";
            const imgSrcEyeOpened =
                "data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA1NzYgNTEyIj48IS0tIUZvbnQgQXdlc29tZSBGcmVlIDYuNS4yIGJ5IEBmb250YXdlc29tZSAtIGh0dHBzOi8vZm9udGF3ZXNvbWUuY29tIExpY2Vuc2UgLSBodHRwczovL2ZvbnRhd2Vzb21lLmNvbS9saWNlbnNlL2ZyZWUgQ29weXJpZ2h0IDIwMjQgRm9udGljb25zLCBJbmMuLS0+PHBhdGggZD0iTTI4OCAzMmMtODAuOCAwLTE0NS41IDM2LjgtMTkyLjYgODAuNkM0OC42IDE1NiAxNy4zIDIwOCAyLjUgMjQzLjdjLTMuMyA3LjktMy4zIDE2LjcgMCAyNC42QzE3LjMgMzA0IDQ4LjYgMzU2IDk1LjQgMzk5LjRDMTQyLjUgNDQzLjIgMjA3LjIgNDgwIDI4OCA0ODBzMTQ1LjUtMzYuOCAxOTIuNi04MC42YzQ2LjgtNDMuNSA3OC4xLTk1LjQgOTMtMTMxLjFjMy4zLTcuOSAzLjMtMTYuNyAwLTI0LjZjLTE0LjktMzUuNy00Ni4yLTg3LjctOTMtMTMxLjFDNDMzLjUgNjguOCAzNjguOCAzMiAyODggMzJ6TTE0NCAyNTZhMTQ0IDE0NCAwIDEgMSAyODggMCAxNDQgMTQ0IDAgMSAxIC0yODggMHptMTQ0LTY0YzAgMzUuMy0yOC43IDY0LTY0IDY0Yy03LjEgMC0xMy45LTEuMi0yMC4zLTMuM2MtNS41LTEuOC0xMS45IDEuNi0xMS43IDcuNGMuMyA2LjkgMS4zIDEzLjggMy4yIDIwLjdjMTMuNyA1MS4yIDY2LjQgODEuNiAxMTcuNiA2Ny45czgxLjYtNjYuNCA2Ny45LTExNy42Yy0xMS4xLTQxLjUtNDcuOC02OS40LTg4LjYtNzEuMWMtNS44LS4yLTkuMiA2LjEtNy40IDExLjdjMi4xIDYuNCAzLjMgMTMuMiAzLjMgMjAuM3oiLz48L3N2Zz4=";
            toggleIcon.addEventListener("click", function () {
                const passwordInput = document.getElementById("staticrypt-password");
                if (passwordInput.type === "password") {
                    passwordInput.type = "text";
                    toggleIcon.src = imgSrcEyeOpened;
                    toggleIcon.alt = templateToggleAltHide;
                    toggleIcon.title = templateToggleAltHide;
                } else {
                    passwordInput.type = "password";
                    toggleIcon.src = imgSrcEyeClosed;
                    toggleIcon.alt = templateToggleAltShow;
                    toggleIcon.title = templateToggleAltShow;
                }
            });

            // handle password form submission
            document.getElementById("staticrypt-form").addEventListener("submit", async function (e) {
                e.preventDefault();

                const password = document.getElementById("staticrypt-password").value,
                    isRememberChecked = document.getElementById("staticrypt-remember").checked;

                const { isSuccessful } = await staticrypt.handleDecryptionOfPage(password, isRememberChecked);

                if (!isSuccessful) {
                    alert(templateError);
                }
            });
        </script>
    </body>
</html>
