<!DOCTYPE html>
<html class="staticrypt-html">
    <head>
        <meta charset="utf-8" />
        <title>Private preview</title>
        <meta name="viewport" content="width=device-width, initial-scale=1" />

        <!-- do not cache this page -->
        <meta http-equiv="cache-control" content="max-age=0" />
        <meta http-equiv="cache-control" content="no-cache" />
        <meta http-equiv="expires" content="0" />
        <meta http-equiv="expires" content="Tue, 01 Jan 1980 1:00:00 GMT" />
        <meta http-equiv="pragma" content="no-cache" />

        <style>
            .staticrypt-hr {
                margin-top: 20px;
                margin-bottom: 20px;
                border: 0;
                border-top: 1px solid #eee;
            }

            .staticrypt-page {
                width: 360px;
                padding: 8% 0 0;
                margin: auto;
                box-sizing: border-box;
            }

            .staticrypt-form {
                position: relative;
                z-index: 1;
                background: #ffffff;
                max-width: 360px;
                margin: 0 auto 100px;
                padding: 45px;
                text-align: center;
                box-shadow: 0 0 20px 0 rgba(0, 0, 0, 0.2), 0 5px 5px 0 rgba(0, 0, 0, 0.24);
            }

            .staticrypt-form input[type="password"],
            input[type="text"] {
                background: inherit;
                border: 0;
                box-sizing: border-box; /* This ensures padding is included in the total width */
                font-size: 14px;
                outline: 0;
                padding: 15px 30px 15px 15px; /* Adjust the padding to ensure there is space for the icon */
                width: 100%;
            }

            .staticrypt-password-container {
                position: relative;
                outline: 0;
                background: #f2f2f2;
                width: 100%;
                border: 0;
                margin: 0 0 15px;
                box-sizing: border-box;
            }

            .staticrypt-toggle-password-visibility {
                cursor: pointer;
                height: 20px;
                opacity: 60%;
                padding: 13px;
                position: absolute;
                right: 0;
                top: 50%;
                transform: translateY(-50%);
                width: 20px;
            }

            .staticrypt-form .staticrypt-decrypt-button {
                text-transform: uppercase;
                outline: 0;
                background: #4CAF50;
                width: 100%;
                border: 0;
                padding: 15px;
                color: #ffffff;
                font-size: 14px;
                cursor: pointer;
            }

            .staticrypt-form .staticrypt-decrypt-button:hover,
            .staticrypt-form .staticrypt-decrypt-button:active,
            .staticrypt-form .staticrypt-decrypt-button:focus {
                background: #4CAF50;
                filter: brightness(92%);
            }

            .staticrypt-html {
                height: 100%;
            }

            .staticrypt-body {
                height: 100%;
                margin: 0;
            }

            .staticrypt-content {
                height: 100%;
                margin-bottom: 1em;
                background: #76B852;
                font-family: "Arial", sans-serif;
                -webkit-font-smoothing: antialiased;
                -moz-osx-font-smoothing: grayscale;
            }

            .staticrypt-instructions {
                margin-top: -1em;
                margin-bottom: 1em;
            }

            .staticrypt-title {
                font-size: 1.5em;
            }

            label.staticrypt-remember {
                display: flex;
                align-items: center;
                margin-bottom: 1em;
            }

            .staticrypt-remember input[type="checkbox"] {
                transform: scale(1.5);
                margin-right: 1em;
            }

            .hidden {
                display: none !important;
            }

            .staticrypt-spinner-container {
                height: 100%;
                display: flex;
                align-items: center;
                justify-content: center;
            }

            .staticrypt-spinner {
                display: inline-block;
                width: 2rem;
                height: 2rem;
                vertical-align: text-bottom;
                border: 0.25em solid gray;
                border-right-color: transparent;
                border-radius: 50%;
                -webkit-animation: spinner-border 0.75s linear infinite;
                animation: spinner-border 0.75s linear infinite;
                animation-duration: 0.75s;
                animation-timing-function: linear;
                animation-delay: 0s;
                animation-iteration-count: infinite;
                animation-direction: normal;
                animation-fill-mode: none;
                animation-play-state: running;
                animation-name: spinner-border;
            }

            @keyframes spinner-border {
                100% {
                    transform: rotate(360deg);
                }
            }

            @media screen and (-webkit-min-device-pixel-ratio: 0) {
                .staticrypt-form input[type="password"],
                input[type="text"] {
                    font-size: 16px;
                }
            }
        </style>
    </head>

    <body class="staticrypt-body">
        <div id="staticrypt_loading" class="staticrypt-spinner-container">
            <div class="staticrypt-spinner"></div>
        </div>

        <div id="staticrypt_content" class="staticrypt-content hidden">
            <div class="staticrypt-page">
                <div class="staticrypt-form">
                    <div class="staticrypt-instructions">
                        <p class="staticrypt-title">Private preview</p>
                        <p>Enter the preview password.</p>
                    </div>

                    <hr class="staticrypt-hr" />

                    <form id="staticrypt-form" action="#" method="post">
                        <div class="staticrypt-password-container">
                            <input
                                id="staticrypt-password"
                                type="password"
                                name="password"
                                placeholder="Password"
                                autofocus
                            />

                            <img
                                class="staticrypt-toggle-password-visibility"
                                alt="Show password"
                                title="Show password"
                                src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA2NDAgNTEyIj48IS0tIUZvbnQgQXdlc29tZSBGcmVlIDYuNS4yIGJ5IEBmb250YXdlc29tZSAtIGh0dHBzOi8vZm9udGF3ZXNvbWUuY29tIExpY2Vuc2UgLSBodHRwczovL2ZvbnRhd2Vzb21lLmNvbS9saWNlbnNlL2ZyZWUgQ29weXJpZ2h0IDIwMjQgRm9udGljb25zLCBJbmMuLS0+PHBhdGggZD0iTTM4LjggNS4xQzI4LjQtMy4xIDEzLjMtMS4yIDUuMSA5LjJTLTEuMiAzNC43IDkuMiA0Mi45bDU5MiA0NjRjMTAuNCA4LjIgMjUuNSA2LjMgMzMuNy00LjFzNi4zLTI1LjUtNC4xLTMzLjdMNTI1LjYgMzg2LjdjMzkuNi00MC42IDY2LjQtODYuMSA3OS45LTExOC40YzMuMy03LjkgMy4zLTE2LjcgMC0yNC42Yy0xNC45LTM1LjctNDYuMi04Ny43LTkzLTEzMS4xQzQ2NS41IDY4LjggNDAwLjggMzIgMzIwIDMyYy02OC4yIDAtMTI1IDI2LjMtMTY5LjMgNjAuOEwzOC44IDUuMXpNMjIzLjEgMTQ5LjVDMjQ4LjYgMTI2LjIgMjgyLjcgMTEyIDMyMCAxMTJjNzkuNSAwIDE0NCA2NC41IDE0NCAxNDRjMCAyNC45LTYuMyA0OC4zLTE3LjQgNjguN0w0MDggMjk0LjVjOC40LTE5LjMgMTAuNi00MS40IDQuOC02My4zYy0xMS4xLTQxLjUtNDcuOC02OS40LTg4LjYtNzEuMWMtNS44LS4yLTkuMiA2LjEtNy40IDExLjdjMi4xIDYuNCAzLjMgMTMuMiAzLjMgMjAuM2MwIDEwLjItMi40IDE5LjgtNi42IDI4LjNsLTkwLjMtNzAuOHpNMzczIDM4OS45Yy0xNi40IDYuNS0zNC4zIDEwLjEtNTMgMTAuMWMtNzkuNSAwLTE0NC02NC41LTE0NC0xNDRjMC02LjkgLjUtMTMuNiAxLjQtMjAuMkw4My4xIDE2MS41QzYwLjMgMTkxLjIgNDQgMjIwLjggMzQuNSAyNDMuN2MtMy4zIDcuOS0zLjMgMTYuNyAwIDI0LjZjMTQuOSAzNS43IDQ2LjIgODcuNyA5MyAxMzEuMUMxNzQuNSA0NDMuMiAyMzkuMiA0ODAgMzIwIDQ4MGM0Ny44IDAgODkuOS0xMi45IDEyNi4yLTMyLjVMMzczIDM4OS45eiIvPjwvc3ZnPg=="
                            />
                        </div>

                        <label id="staticrypt-remember-label" class="staticrypt-remember hidden">
                            <input id="staticrypt-remember" type="checkbox" name="remember" />
                            Remember me
                        </label>

                        <input type="submit" class="staticrypt-decrypt-button" value="DECRYPT" />
                    </form>
                </div>
            </div>
        </div>

        <script>
            // these variables will be filled when generating the file - the template format is 'variable_name'
            const staticryptInitiator = ((function(){
  const exports = {};
  const cryptoEngine = ((function(){
  const exports = {};
  const { subtle } = crypto;

const IV_BITS = 16 * 8;
const HEX_BITS = 4;
const ENCRYPTION_ALGO = "AES-CBC";

/**
 * Translates between utf8 encoded hexadecimal strings
 * and Uint8Array bytes.
 */
const HexEncoder = {
    /**
     * hex string -> bytes
     * @param {string} hexString
     * @returns {Uint8Array}
     */
    parse: function (hexString) {
        if (hexString.length % 2 !== 0) throw "Invalid hexString";
        const arrayBuffer = new Uint8Array(hexString.length / 2);

        for (let i = 0; i < hexString.length; i += 2) {
            const byteValue = parseInt(hexString.substring(i, i + 2), 16);
            if (isNaN(byteValue)) {
                throw "Invalid hexString";
            }
            arrayBuffer[i / 2] = byteValue;
        }
        return arrayBuffer;
    },

    /**
     * bytes -> hex string
     * @param {Uint8Array} bytes
     * @returns {string}
     */
    stringify: function (bytes) {
        const hexBytes = [];

        for (let i = 0; i < bytes.length; ++i) {
            let byteString = bytes[i].toString(16);
            if (byteString.length < 2) {
                byteString = "0" + byteString;
            }
            hexBytes.push(byteString);
        }
        return hexBytes.join("");
    },
};

/**
 * Translates between utf8 strings and Uint8Array bytes.
 */
const UTF8Encoder = {
    parse: function (str) {
        return new TextEncoder().encode(str);
    },

    stringify: function (bytes) {
        return new TextDecoder().decode(bytes);
    },
};

/**
 * Salt and encrypt a msg with a password.
 */
async function encrypt(msg, hashedPassword) {
    // Must be 16 bytes, unpredictable, and preferably cryptographically random. However, it need not be secret.
    // https://developer.mozilla.org/en-US/docs/Web/API/SubtleCrypto/encrypt#parameters
    const iv = crypto.getRandomValues(new Uint8Array(IV_BITS / 8));

    const key = await subtle.importKey("raw", HexEncoder.parse(hashedPassword), ENCRYPTION_ALGO, false, ["encrypt"]);

    const encrypted = await subtle.encrypt(
        {
            name: ENCRYPTION_ALGO,
            iv: iv,
        },
        key,
        UTF8Encoder.parse(msg)
    );

    // iv will be 32 hex characters, we prepend it to the ciphertext for use in decryption
    return HexEncoder.stringify(iv) + HexEncoder.stringify(new Uint8Array(encrypted));
}
exports.encrypt = encrypt;

/**
 * Decrypt a salted msg using a password.
 *
 * @param {string} encryptedMsg
 * @param {string} hashedPassword
 * @returns {Promise<string>}
 */
async function decrypt(encryptedMsg, hashedPassword) {
    const ivLength = IV_BITS / HEX_BITS;
    const iv = HexEncoder.parse(encryptedMsg.substring(0, ivLength));
    const encrypted = encryptedMsg.substring(ivLength);

    const key = await subtle.importKey("raw", HexEncoder.parse(hashedPassword), ENCRYPTION_ALGO, false, ["decrypt"]);

    const outBuffer = await subtle.decrypt(
        {
            name: ENCRYPTION_ALGO,
            iv: iv,
        },
        key,
        HexEncoder.parse(encrypted)
    );

    return UTF8Encoder.stringify(new Uint8Array(outBuffer));
}
exports.decrypt = decrypt;

/**
 * Salt and hash the password so it can be stored in localStorage without opening a password reuse vulnerability.
 *
 * @param {string} password
 * @param {string} salt
 * @returns {Promise<string>}
 */
async function hashPassword(password, salt) {
    // we hash the password in multiple steps, each adding more iterations. This is because we used to allow less
    // iterations, so for backward compatibility reasons, we need to support going from that to more iterations.
    let hashedPassword = await hashLegacyRound(password, salt);

    hashedPassword = await hashSecondRound(hashedPassword, salt);

    return hashThirdRound(hashedPassword, salt);
}
exports.hashPassword = hashPassword;

/**
 * This hashes the password with 1k iterations. This is a low number, we need this function to support backwards
 * compatibility.
 *
 * @param {string} password
 * @param {string} salt
 * @returns {Promise<string>}
 */
function hashLegacyRound(password, salt) {
    return pbkdf2(password, salt, 1000, "SHA-1");
}
exports.hashLegacyRound = hashLegacyRound;

/**
 * Add a second round of iterations. This is because we used to use 1k, so for backwards compatibility with
 * remember-me/autodecrypt links, we need to support going from that to more iterations.
 *
 * @param hashedPassword
 * @param salt
 * @returns {Promise<string>}
 */
function hashSecondRound(hashedPassword, salt) {
    return pbkdf2(hashedPassword, salt, 14000, "SHA-256");
}
exports.hashSecondRound = hashSecondRound;

/**
 * Add a third round of iterations to bring total number to 600k. This is because we used to use 1k, then 15k, so for
 * backwards compatibility with remember-me/autodecrypt links, we need to support going from that to more iterations.
 *
 * @param hashedPassword
 * @param salt
 * @returns {Promise<string>}
 */
function hashThirdRound(hashedPassword, salt) {
    return pbkdf2(hashedPassword, salt, 585000, "SHA-256");
}
exports.hashThirdRound = hashThirdRound;

/**
 * Salt and hash the password so it can be stored in localStorage without opening a password reuse vulnerability.
 *
 * @param {string} password
 * @param {string} salt
 * @param {int} iterations
 * @param {string} hashAlgorithm
 * @returns {Promise<string>}
 */
async function pbkdf2(password, salt, iterations, hashAlgorithm) {
    const key = await subtle.importKey("raw", UTF8Encoder.parse(password), "PBKDF2", false, ["deriveBits"]);

    const keyBytes = await subtle.deriveBits(
        {
            name: "PBKDF2",
            hash: hashAlgorithm,
            iterations,
            salt: UTF8Encoder.parse(salt),
        },
        key,
        256
    );

    return HexEncoder.stringify(new Uint8Array(keyBytes));
}

function generateRandomSalt() {
    const bytes = crypto.getRandomValues(new Uint8Array(128 / 8));

    return HexEncoder.stringify(new Uint8Array(bytes));
}
exports.generateRandomSalt = generateRandomSalt;

async function signMessage(hashedPassword, message) {
    const key = await subtle.importKey(
        "raw",
        HexEncoder.parse(hashedPassword),
        {
            name: "HMAC",
            hash: "SHA-256",
        },
        false,
        ["sign"]
    );
    const signature = await subtle.sign("HMAC", key, UTF8Encoder.parse(message));

    return HexEncoder.stringify(new Uint8Array(signature));
}
exports.signMessage = signMessage;

function getRandomAlphanum() {
    const possibleCharacters = "abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789";

    let byteArray;
    let parsedInt;

    // Keep generating new random bytes until we get a value that falls
    // within a range that can be evenly divided by possibleCharacters.length
    do {
        byteArray = crypto.getRandomValues(new Uint8Array(1));
        // extract the lowest byte to get an int from 0 to 255 (probably unnecessary, since we're only generating 1 byte)
        parsedInt = byteArray[0] & 0xff;
    } while (parsedInt >= 256 - (256 % possibleCharacters.length));

    // Take the modulo of the parsed integer to get a random number between 0 and totalLength - 1
    const randomIndex = parsedInt % possibleCharacters.length;

    return possibleCharacters[randomIndex];
}

/**
 * Generate a random string of a given length.
 *
 * @param {int} length
 * @returns {string}
 */
function generateRandomString(length) {
    let randomString = "";

    for (let i = 0; i < length; i++) {
        randomString += getRandomAlphanum();
    }

    return randomString;
}
exports.generateRandomString = generateRandomString;

  return exports;
})());
const codec = ((function(){
  const exports = {};
  /**
 * Initialize the codec with the provided cryptoEngine - this return functions to encode and decode messages.
 *
 * @param cryptoEngine - the engine to use for encryption / decryption
 */
function init(cryptoEngine) {
    const exports = {};

    /**
     * Top-level function for encoding a message.
     * Includes password hashing, encryption, and signing.
     *
     * @param {string} msg
     * @param {string} password
     * @param {string} salt
     *
     * @returns {string} The encoded text
     */
    async function encode(msg, password, salt) {
        const hashedPassword = await cryptoEngine.hashPassword(password, salt);

        const encrypted = await cryptoEngine.encrypt(msg, hashedPassword);

        // we use the hashed password in the HMAC because this is effectively what will be used a password (so we can store
        // it in localStorage safely, we don't use the clear text password)
        const hmac = await cryptoEngine.signMessage(hashedPassword, encrypted);

        return hmac + encrypted;
    }
    exports.encode = encode;

    /**
     * Encode using a password that has already been hashed. This is useful to encode multiple messages in a row, that way
     * we don't need to hash the password multiple times.
     *
     * @param {string} msg
     * @param {string} hashedPassword
     *
     * @returns {string} The encoded text
     */
    async function encodeWithHashedPassword(msg, hashedPassword) {
        const encrypted = await cryptoEngine.encrypt(msg, hashedPassword);

        // we use the hashed password in the HMAC because this is effectively what will be used a password (so we can store
        // it in localStorage safely, we don't use the clear text password)
        const hmac = await cryptoEngine.signMessage(hashedPassword, encrypted);

        return hmac + encrypted;
    }
    exports.encodeWithHashedPassword = encodeWithHashedPassword;

    /**
     * Top-level function for decoding a message.
     * Includes signature check and decryption.
     *
     * @param {string} signedMsg
     * @param {string} hashedPassword
     * @param {string} salt
     * @param {int} backwardCompatibleAttempt
     * @param {string} originalPassword
     *
     * @returns {Object} {success: true, decoded: string} | {success: false, message: string}
     */
    async function decode(signedMsg, hashedPassword, salt, backwardCompatibleAttempt = 0, originalPassword = "") {
        const encryptedHMAC = signedMsg.substring(0, 64);
        const encryptedMsg = signedMsg.substring(64);
        const decryptedHMAC = await cryptoEngine.signMessage(hashedPassword, encryptedMsg);

        if (decryptedHMAC !== encryptedHMAC) {
            // we have been raising the number of iterations in the hashing algorithm multiple times, so to support the old
            // remember-me/autodecrypt links we need to try bringing the old hashes up to speed.
            originalPassword = originalPassword || hashedPassword;
            if (backwardCompatibleAttempt === 0) {
                const updatedHashedPassword = await cryptoEngine.hashThirdRound(originalPassword, salt);

                return decode(signedMsg, updatedHashedPassword, salt, backwardCompatibleAttempt + 1, originalPassword);
            }
            if (backwardCompatibleAttempt === 1) {
                let updatedHashedPassword = await cryptoEngine.hashSecondRound(originalPassword, salt);
                updatedHashedPassword = await cryptoEngine.hashThirdRound(updatedHashedPassword, salt);

                return decode(signedMsg, updatedHashedPassword, salt, backwardCompatibleAttempt + 1, originalPassword);
            }

            return { success: false, message: "Signature mismatch" };
        }

        return {
            success: true,
            decoded: await cryptoEngine.decrypt(encryptedMsg, hashedPassword),
        };
    }
    exports.decode = decode;

    return exports;
}
exports.init = init;

  return exports;
})());
const decode = codec.init(cryptoEngine).decode;

/**
 * Initialize the staticrypt module, that exposes functions callbable by the password_template.
 *
 * @param {{
 *  staticryptEncryptedMsgUniqueVariableName: string,
 *  isRememberEnabled: boolean,
 *  rememberDurationInDays: number,
 *  staticryptSaltUniqueVariableName: string,
 * }} staticryptConfig - object of data that is stored on the password_template at encryption time.
 *
 * @param {{
 *  rememberExpirationKey: string,
 *  rememberPassphraseKey: string,
 *  replaceHtmlCallback: function,
 *  clearLocalStorageCallback: function,
 * }} templateConfig - object of data that can be configured by a custom password_template.
 */
function init(staticryptConfig, templateConfig) {
    const exports = {};

    /**
     * Decrypt our encrypted page, replace the whole HTML.
     *
     * @param {string} hashedPassword
     * @returns {Promise<boolean>}
     */
    async function decryptAndReplaceHtml(hashedPassword) {
        const { staticryptEncryptedMsgUniqueVariableName, staticryptSaltUniqueVariableName } = staticryptConfig;
        const { replaceHtmlCallback } = templateConfig;

        const result = await decode(
            staticryptEncryptedMsgUniqueVariableName,
            hashedPassword,
            staticryptSaltUniqueVariableName
        );
        if (!result.success) {
            return false;
        }
        const plainHTML = result.decoded;

        // if the user configured a callback call it, otherwise just replace the whole HTML
        if (typeof replaceHtmlCallback === "function") {
            replaceHtmlCallback(plainHTML);
        } else {
            document.write(plainHTML);
            document.close();
        }

        return true;
    }

    /**
     * Attempt to decrypt the page and replace the whole HTML.
     *
     * @param {string} password
     * @param {boolean} isRememberChecked
     *
     * @returns {Promise<{isSuccessful: boolean, hashedPassword?: string}>} - we return an object, so that if we want to
     *   expose more information in the future we can do it without breaking the password_template
     */
    async function handleDecryptionOfPage(password, isRememberChecked) {
        const { staticryptSaltUniqueVariableName } = staticryptConfig;

        // decrypt and replace the whole page
        const hashedPassword = await cryptoEngine.hashPassword(password, staticryptSaltUniqueVariableName);
        return handleDecryptionOfPageFromHash(hashedPassword, isRememberChecked);
    }
    exports.handleDecryptionOfPage = handleDecryptionOfPage;

    async function handleDecryptionOfPageFromHash(hashedPassword, isRememberChecked) {
        const { isRememberEnabled, rememberDurationInDays } = staticryptConfig;
        const { rememberExpirationKey, rememberPassphraseKey } = templateConfig;

        const isDecryptionSuccessful = await decryptAndReplaceHtml(hashedPassword);

        if (!isDecryptionSuccessful) {
            return {
                isSuccessful: false,
                hashedPassword,
            };
        }

        // remember the hashedPassword and set its expiration if necessary
        if (isRememberEnabled && isRememberChecked) {
            window.localStorage.setItem(rememberPassphraseKey, hashedPassword);

            // set the expiration if the duration isn't 0 (meaning no expiration)
            if (rememberDurationInDays > 0) {
                window.localStorage.setItem(
                    rememberExpirationKey,
                    (new Date().getTime() + rememberDurationInDays * 24 * 60 * 60 * 1000).toString()
                );
            }
        }

        return {
            isSuccessful: true,
            hashedPassword,
        };
    }
    exports.handleDecryptionOfPageFromHash = handleDecryptionOfPageFromHash;

    /**
     * Clear localstorage from staticrypt related values
     */
    function clearLocalStorage() {
        const { clearLocalStorageCallback, rememberExpirationKey, rememberPassphraseKey } = templateConfig;

        if (typeof clearLocalStorageCallback === "function") {
            clearLocalStorageCallback();
        } else {
            localStorage.removeItem(rememberPassphraseKey);
            localStorage.removeItem(rememberExpirationKey);
        }
    }

    async function handleDecryptOnLoad() {
        let isSuccessful = await decryptOnLoadFromUrl();

        if (!isSuccessful) {
            isSuccessful = await decryptOnLoadFromRememberMe();
        }

        return { isSuccessful };
    }
    exports.handleDecryptOnLoad = handleDecryptOnLoad;

    /**
     * Clear storage if we are logging out
     *
     * @returns {boolean} - whether we logged out
     */
    function logoutIfNeeded() {
        const logoutKey = "staticrypt_logout";

        // handle logout through query param
        const queryParams = new URLSearchParams(window.location.search);
        if (queryParams.has(logoutKey)) {
            clearLocalStorage();
            return true;
        }

        // handle logout through URL fragment
        const hash = window.location.hash.substring(1);
        if (hash.includes(logoutKey)) {
            clearLocalStorage();
            return true;
        }

        return false;
    }

    /**
     * To be called on load: check if we want to try to decrypt and replace the HTML with the decrypted content, and
     * try to do it if needed.
     *
     * @returns {Promise<boolean>} true if we derypted and replaced the whole page, false otherwise
     */
    async function decryptOnLoadFromRememberMe() {
        const { rememberDurationInDays } = staticryptConfig;
        const { rememberExpirationKey, rememberPassphraseKey } = templateConfig;

        // if we are login out, terminate
        if (logoutIfNeeded()) {
            return false;
        }

        // if there is expiration configured, check if we're not beyond the expiration
        if (rememberDurationInDays && rememberDurationInDays > 0) {
            const expiration = localStorage.getItem(rememberExpirationKey),
                isExpired = expiration && new Date().getTime() > parseInt(expiration);

            if (isExpired) {
                clearLocalStorage();
                return false;
            }
        }

        const hashedPassword = localStorage.getItem(rememberPassphraseKey);

        if (hashedPassword) {
            // try to decrypt
            const isDecryptionSuccessful = await decryptAndReplaceHtml(hashedPassword);

            // if the decryption is unsuccessful the password might be wrong - silently clear the saved data and let
            // the user fill the password form again
            if (!isDecryptionSuccessful) {
                clearLocalStorage();
                return false;
            }

            return true;
        }

        return false;
    }

    async function decryptOnLoadFromUrl() {
        const passwordKey = "staticrypt_pwd";
        const rememberMeKey = "remember_me";

        // try to get the password from the query param (for backward compatibility - we now want to avoid this method,
        // since it sends the hashed password to the server which isn't needed)
        const queryParams = new URLSearchParams(window.location.search);
        const hashedPasswordQuery = queryParams.get(passwordKey);
        const rememberMeQuery = queryParams.get(rememberMeKey);

        const urlFragment = window.location.hash.substring(1);
        // get the password from the url fragment
        const hashedPasswordRegexMatch = urlFragment.match(new RegExp(passwordKey + "=([^&]*)"));
        const hashedPasswordFragment = hashedPasswordRegexMatch ? hashedPasswordRegexMatch[1] : null;
        const rememberMeFragment = urlFragment.includes(rememberMeKey);

        const hashedPassword = hashedPasswordFragment || hashedPasswordQuery;
        const rememberMe = rememberMeFragment || rememberMeQuery;

        if (hashedPassword) {
            return handleDecryptionOfPageFromHash(hashedPassword, rememberMe);
        }

        return false;
    }

    return exports;
}
exports.init = init;

  return exports;
})());
            const templateError = "Bad password!",
                templateToggleAltShow = "Show password",
                templateToggleAltHide = "Hide password",
                isRememberEnabled = true,
                staticryptConfig = {"staticryptEncryptedMsgUniqueVariableName":"e99f1d38c55857b21405fe23423fdc7997eeeec750ec6c92dd7f87e28f08044b9b38db0129a5a77fb4d447f04452dd5f74734303d1ff0d0035ec1dd989e422ae527b85154d9053299d6ce1333ba5192d730dbb6bd5872e74989d7a60f2c3d529b018220a3adc0aed1728e152203effd3ef9e6e9e496ad015828ae8a930f9669804cd29c82164abc788fc4d8f1cbf3082932b539c9687e5162061339daa4c60803112268b184e9316cac8e8bd7148d4a5b2a66b0a27ee62c5a57331a0bbfe1da0b6a78ff17415fc05da340b0dd6854b15a81b60ba345db6c58b62f50ae9a0fce301451542b70a59bd3c43e69d98c1214391dae0aeba743a88baa9ae8139d582518a3eeaa75b86abb8c769d52834f04a4e2ed1d2909b4b0dee743e133d0f5f11ade066f28873217e2fccedb7960fb84b790d115f313e44a4bef07d2d7dd50488187bf23be476425d74cb1fbda4ecf78f3ecbd2fc550143a9cc2ddee0a25ee736d6adcceeb8262f16505e689568bf6ccb03a997a28dc6bb70feee4074107184a2a347b143fc55d0e5255ebd8fed5781573e40db0456c705ee66ee85044e35e9c3ad2269886f4b3731a2b9f21a9d2c3564ed5f9b4f5619055ddd153534fa3dfb5b5ccb5d5d60901d623ca2289c93f0da75ad393e87bc53e1b8272c6482c4337bd912a2bd9feaec6cd2c07e103a0fdfc75e88483a69c15ff86f32722f5dc87676285933a9dd6b8c844cc00d612387d9208d8b190b312ba026b053f69d3528b49e46e3b2c36e5d58d5f92ef9a6592fc1494982169aeb60e0f079a5e6c8564d0dbacfdf1c02753608b3d23d160e9a391bd0358b4723c9bc2d90c41cf45e54fa64075aaf8e8cb4b4281fc415607deab1d79e5d3b933277660bbf2c4f5f7d33c1224bb58146b5437ded49884b9fc2a836facc1be16a297cbe1056566b0f5b61fba1934c551bb9c769fadf37b18e7d8d225611e4f81f91fb9caf6a60e74c6a9b197b386993f95ac845a41835f86de5ed644dcc9496aa691b8d344f734d33ba8f80cc68f904501e241aa0be4ecf22169adcb28c0d26920cdc73a14f1564a4bf42620fca326698b4a428d74aad4fe1541b3d4d16f84d505971b46a0861467130425473af2faffc9077f4d87c9adaacc2fef438f023ed6b4e0cc55f2aad65f3aa63b8e7012b530249abee0c6d6b6ce2d576565bf895e76e8f08f4bfcf682e53238625e9b1845ab16ef3532303373c3ee9042b3d53bd48ca7d083c37a6626d1676c6175248af4408391329c83e6ea4b6a377615ec8c10fe67973320288348b74d8fcf4a5f9bca9d2d9d535fec3e37e9f459ae3b32abe1bde5ee5f4b8ed4a75435e5625532ccadc1fb751f06cf4b1e54d9c56b3a68539186f2a2eb9b5a742379114e95a0f520bf2c46b1012e46b38e781c11787a3113e5efad40661e348f664a9b0a814df287e2d639f04406981574410e90be9f59d327cc8f68523ca1430bb067ce760c6e7aa4ff7b9285c4b30f754f0fbddf725f7239aa68b98e716793dd6e7d2b6dc3c2ed7ce77aa4f3f3312ab6b9eacd395cb1fb009b72552f6455e76342696c144a6095f6562b58c67fe95859b86271ac2cd231bd25ca31b7517ddcf45cf764a52c7cfa5ae19792de4a9501fb7063b6bf504817ce65c63d1ad938ee46cfae6152a5bef27b963c644e803fc98f8804b9665d4b71a7ae5f5f3561c80cb129fae75c9ae027734620e1495355d627e8e96c29c1bbf9342cd25e99adb96ffce969712718a545227a917bebe779d2dee95dfc7ee690d2bc056726402540b3077f9495d832955379eb80501af8c895d96d330cbea39790cb611344828eb6f66543bbc52bb514cfe4fe60da4471330ea3bd986d652fa4acb2315f34df0173761e5b4bf9e8591c9dacc96dc62302935a8e352996042b77ad0acef16e4d89430076b0ad8616d46f5aff76ecc115e2c1d7add41c4fdf05a93ef989c4ea0d4873184ab6b0ac9dc93cba073330249c26e5e486da5ae4a3f025a71dd4b8023719e1ca8aabc8debf84578fbee055703da86a9135e9055fd61b534fd86ca0a56b070841eda67fe248df197bad61cca7ae17fdca94e7ed08f1e99374fab7c1f2cf8ba87b23068152043f2c92f585eb129ed4ef674f1f09534900762ce9c3c2b5fa412181c2537fe60f41a48fcaebf27cc3f7e07617b53c0235e1e3aa9c46986d9f58a6e4691c9f53036221b3dd61b392a961c372969066fcef1fe39aa5a0a692fad6de68a299df53e0765319c95b04316e52a0e71e044db17a4c799b08e69b9e2480b9522941eae42f48092b39d62148c972ea1977eea6c7b290f0a75d7729a1b94d5c0dd379e6728c8b14bc5494849c822e758acbab26387ffcb1dc154fb2b6ce3f2c62a567e030fa26f2e8e924af651e2e9cd400eac84d0035d7d8c79640753230475d281c579415f560bfaef5fc44fd54c716f37133a687f9cae674ae8d0721a961775804e64247ce32d4f4a60a9c6a524bca308baf07cdfb4728c8f3dafb6d71d1dd4e012d272655eac2d6a0285aed3eef933207d7a427a391c8160052922921d2d60bdd968f45c0b04c42b9f2e8e388a1e094be37e4ecf638aa3d70150154d7cd3934a371929794143078a6886a8c17ba37fcdb44af45d38537c01969df2bd2393b38129eeeeec75ffce70af686783cb2022775da0c98540fe90fcefaa5d245b6f2a1a64118f6eed2fe27e5a5ce745569397d0b8d63dfc4e37fbe217023a43ab06a689e56a99f6a1a1b0015e1ee54a92c4e06b6d829d6ec133f5f1a4228c97cb4c664d021e07f612f9e70548d8e0539d0d2e020c0c2f9436ce468a08c7e73a5937fe7ff4eaa59f4b9856e490842dff49f8ba0724e3b1b41c0708adf933c57eb6d90b97a8178f4f843dff6b1ea0a758a6a678554e5aa267f1d01365db1d9d5a384db33ab65952b550268bb7295c41950e10ac87f85af07c76a4b9dba94b049822f8cdb443f713cec911749d5b7c7ce024bc1256290788d3a8715344bad806228f8970f5d1ba1773ec8d43a49790a36aa65e63660c575ca34ff975029860056879d3c76a2469b02cebc1772dc3c243b47b947d32459e9bb39c26284d8b8fc14da80dae9c2249cf0602c9ef76b0a52953c0f34c0d60e755f3ecb9f962eb5e8cd2eaf9316cafe6eef424cf1416f912a97d8080957c10d8186265ed3223bc104d2c9173608ac5379a6f860e395ddfb86d8a45e0c63139e8488c16f76b4629ac1c020c7aff584e865e8d3abbb5e3d01f6a89d231c240ff1000e441abb0b320a6b21ead6553355db76c3a3a7e15720e14cac6b9bb74bec9175285c25ed5a21c0618d192403d2dd1f8108adbce819efe20fb51ea0327cb9a8577335755d9f1f74da18b498b0d5ecee55223d19ee513ec9d44f77fd85e73dc31cdbeedf482283ef37e43b514138964bb561e9fab4a76bc25abe3573fccfefcdd6538a3696ff285d1527ba5161e8aea3a746e9b668375c64535dfd226f919baed26820fd2f0a975c0c4d63e1b9d8932dc0d9e53d45d42daba3883812aa3f0b464cd6aff7b3fa0c6b2cb3377f82a2b521f63e0655b1270170cc1b9922f6e4cd9a0ac12524491a9df88e64cc65cb2ae202fa65774397fc6de69dbaa8e073c16b1c6cdde7d6cf8047b0cd0294dade9a47d9cbb12a29c564ea610e6132abfbb6e469419bb9b22cd9540126c3df0cc8aa70d953767afa3e2cd8e9aba82861413d8e683b1dea50bfa9691b7af6daaff65aae8ea32eab83f7699e4bc4f1e5971b8c02480aafddacb7a84c898d079393bb8ed3b5eefdaff95bdececf2f58556d1ea5f341241f094cb7491e2f1c70d7bd46fd31e1af49ca52559016d27a4cb7c301d67d362dbf2a80f43f7236b5d168f84d9b66ad6ea44217226029718e6eb5119c80ab98bd8a525ed63c2551f0155b81bb9842f5afd646ab15733c4a2dcf013d32b54a1a2c9e7e585496b666e882811c74d940f263221a90e103fd2cbab70836f859ba3c82283e2e75a9b66d79bc647910c6f2b1b662f4b709de706ca24c1196467ff86ad4e0fc9a8ce60623a811038538d1dbdb0a32d000904b5d8a698ecf823c4fa9be4c922945589cf83db7120c693c9ba25ac782da03aac5c97e80eaf31857751030a358716c0c5bd456450f4586305fa41a7666b380006996c6779e080e16de2ad86054fb2ab41696ad1e14ea5f756266487917b3fdaffc2ccf2576007de3e86553107219ac55991d9a967e30a87b35f770b94d67e9bef0d8cfb504d777c8d10421ff1ac809f7fe4f7fd7ba7a7cc916afac87402dbe916af66c5577cd0e88b763ef429d31c681090487a657916613f9aa17ea683bdb509e5df83d52149e015e32e5f301c8139bf134cf30b93977ef4f2023e473ae4d9b7e3eb2b14d7bf189da61c85aa258b064d89a6801e5391e4ea51925a8e3bd0b1dd8d382bb285bab2ce51879a04cf2c916f574a310c8697e66fe033ecd75980591daa13a9fa0d5a8f5c9bcc2d45b9024aca452257c8bdd7c859041650aa29693d9afce302bebe2c5a06ce97107f5c50b53961aeb515d67ef99296ae9a8c2e866fbf9cb52629e6bd213457b365182c264a75c0aa7bd8c7b24c504fe3faaa39588b0db8a6c22d14246352531aed1f3a067649220d69b896e69498d7d0190198b5a6fda8d46598d7b48fdb18313381f44559b8fcc46ec042afc81053fa6c5d717fdc898a27adff821dc8afde26304254e7e08cbf3706e7cc46b68e72cd3b770dc2b8cad06f97e53d7037a01ade87a33beb03d68da6362c30b0385c2260ab5429738d1d4b03802e8443e5dfbbd45c9a9468a01ff5e10ad25b4ad83b7be713e615ca01be9046e19ee00a541ab2f95cc01ef0df71ed6ab5a561e8af552dc32820aec2a0f7c8acc628f97ac49c98f185206aefd738af954d1b69add642d6505af2c14176c915d2f3ac85ae7daf2f26742054b70295ef0d5ec397835b543ed2ddf00199b9a6376c9ac4eac182bfc4079ef4a5ed06d126b6a8b44711bf6ff3dfccbb496911460aa63515db22bd428be9b19490ee3f7089c449dea34f27dccb83cfdf09014e3f163c12700d69b774fbebad1054070c61b9310ad52c8b582a79a47eb9049ed6bc1c143ea4d03a3b7f6c2eb7ebc88427f3513ca08268a8caef0786145b3a004208aeb8dd083f0ff5298e382bed9d7487d8a16d3319c4419118df84a1865dad7ebe18728773b8fb2745fd9b9ae2cc5cea02115bd69805bfb8c65cbcfe1fb8f30ee8e82c0c89821619ac6acb1dd1dcb699af31616c6c69eec01bf6388868fb617e4c3bcf8ebc5eb72ea6b9478616d6538311859f824fdf4e6b1db7795b3b72d083975d8197d76905ca6bf49e9b43137cf696b40b078ad7417c96e13c0d6d2b7f377789d94810e2a740a6e84d84dcd93722aee6e7a56d9ffd1ec35073a6e17d40413ad8f18c8e9dd034fce36474910ea861104269d01c85595fbe4a946fef5579ef10b2796d78becfafd989eede518a2224606fe62d5f859d7da4455783b29f2aace5fe20a4b72480909bf5b9a93f35d63dd85d66aa466f7901384442cf6b31a2fe15fccda6496c7f1075621a44047330f8c9ea8ee887369a97790b3deb2e1f085bcf5983b170e6758361e0d1117db829c99755863c242aa0ecc44832675c4c7180619ebe7170867bcc8dfef52d5a6562dcff407bf0a7a0c6eb25f7e50f6e6f20a4e226441b56f8f5a737bd035b75d077834467207d1c7fa2f5adccd1896611bdb7b8b54f8fe14585e0106c9877ab8dfd7907a6708f2e8f24e4473f6a7cfef09dc6a8df8d9cc149457a96d4993cb79c7e261dd427ff4ab17ac8dc12964722a52372af2caf77c6510147931e86ae87aee42db6a86d77d9e05f5049e7333c61e64a3b4da40d335243c48c0ce465c012e9bcdab0b8b0b2b7f3b6ea5e8855bd8f27078e88a4ab28683e3892d1964f8483ecd092f6d5df6d8cce9acf3175bdcab5fba7b294aee28b26ecc51f083761ed566c9ca19d5b1411c3653d82b0c6eb45973a7fb76b6a34023ffeee4b059514c3d47cf63f8c49fb903647053f54d09653368659bf4a2a8dca74315033887cf3d966e45a318312da43ec26968a19b15def6dcf3d792dba9fa19cc467e317a9c3c9d80e4e81fd67db0439d171d904bc96dc6fde8b96b1047516b28838b4249dcfe99bbff27f0c84655073155818d4a805adab7de47ebfd2f89b886d6bdcb4d4240300aa8c50150f14975bda6e2dbb5e435f5fda5b617883b5763936cd434e079f49db4dfbef9378f746ae3b0fc2c533a4feddca4d414be51c3eaa4fa3109bdfce1518d45f6c230e343b1df6f6a4a7e3b27aefaadb55c3e17ec4ee55ad170687120cac9ac49ffc29066e210451f91bc1d0af19422993b26dea38ef0c355e5cbda12342e22adc4f9372ec975bacbdc74e5b459b59750bce1be8b4a14d483e96cbc48019168c4a4e2abda229199b436e33895f22984998789dbd16dcbeb486c2db5b2cedcd62fca1b71866e9da7bfb21ab609c5695d421598f3b5b4ff80b30c1f48b5d129d3df8e8e105b86cbd20ac14d2dd732e381d52d1f45221574818fb9984b0b3a26ad9c07e46eabf7e1c00f012a7cdd11f18ef6cf6c42cb1514864ee6ab099928e3409db5826ec212881b1bc8a6126f945a52d97b7cc4c7619e93cbb867c2c87b8657dd69944e568a9b02ce7f6aa319c8f3f0a8c64199e91758b3c715bf84843f75765f77480e35112f2d901a97c2a97c64235a412513b2909b4756fbebb8c5740c89385e067f3784d8995fc97f3b47b1a3e49812c99202bb04f7c42d4b2aa3d3272d734a14bc0b2e2024ff12fa90804d35260fcae6286d56c47a0da99cc8f5ec1b93139a0b36a4f8bd1e54f7b5aa3519e835d25ada2ad4ed8fb8d52888c28ecf97f046e63f654981b0533a16e664f359a14a8470b5131bc7dcc50be18702ebd0f945ede1778043434660614d0e2b9cbc12ed98b1627e828ca76f6879f98c6c68e7920c0b861133a11a9a4e8a8fa4919c3aa0d930a86a72fb0a11f797c6c30f2d9f6fab3d874c5477fce530ba502657ccbaaff8492864afe72116894cd10d2864ddd9b7fa26e8f2b99c9e71005f5c8c4ee96d5d42473ffc98533143a6c9fb2754c14b1ca6f639d879968299e96023463105f541a382ff9fb49916ba1dca753864ea63bc69f8eb3e0a65f86461f9edc1355780f40b8982b49772a0554def7e09f56374aabd06d27ff10c8e0aa6d0a195c23a1323e493142e307020de0ac2936059d58a5455badc46df0e95845b84f9bb92d04cf29065efeac42d613a45a6bdd82b9ea7191ed323d85e311a2448509b980d79e66b0571a71ac9cee25181425329b55ce5fe857dc0acab49612d53660ad25f99708f5874aecd26cf5cc2aad814fc4ad4f999a502fcd11e47dbf453e9085e5705379a52638796654b11af127452b1be47d865970fb02af21422e947645be5944b05ff6087a8241c5530f43b781c9517a894a2db3ee95716aeefe4f2f717db629bcc2af39be0f9247babbd16cd12b92fda323d93ed68346c1ee34a7521edfa23cab0d059763c73ac43e698beec440fc0be66a0ddd5be135c8251fb865218f0e509b041cbb0f44b1ff0f91ab86125bd5c94df55d8a6b60f995dbdcbe15f3a07067ce46d1e84218a2d9ce79b7f516e4943d4732d34d2a149f32672a6f0695f971a7d9fb924183b3b9ea0db1304a67df9b78a7c2913ee0951f1e52cb041d119430f88be4908a1b7966bb674b0702d412138f3961d91e41548063864af7e5d90dbcaeb4709b2872afda82dfa9db766027e3b7f8684f6a41341ad0ece3cf396e1d2fa1464d2c25bbfff29440dbf0918cc93bf187040a3f889759ed3106d36e3bc0f3321436e350709560ebe83fe37abc59070022b684324f0130cf9d37f89fba2d3cfe43130937c8db63acfde511d0064896e6ea359752e6b9cee637edd2a1a54a5646137aea8285c57531ca5a37fde80c5a4864fadb35008ae100dfc335c0cff177f40b3da3ba2cd98b2da252167ba570f473b9d7689398ddf59c18c9b33020aa734e0e235692cf33bd7b6c2ca044ac34c81b2137683356457ec2d9c28efa5ddd8b175f3db22e39d4073c88ba040eb48d8fb0f6e4c7fbdd04e1b6da75009a0ba191cf517d6213361ee564d078624485dcfb8e3fd2bc7553631901c58540255aa283d8e84f16583fda01f005a4f5acb9498c3204dd0430dcb7c8152dedd6e203390cf609e3161a722bb6b517f1c7addf4a07c7cb360a622a509247e9719fbb0b2cd30c5c23c361975a2d2ab21c9306761dbff7b0e96e290ddcf61af99001e359557ff540cc010321c8386b361db465b9d521642ffc33430c96d20fd1ffeac31e4ccad079402371e19c35537cdfe37ac5063ae65bf0bf7bf7b61ef18f694937c2701fa4dde774cd7b14becdbbaca2437455ed82e7191282225f162fd3846fd80a4d209fbc13d996cafc3baa7e58b4f4a7dc1fa58b8eebbe37175246042fdeef3696cea882e67445a7673363d9f11dcef5ba513d9e22fb20221edb897221793d8f6760a8234606074aa2dfcd313a07317c77604c472bf02a880f5d156fdf5def009d6ec4746a435fcf251ccd93c16c6b9e258b8657c8fdc37f82855e8acebf3b553dd965ac347fea1bc22a3e0e0d0c0f6382acaba7ff3c1940aec0435b855d51988b86c3b692d0ccba68e7091c545eb8b50e313471d2836200f1b60ad0cbd0bbe5dc04781f96f84809718c1e81d9b67242441254b9453a95b4db9e281ce1a831ef87edb994293a83883dbf7991033e52f8868b3ba0d27551447d3ca1428c6fec99bedce7080d6ed30b6e9916f201d024376dcc8f036ea008f8152c1adf4980cb17641dd4f4b283bd148f6161abe0d5bf612a4df0f80aed655c9da8fc90687ca4320fc6fb47d702a01b78b991fe57d3e000a1665db9aa536180366f401f5ee619822eaa7966a2592312e5efa2e23dba45e239790e799daf4d4a6cf94b635f1dedbed47b4ccb7800fda695417bc602800819ff67e2a1a6a5c9e02e12627ccf3297718a946b4abc7a36ae71af503584d26dcdd2a4a0d5687101190c7f816a86a6647946e37e467cf807697cb4d0270320016f059f72f4d051a730c9ff08c687572c5423064dd9da1586eac1d0c203eccb8e697d132bb2d82134d69d5035c1fb2054051dcac1ecfdd901aafeafeee72e043ab1c7df6d017ac28b0370b66f4e33c054d9fbaff309f754aa8396e512925fd2a17a67d472a514fcb38412819ea231d994a8d20f4327c5033d8aba4717326af50115db18d8557abe9a699c4d30f02cc53ae6ef8e664ff4a2e7d23cc028dc0bc9a8ca110ad2ba598355288c179b78f8739fbeb2e3d680ba66cbf6fa2cb176b8ee72e67e3167449970df035dff0a083f2934bc5597fe8ed8096b432dfdf086de948d8b25aa0c22981306cbdad32d66737767c2264888753afe0277aff42bcb4108bc0e2c3f1018c8f0c66daad93e7799b57992e80b63448aade5736702a1825ba4547877f5c8cc799f0acc5dd448396bf7d012dd6e60e3b74aa027e7de653c74ef7bb8eace258403ae3cdaad1f014e3b93456fdd3f5e267cd66a48787c23d8bab3f45418ad975485c0084331e86a4dc4b1d65442398389f2e08f367c74811545d6b07eecaf7113d9f29ad5d3d2e7cea413f9baa15b89cf74895be43a44eb410a80d2645618055f9e262a4ea075457ac234489bfe9690c51ef0711937699c161a8b659eacc5d1a522173db15a09a56b67cde2d8cce58b3d6c515863434dbadf93467a7446697f3f346c705a0bc8a56503bbc4c7656e335801ba283a5aec02694b128a97b09172f7fbc01d7941e7ddfe9dc0883e6627c91bdad73ef3cbd48e344b6f407108477f6727a05af124eb504dba574f46a6a1fe47a0f1afc9ad38f60a488307edbf43e3ef18045eab7d686f78a6e840d5ec7c3bbb64b565160ee721feef2b3fbe38e7f98a5deb5e1e1c30ee547b49b37b8555f643058b2dfafe83d9b7831c393042134bb33bbc9a229accdc2962b8242446c4ccbdac024e8516d0cbb983f57f558bcdc4f2b932968e1851ae0ef2a47e092181ee9c3182fe259975f6835ab8c36f38d0fca9aeb048868a5068fc7f950651c6ad84ac89bfa3f6090f2709d77d5db52769642c95b6bb4f888888a5abde533edb1b433c68db77a3779121288bb7955e5da4cb23a37ef4d19c79c80f451ba900c84db1759e0f055f0c6d8f983c53401a191b7fc6eac759214750d011aa8152cee73dc6e2ee5ec8261a8a18feb75af810be6a586615af2e13163e103fec5324300b0575dc55ecc4b9833d7f6aae58ad4274228dcc6d8b5362501b174c6086e9b9c5d2b1be0196ba56334d0e2d92f14fcb9cc03f62d3f21989b6bed9d5835e45c7274fe659aee7e34caa6d849e1b97607b913229f24167677ad84eace7f12e55d5d41acd16a3f0ed9022ce9290eec5ea453510d8046dec0a45630a01095d691364b6278c5f27ed173f7775910b71bb20833a21984f0150b2f823018c2f31db70935473eab765585c85cd58e17483c4ea8c1e7bf02d0540f36c353cc1269c68afd99595de5d1bd8fc6be1593ab1259ff0757b7e94f1cc5990b2bb984ddba1c2048ebf5614eb9393cfd9ecaf63ca347d6914a5347bfb446e3518031440a5b3462d7df4568ecee1e0b757df365e1096dccad5f0d22d35c2ea87a03a4305f51bb4c2027404224f87aef7f2a07f3bc0ac19c43a73589722cb6d912bd12dedff15a321d987e5ff7f9c810c041f31d5b3c99321f3254177553ed47f9e34e93ea4a0a9cca53606d932c49b88bcb6c7a7db7899cade07a251e7f15e19060befb2ed41f895836a84fc72cb1c4b19af187fb0fbbd756c36dd1064e182373c14af5164f5898c4e48aa492c5c96239f04cee3aeda7cc6112cb27e81fce7953186881ffa8e96921421272965d1183e86b7137af5c2562b2179f6aeed4322df05c0f1ad6564020f381c7311dcae8a697fe80506310a6c21727eab2e3599dd845a3388372cef9fdf4c1c85dea8035b457497fc1767f374e062324c5377f800f334c43b3be1b6aa205c714c8ca53173e99ff13b457392075a568e2fc2538a48e3b9a7884edeb241d17d75b737f070d05773eeb58352596ec09e78ec5a6caa7c65765eec9344513c0dc54d943f3026c6360c3c4abc7552e2d5806c88ac989c6877eb680a16a54933c3bbd203e729a87fd1ee31a239c114075503bedf325c672feaa7fd9ff16ba7aa46a41eef17df0925f86c3bdb20d03ab25d2eff5d23dfac6c140f75cfe139735296e0ec470b908972c6491ce3646492a0599c190552ccce2562b4ea7d3ad9e6c378441adea58cd59e657840bd42eb42952792917add3caa2fe4ef6d8817510f813fb87944644358d418cdd2c0b2918ee1be1f4536843778d661b2104571e17ab3578214d58aefdc375e19f43ab2f27d00c42f2b24f6aa88632c6b2d13ffc5553e6b7cc3510620955024ce88750856abbb72faab9b5633454f36451303ecb9670d9e2a6b9b6ebf47068d4f168c7b2dd94804a1977889cf955bad72d2057fe71f5b5148e2afc48f5432b71c66aa759eaa7feefd93a187c60f58b1c0424b5b6b3758303d182cabee23fd01be3bc13f1eb5b054e9ebe4cc26c6f299e562ae3ff7339df783b9741b6dab7ec43e59838003c88d092313f3fd0f34928d3137cbdf6dced36a39de1a51efc72c82648cc538b447de7da8ee903b99d5102a96c9c1e68c3771c4855e66d054ac6058df7f01a2931102da4e5b80ed982224941ef8b998c85596261b6b844212d34c76d3d76bb041563e0bda513960e4f9149c7b5aeea59f0fa95ecd071f1c011c72237c1e9d03497dab32661b474d167751677885dd715a34c12cb9492c6c5f1b32f77c5b25119ad9f93e6d36ce8f6701e63d22dee744007ef58155beeffc8ff02cc256ddad030512f1e7e0c9b03a1a014cdcfa37c5c6326f616e9a268720b9ee820d78742056b06086800c74c065bc920a0b7a6f6fc0fbeee5e5f650fb658815897797b41b93626f7117b33c1114606ebf7bf5dc8610490584b26d38619ba5db428ab3201b04102cba1ddb06eb8b4d593bfccdb5f1031e82f53c0414822a0f29048e26fffac2b949a20c5801a69ee05677de944c601c95de8f70b7ec1adfb075614b667a0b972657261810552731d44e62d518fcbda9012ab4e51f4262476adcbd012327aeacf6d3d9e90b7397780fa166237a63f80a834d3596cb50ee83f86d8b657ffc7c6efc56942b5bab2883014e73a2c642c9d0315f56d497b0562158d648faad6aa02fc74708bbfb93ef0c3f4a9ebb9357ab68ab662a3ccb53fa2b96f240cc2ccfc0b496073aebbd216fa8571e70b9167afcb5d1a0c51860b1479641b350c38f1dabe8e6381c00e37c6813155c0e212f3a9c33382ab3684d471a81f1ced96a4da974841df787bcb7bd1988fbfc89570d1dbbd2bf7e515c5af212341c2f5a05eb4a1e69d54f9e492f4d10c3bfd5b14041124fee57ddef0eace611434bbdd1782622f7550984b91afc9b6af684a460291e68358addc008a7666cee9c644cbeaafc0917390b46935b7011c2937c0eded8d2cdff7bd2bfc0d41d39e13351062f5ee5c7a95f966179a3a8fc2707e5b77dbe2168e492261945549978cfb51a80032873440a22749067cf1e1f5bfecab741d57d79aac8adae8873f2393d4a34b736e7a34f762a2dec95d457ed903f67f7ec520fd41a719fe78baa9b779dcff1ffc04c4174fa649a5bd758288e7d039ddce800c9e98375386a9d8150319b4b3ae3fe17cd65e4725b4a47b3b04dd65aae57b652c78f20de3ca488289bfed79d45eab602210d38797d94f6d68d60c3afd4f4111ba5671337a4a55af3f66c4cc13c8ba32686fcd2e8635c52b6555c3d9d4bede9b28e71d22cb2bc1c0e9281bee144ba2f65b0d10482295e7968ede45d5e6a288688d71eb650509751c78f914c52253203089ad00c3870e89ed860d97e00b0c4109f1bc3bcfe659b5dca1709beb5c607672f49d70b3f01eb4cd3954cce808145ccb87ed1ecb87b8c25e5956723352ffdca871d9f75ac898699243b51569b0eeee8b5f827c179c02c099aeee4e4fae9a819f552ae6e4ff00ff25a6897c5ba81369519f16efa05256ae0510bac536e43b674bccb6e5db3db84dbe3b86b7fd03799645b7d23746071ae57f21ac96297b61a82673a6ea706ab0536a922b8df5482e037346220172b045b7d1bb46811041174b99e234e8e7ca58f0d083524455b82b8cb999ef3767ec5d9bcc616025997de6f486696c1de17afc61a0daa240c778200c58bb0920e19e845ae64955c3e2162af30d3312fa4dd88d9889d744a5bd05a17642f996b16a7ba4980b2fa616f956a3709e4219b9a91a43f0852949c1727abb1a9034051ea8e82cdb3b31aa4183d937648b125bca49c2ed8e9e9c01d0eb8792790c530e625d378e28fb9703c89caedfc28b28a04fe8476f25b46110b2b06ba7362d2c9d088c236418ac7ec2c6e7107ad24615b193c243f03b500617782dc6892843dcf5a863367d3bb155be083c521aae3a053c01d46f4f9f09788311665e934c19b3625882854483bf036a94da85fe81e5b339ec635b560903bda7ec585e697d284a51d8569a25e5d276ec4bec957793c1123fa85659fa1e5d2bb2e5c3fc1ca74ff6b9be21c2426b5a5c844268f1eb2b795425bb6e4e8431dfa5b6c1b918c079fa403a818fc2781f547d90b8f1ee1f1e8d26ac7aa37574bf444c43225d2f37e794c8e9bd75ab94e6b92e52f7ea863adf3562f62fb43d3b1ca171ea353bbccb40f41830dec2a44de04fa23196e9ddfa7b91c69da2dc5e2157fd0affa956dedabd5ab0bd2bb4f9cf7bf210056e560acdbb5e6ec0b7d5c4fd6c87df98cd91c04d82a57c2498c50461639799d4720aba3553fcd02db931d90d505e10db8097d897aeb58a979a50bb1227ed6af11b3280092bc09d26e4a9980d307d746d6c72e51dea7373d895e15c9b77fbcdacb5c056b6bc34ba40851dcf024aa85d0a5f989464675d18885137ca18e89bfd6b1ae82da9f81600e6013a36bda2d4d50833f925ed85a09b0ca39f0c0663bae4db17b114556d52feac299a01e4d6686edc43eb87c30a4255429ae16076995ce7843438f692279638de6a984b3c4f90558e1b4e0beefe7e5cd3cf9af99c76c3bf1fbe42d4342a4632e203eef43d88ef6707a42e70e499d88936bcc89b1f90ad4a7ece7a09eeff444f18fa690f363e859fb5dd5b16354735df1245cd6b42abfb22be39e502bb0399d4fcc3f1ba0c08f2a5262518e4c32e77bf6434f8b71ebae1a324f4ecd55a1587694c70c460f86d6b4d3fcba685fb0d4e4879e3fcfe13667805686ff5bc3164366bf033eb42d0f8e35ec77720005c46ecdd7a6543625afeddfc855d742e1c2f676ba001067de4556a0c73d6b107ab05a185a5dc251d95b0b98b36fa0e7a40abb9e53e2fd49ad583cad996ab4582350b45e97de29280c669001de09d2f7306512d1734de6893ef9c979691f62c5f7b415ad8488b0f183d2fe66b0403b119061d8cd5275791d7d2af2b6bb0a4efce25a0444e803d924b770675740718d1589b94e9828f2c898c86ecc1cb3c5ec24243705ec2c1e395f477692e07bf19a9611e9ec555611e8bb51599fcb2c38c4a945dbdc99c49c65e491978059701bfa02bc8e3680ed644a14e653cc77c3b4380c15779327e9c9955c06673704a7a11784b17b8215c26996e107c97e30b0ee7b2d501507d3e9ce6e068a1f0c8411da4067b87b39ee92c9b90f524972f851aac6522f05377423bd0a97101bbd09b70bdca3fba1736ec4b51141aa835545fa373fb5ce6560fe4cff9e2e6383b2df7816861bbaa55b122470d3124f54abff68051d5e5a7fc179637ec67ea814fe4a4127c9f0e0d92ca792f70cd85118173798c4bb60a9af5c6e82717f00e6cd88e336265e52d5c7f3aed70dfca24aec534cdb051908026a20afc40b690f237787a660985d3c4e57849188f9af3e9d9445ee48b88e2c96302bb2b46e3b7923cb81d386d6d48dc5cc23636200936daa531fb0041111968f4ef8e131f7a6429729ac11b7122eb29eb5789114864ab9691673ebe40647750288d1cc310288145f5466369642395f6c494056a08ca799f0d30728a457c8f8a071bd2d152cfb07b5be62b3053564f8530ec650f0c816b36bf19bfbe5647d768c7675bf34a924c050ef45d410a0ac3410368be2cd","isRememberEnabled":true,"rememberDurationInDays":0,"staticryptSaltUniqueVariableName":"4290edf5ab9c348d0d7d0b9e329b1e38"};

            // you can edit these values to customize some of the behavior of StatiCrypt
            const templateConfig = {
                rememberExpirationKey: "staticrypt_expiration",
                rememberPassphraseKey: "staticrypt_passphrase",
                replaceHtmlCallback: null,
                clearLocalStorageCallback: null,
            };

            // init the staticrypt engine
            const staticrypt = staticryptInitiator.init(staticryptConfig, templateConfig);

            // try to automatically decrypt on load if there is a saved password
            window.onload = async function () {
                const { isSuccessful } = await staticrypt.handleDecryptOnLoad();

                // if we didn't decrypt anything on load, show the password prompt. Otherwise the content has already been
                // replaced, no need to do anything
                if (!isSuccessful) {
                    // hide loading screen
                    document.getElementById("staticrypt_loading").classList.add("hidden");
                    document.getElementById("staticrypt_content").classList.remove("hidden");
                    document.getElementById("staticrypt-password").focus();

                    // show the remember me checkbox
                    if (isRememberEnabled) {
                        document.getElementById("staticrypt-remember-label").classList.remove("hidden");
                    }
                }
            };

            // toggle password visibility
            const toggleIcon = document.querySelector(".staticrypt-toggle-password-visibility");
            // these two icons are coming from FontAwesome
            const imgSrcEyeClosed =
                "data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA2NDAgNTEyIj48IS0tIUZvbnQgQXdlc29tZSBGcmVlIDYuNS4yIGJ5IEBmb250YXdlc29tZSAtIGh0dHBzOi8vZm9udGF3ZXNvbWUuY29tIExpY2Vuc2UgLSBodHRwczovL2ZvbnRhd2Vzb21lLmNvbS9saWNlbnNlL2ZyZWUgQ29weXJpZ2h0IDIwMjQgRm9udGljb25zLCBJbmMuLS0+PHBhdGggZD0iTTM4LjggNS4xQzI4LjQtMy4xIDEzLjMtMS4yIDUuMSA5LjJTLTEuMiAzNC43IDkuMiA0Mi45bDU5MiA0NjRjMTAuNCA4LjIgMjUuNSA2LjMgMzMuNy00LjFzNi4zLTI1LjUtNC4xLTMzLjdMNTI1LjYgMzg2LjdjMzkuNi00MC42IDY2LjQtODYuMSA3OS45LTExOC40YzMuMy03LjkgMy4zLTE2LjcgMC0yNC42Yy0xNC45LTM1LjctNDYuMi04Ny43LTkzLTEzMS4xQzQ2NS41IDY4LjggNDAwLjggMzIgMzIwIDMyYy02OC4yIDAtMTI1IDI2LjMtMTY5LjMgNjAuOEwzOC44IDUuMXpNMjIzLjEgMTQ5LjVDMjQ4LjYgMTI2LjIgMjgyLjcgMTEyIDMyMCAxMTJjNzkuNSAwIDE0NCA2NC41IDE0NCAxNDRjMCAyNC45LTYuMyA0OC4zLTE3LjQgNjguN0w0MDggMjk0LjVjOC40LTE5LjMgMTAuNi00MS40IDQuOC02My4zYy0xMS4xLTQxLjUtNDcuOC02OS40LTg4LjYtNzEuMWMtNS44LS4yLTkuMiA2LjEtNy40IDExLjdjMi4xIDYuNCAzLjMgMTMuMiAzLjMgMjAuM2MwIDEwLjItMi40IDE5LjgtNi42IDI4LjNsLTkwLjMtNzAuOHpNMzczIDM4OS45Yy0xNi40IDYuNS0zNC4zIDEwLjEtNTMgMTAuMWMtNzkuNSAwLTE0NC02NC41LTE0NC0xNDRjMC02LjkgLjUtMTMuNiAxLjQtMjAuMkw4My4xIDE2MS41QzYwLjMgMTkxLjIgNDQgMjIwLjggMzQuNSAyNDMuN2MtMy4zIDcuOS0zLjMgMTYuNyAwIDI0LjZjMTQuOSAzNS43IDQ2LjIgODcuNyA5MyAxMzEuMUMxNzQuNSA0NDMuMiAyMzkuMiA0ODAgMzIwIDQ4MGM0Ny44IDAgODkuOS0xMi45IDEyNi4yLTMyLjVMMzczIDM4OS45eiIvPjwvc3ZnPg==";
            const imgSrcEyeOpened =
                "data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA1NzYgNTEyIj48IS0tIUZvbnQgQXdlc29tZSBGcmVlIDYuNS4yIGJ5IEBmb250YXdlc29tZSAtIGh0dHBzOi8vZm9udGF3ZXNvbWUuY29tIExpY2Vuc2UgLSBodHRwczovL2ZvbnRhd2Vzb21lLmNvbS9saWNlbnNlL2ZyZWUgQ29weXJpZ2h0IDIwMjQgRm9udGljb25zLCBJbmMuLS0+PHBhdGggZD0iTTI4OCAzMmMtODAuOCAwLTE0NS41IDM2LjgtMTkyLjYgODAuNkM0OC42IDE1NiAxNy4zIDIwOCAyLjUgMjQzLjdjLTMuMyA3LjktMy4zIDE2LjcgMCAyNC42QzE3LjMgMzA0IDQ4LjYgMzU2IDk1LjQgMzk5LjRDMTQyLjUgNDQzLjIgMjA3LjIgNDgwIDI4OCA0ODBzMTQ1LjUtMzYuOCAxOTIuNi04MC42YzQ2LjgtNDMuNSA3OC4xLTk1LjQgOTMtMTMxLjFjMy4zLTcuOSAzLjMtMTYuNyAwLTI0LjZjLTE0LjktMzUuNy00Ni4yLTg3LjctOTMtMTMxLjFDNDMzLjUgNjguOCAzNjguOCAzMiAyODggMzJ6TTE0NCAyNTZhMTQ0IDE0NCAwIDEgMSAyODggMCAxNDQgMTQ0IDAgMSAxIC0yODggMHptMTQ0LTY0YzAgMzUuMy0yOC43IDY0LTY0IDY0Yy03LjEgMC0xMy45LTEuMi0yMC4zLTMuM2MtNS41LTEuOC0xMS45IDEuNi0xMS43IDcuNGMuMyA2LjkgMS4zIDEzLjggMy4yIDIwLjdjMTMuNyA1MS4yIDY2LjQgODEuNiAxMTcuNiA2Ny45czgxLjYtNjYuNCA2Ny45LTExNy42Yy0xMS4xLTQxLjUtNDcuOC02OS40LTg4LjYtNzEuMWMtNS44LS4yLTkuMiA2LjEtNy40IDExLjdjMi4xIDYuNCAzLjMgMTMuMiAzLjMgMjAuM3oiLz48L3N2Zz4=";
            toggleIcon.addEventListener("click", function () {
                const passwordInput = document.getElementById("staticrypt-password");
                if (passwordInput.type === "password") {
                    passwordInput.type = "text";
                    toggleIcon.src = imgSrcEyeOpened;
                    toggleIcon.alt = templateToggleAltHide;
                    toggleIcon.title = templateToggleAltHide;
                } else {
                    passwordInput.type = "password";
                    toggleIcon.src = imgSrcEyeClosed;
                    toggleIcon.alt = templateToggleAltShow;
                    toggleIcon.title = templateToggleAltShow;
                }
            });

            // handle password form submission
            document.getElementById("staticrypt-form").addEventListener("submit", async function (e) {
                e.preventDefault();

                const password = document.getElementById("staticrypt-password").value,
                    isRememberChecked = document.getElementById("staticrypt-remember").checked;

                const { isSuccessful } = await staticrypt.handleDecryptionOfPage(password, isRememberChecked);

                if (!isSuccessful) {
                    alert(templateError);
                }
            });
        </script>
    </body>
</html>
