<!DOCTYPE html>
<html class="staticrypt-html">
    <head>
        <meta charset="utf-8" />
        <title>Private preview</title>
        <meta name="viewport" content="width=device-width, initial-scale=1" />

        <!-- do not cache this page -->
        <meta http-equiv="cache-control" content="max-age=0" />
        <meta http-equiv="cache-control" content="no-cache" />
        <meta http-equiv="expires" content="0" />
        <meta http-equiv="expires" content="Tue, 01 Jan 1980 1:00:00 GMT" />
        <meta http-equiv="pragma" content="no-cache" />

        <style>
            .staticrypt-hr {
                margin-top: 20px;
                margin-bottom: 20px;
                border: 0;
                border-top: 1px solid #eee;
            }

            .staticrypt-page {
                width: 360px;
                padding: 8% 0 0;
                margin: auto;
                box-sizing: border-box;
            }

            .staticrypt-form {
                position: relative;
                z-index: 1;
                background: #ffffff;
                max-width: 360px;
                margin: 0 auto 100px;
                padding: 45px;
                text-align: center;
                box-shadow: 0 0 20px 0 rgba(0, 0, 0, 0.2), 0 5px 5px 0 rgba(0, 0, 0, 0.24);
            }

            .staticrypt-form input[type="password"],
            input[type="text"] {
                background: inherit;
                border: 0;
                box-sizing: border-box; /* This ensures padding is included in the total width */
                font-size: 14px;
                outline: 0;
                padding: 15px 30px 15px 15px; /* Adjust the padding to ensure there is space for the icon */
                width: 100%;
            }

            .staticrypt-password-container {
                position: relative;
                outline: 0;
                background: #f2f2f2;
                width: 100%;
                border: 0;
                margin: 0 0 15px;
                box-sizing: border-box;
            }

            .staticrypt-toggle-password-visibility {
                cursor: pointer;
                height: 20px;
                opacity: 60%;
                padding: 13px;
                position: absolute;
                right: 0;
                top: 50%;
                transform: translateY(-50%);
                width: 20px;
            }

            .staticrypt-form .staticrypt-decrypt-button {
                text-transform: uppercase;
                outline: 0;
                background: #4CAF50;
                width: 100%;
                border: 0;
                padding: 15px;
                color: #ffffff;
                font-size: 14px;
                cursor: pointer;
            }

            .staticrypt-form .staticrypt-decrypt-button:hover,
            .staticrypt-form .staticrypt-decrypt-button:active,
            .staticrypt-form .staticrypt-decrypt-button:focus {
                background: #4CAF50;
                filter: brightness(92%);
            }

            .staticrypt-html {
                height: 100%;
            }

            .staticrypt-body {
                height: 100%;
                margin: 0;
            }

            .staticrypt-content {
                height: 100%;
                margin-bottom: 1em;
                background: #76B852;
                font-family: "Arial", sans-serif;
                -webkit-font-smoothing: antialiased;
                -moz-osx-font-smoothing: grayscale;
            }

            .staticrypt-instructions {
                margin-top: -1em;
                margin-bottom: 1em;
            }

            .staticrypt-title {
                font-size: 1.5em;
            }

            label.staticrypt-remember {
                display: flex;
                align-items: center;
                margin-bottom: 1em;
            }

            .staticrypt-remember input[type="checkbox"] {
                transform: scale(1.5);
                margin-right: 1em;
            }

            .hidden {
                display: none !important;
            }

            .staticrypt-spinner-container {
                height: 100%;
                display: flex;
                align-items: center;
                justify-content: center;
            }

            .staticrypt-spinner {
                display: inline-block;
                width: 2rem;
                height: 2rem;
                vertical-align: text-bottom;
                border: 0.25em solid gray;
                border-right-color: transparent;
                border-radius: 50%;
                -webkit-animation: spinner-border 0.75s linear infinite;
                animation: spinner-border 0.75s linear infinite;
                animation-duration: 0.75s;
                animation-timing-function: linear;
                animation-delay: 0s;
                animation-iteration-count: infinite;
                animation-direction: normal;
                animation-fill-mode: none;
                animation-play-state: running;
                animation-name: spinner-border;
            }

            @keyframes spinner-border {
                100% {
                    transform: rotate(360deg);
                }
            }

            @media screen and (-webkit-min-device-pixel-ratio: 0) {
                .staticrypt-form input[type="password"],
                input[type="text"] {
                    font-size: 16px;
                }
            }
        </style>
    </head>

    <body class="staticrypt-body">
        <div id="staticrypt_loading" class="staticrypt-spinner-container">
            <div class="staticrypt-spinner"></div>
        </div>

        <div id="staticrypt_content" class="staticrypt-content hidden">
            <div class="staticrypt-page">
                <div class="staticrypt-form">
                    <div class="staticrypt-instructions">
                        <p class="staticrypt-title">Private preview</p>
                        <p>Enter the preview password.</p>
                    </div>

                    <hr class="staticrypt-hr" />

                    <form id="staticrypt-form" action="#" method="post">
                        <div class="staticrypt-password-container">
                            <input
                                id="staticrypt-password"
                                type="password"
                                name="password"
                                placeholder="Password"
                                autofocus
                            />

                            <img
                                class="staticrypt-toggle-password-visibility"
                                alt="Show password"
                                title="Show password"
                                src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA2NDAgNTEyIj48IS0tIUZvbnQgQXdlc29tZSBGcmVlIDYuNS4yIGJ5IEBmb250YXdlc29tZSAtIGh0dHBzOi8vZm9udGF3ZXNvbWUuY29tIExpY2Vuc2UgLSBodHRwczovL2ZvbnRhd2Vzb21lLmNvbS9saWNlbnNlL2ZyZWUgQ29weXJpZ2h0IDIwMjQgRm9udGljb25zLCBJbmMuLS0+PHBhdGggZD0iTTM4LjggNS4xQzI4LjQtMy4xIDEzLjMtMS4yIDUuMSA5LjJTLTEuMiAzNC43IDkuMiA0Mi45bDU5MiA0NjRjMTAuNCA4LjIgMjUuNSA2LjMgMzMuNy00LjFzNi4zLTI1LjUtNC4xLTMzLjdMNTI1LjYgMzg2LjdjMzkuNi00MC42IDY2LjQtODYuMSA3OS45LTExOC40YzMuMy03LjkgMy4zLTE2LjcgMC0yNC42Yy0xNC45LTM1LjctNDYuMi04Ny43LTkzLTEzMS4xQzQ2NS41IDY4LjggNDAwLjggMzIgMzIwIDMyYy02OC4yIDAtMTI1IDI2LjMtMTY5LjMgNjAuOEwzOC44IDUuMXpNMjIzLjEgMTQ5LjVDMjQ4LjYgMTI2LjIgMjgyLjcgMTEyIDMyMCAxMTJjNzkuNSAwIDE0NCA2NC41IDE0NCAxNDRjMCAyNC45LTYuMyA0OC4zLTE3LjQgNjguN0w0MDggMjk0LjVjOC40LTE5LjMgMTAuNi00MS40IDQuOC02My4zYy0xMS4xLTQxLjUtNDcuOC02OS40LTg4LjYtNzEuMWMtNS44LS4yLTkuMiA2LjEtNy40IDExLjdjMi4xIDYuNCAzLjMgMTMuMiAzLjMgMjAuM2MwIDEwLjItMi40IDE5LjgtNi42IDI4LjNsLTkwLjMtNzAuOHpNMzczIDM4OS45Yy0xNi40IDYuNS0zNC4zIDEwLjEtNTMgMTAuMWMtNzkuNSAwLTE0NC02NC41LTE0NC0xNDRjMC02LjkgLjUtMTMuNiAxLjQtMjAuMkw4My4xIDE2MS41QzYwLjMgMTkxLjIgNDQgMjIwLjggMzQuNSAyNDMuN2MtMy4zIDcuOS0zLjMgMTYuNyAwIDI0LjZjMTQuOSAzNS43IDQ2LjIgODcuNyA5MyAxMzEuMUMxNzQuNSA0NDMuMiAyMzkuMiA0ODAgMzIwIDQ4MGM0Ny44IDAgODkuOS0xMi45IDEyNi4yLTMyLjVMMzczIDM4OS45eiIvPjwvc3ZnPg=="
                            />
                        </div>

                        <label id="staticrypt-remember-label" class="staticrypt-remember hidden">
                            <input id="staticrypt-remember" type="checkbox" name="remember" />
                            Remember me
                        </label>

                        <input type="submit" class="staticrypt-decrypt-button" value="DECRYPT" />
                    </form>
                </div>
            </div>
        </div>

        <script>
            // these variables will be filled when generating the file - the template format is 'variable_name'
            const staticryptInitiator = ((function(){
  const exports = {};
  const cryptoEngine = ((function(){
  const exports = {};
  const { subtle } = crypto;

const IV_BITS = 16 * 8;
const HEX_BITS = 4;
const ENCRYPTION_ALGO = "AES-CBC";

/**
 * Translates between utf8 encoded hexadecimal strings
 * and Uint8Array bytes.
 */
const HexEncoder = {
    /**
     * hex string -> bytes
     * @param {string} hexString
     * @returns {Uint8Array}
     */
    parse: function (hexString) {
        if (hexString.length % 2 !== 0) throw "Invalid hexString";
        const arrayBuffer = new Uint8Array(hexString.length / 2);

        for (let i = 0; i < hexString.length; i += 2) {
            const byteValue = parseInt(hexString.substring(i, i + 2), 16);
            if (isNaN(byteValue)) {
                throw "Invalid hexString";
            }
            arrayBuffer[i / 2] = byteValue;
        }
        return arrayBuffer;
    },

    /**
     * bytes -> hex string
     * @param {Uint8Array} bytes
     * @returns {string}
     */
    stringify: function (bytes) {
        const hexBytes = [];

        for (let i = 0; i < bytes.length; ++i) {
            let byteString = bytes[i].toString(16);
            if (byteString.length < 2) {
                byteString = "0" + byteString;
            }
            hexBytes.push(byteString);
        }
        return hexBytes.join("");
    },
};

/**
 * Translates between utf8 strings and Uint8Array bytes.
 */
const UTF8Encoder = {
    parse: function (str) {
        return new TextEncoder().encode(str);
    },

    stringify: function (bytes) {
        return new TextDecoder().decode(bytes);
    },
};

/**
 * Salt and encrypt a msg with a password.
 */
async function encrypt(msg, hashedPassword) {
    // Must be 16 bytes, unpredictable, and preferably cryptographically random. However, it need not be secret.
    // https://developer.mozilla.org/en-US/docs/Web/API/SubtleCrypto/encrypt#parameters
    const iv = crypto.getRandomValues(new Uint8Array(IV_BITS / 8));

    const key = await subtle.importKey("raw", HexEncoder.parse(hashedPassword), ENCRYPTION_ALGO, false, ["encrypt"]);

    const encrypted = await subtle.encrypt(
        {
            name: ENCRYPTION_ALGO,
            iv: iv,
        },
        key,
        UTF8Encoder.parse(msg)
    );

    // iv will be 32 hex characters, we prepend it to the ciphertext for use in decryption
    return HexEncoder.stringify(iv) + HexEncoder.stringify(new Uint8Array(encrypted));
}
exports.encrypt = encrypt;

/**
 * Decrypt a salted msg using a password.
 *
 * @param {string} encryptedMsg
 * @param {string} hashedPassword
 * @returns {Promise<string>}
 */
async function decrypt(encryptedMsg, hashedPassword) {
    const ivLength = IV_BITS / HEX_BITS;
    const iv = HexEncoder.parse(encryptedMsg.substring(0, ivLength));
    const encrypted = encryptedMsg.substring(ivLength);

    const key = await subtle.importKey("raw", HexEncoder.parse(hashedPassword), ENCRYPTION_ALGO, false, ["decrypt"]);

    const outBuffer = await subtle.decrypt(
        {
            name: ENCRYPTION_ALGO,
            iv: iv,
        },
        key,
        HexEncoder.parse(encrypted)
    );

    return UTF8Encoder.stringify(new Uint8Array(outBuffer));
}
exports.decrypt = decrypt;

/**
 * Salt and hash the password so it can be stored in localStorage without opening a password reuse vulnerability.
 *
 * @param {string} password
 * @param {string} salt
 * @returns {Promise<string>}
 */
async function hashPassword(password, salt) {
    // we hash the password in multiple steps, each adding more iterations. This is because we used to allow less
    // iterations, so for backward compatibility reasons, we need to support going from that to more iterations.
    let hashedPassword = await hashLegacyRound(password, salt);

    hashedPassword = await hashSecondRound(hashedPassword, salt);

    return hashThirdRound(hashedPassword, salt);
}
exports.hashPassword = hashPassword;

/**
 * This hashes the password with 1k iterations. This is a low number, we need this function to support backwards
 * compatibility.
 *
 * @param {string} password
 * @param {string} salt
 * @returns {Promise<string>}
 */
function hashLegacyRound(password, salt) {
    return pbkdf2(password, salt, 1000, "SHA-1");
}
exports.hashLegacyRound = hashLegacyRound;

/**
 * Add a second round of iterations. This is because we used to use 1k, so for backwards compatibility with
 * remember-me/autodecrypt links, we need to support going from that to more iterations.
 *
 * @param hashedPassword
 * @param salt
 * @returns {Promise<string>}
 */
function hashSecondRound(hashedPassword, salt) {
    return pbkdf2(hashedPassword, salt, 14000, "SHA-256");
}
exports.hashSecondRound = hashSecondRound;

/**
 * Add a third round of iterations to bring total number to 600k. This is because we used to use 1k, then 15k, so for
 * backwards compatibility with remember-me/autodecrypt links, we need to support going from that to more iterations.
 *
 * @param hashedPassword
 * @param salt
 * @returns {Promise<string>}
 */
function hashThirdRound(hashedPassword, salt) {
    return pbkdf2(hashedPassword, salt, 585000, "SHA-256");
}
exports.hashThirdRound = hashThirdRound;

/**
 * Salt and hash the password so it can be stored in localStorage without opening a password reuse vulnerability.
 *
 * @param {string} password
 * @param {string} salt
 * @param {int} iterations
 * @param {string} hashAlgorithm
 * @returns {Promise<string>}
 */
async function pbkdf2(password, salt, iterations, hashAlgorithm) {
    const key = await subtle.importKey("raw", UTF8Encoder.parse(password), "PBKDF2", false, ["deriveBits"]);

    const keyBytes = await subtle.deriveBits(
        {
            name: "PBKDF2",
            hash: hashAlgorithm,
            iterations,
            salt: UTF8Encoder.parse(salt),
        },
        key,
        256
    );

    return HexEncoder.stringify(new Uint8Array(keyBytes));
}

function generateRandomSalt() {
    const bytes = crypto.getRandomValues(new Uint8Array(128 / 8));

    return HexEncoder.stringify(new Uint8Array(bytes));
}
exports.generateRandomSalt = generateRandomSalt;

async function signMessage(hashedPassword, message) {
    const key = await subtle.importKey(
        "raw",
        HexEncoder.parse(hashedPassword),
        {
            name: "HMAC",
            hash: "SHA-256",
        },
        false,
        ["sign"]
    );
    const signature = await subtle.sign("HMAC", key, UTF8Encoder.parse(message));

    return HexEncoder.stringify(new Uint8Array(signature));
}
exports.signMessage = signMessage;

function getRandomAlphanum() {
    const possibleCharacters = "abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789";

    let byteArray;
    let parsedInt;

    // Keep generating new random bytes until we get a value that falls
    // within a range that can be evenly divided by possibleCharacters.length
    do {
        byteArray = crypto.getRandomValues(new Uint8Array(1));
        // extract the lowest byte to get an int from 0 to 255 (probably unnecessary, since we're only generating 1 byte)
        parsedInt = byteArray[0] & 0xff;
    } while (parsedInt >= 256 - (256 % possibleCharacters.length));

    // Take the modulo of the parsed integer to get a random number between 0 and totalLength - 1
    const randomIndex = parsedInt % possibleCharacters.length;

    return possibleCharacters[randomIndex];
}

/**
 * Generate a random string of a given length.
 *
 * @param {int} length
 * @returns {string}
 */
function generateRandomString(length) {
    let randomString = "";

    for (let i = 0; i < length; i++) {
        randomString += getRandomAlphanum();
    }

    return randomString;
}
exports.generateRandomString = generateRandomString;

  return exports;
})());
const codec = ((function(){
  const exports = {};
  /**
 * Initialize the codec with the provided cryptoEngine - this return functions to encode and decode messages.
 *
 * @param cryptoEngine - the engine to use for encryption / decryption
 */
function init(cryptoEngine) {
    const exports = {};

    /**
     * Top-level function for encoding a message.
     * Includes password hashing, encryption, and signing.
     *
     * @param {string} msg
     * @param {string} password
     * @param {string} salt
     *
     * @returns {string} The encoded text
     */
    async function encode(msg, password, salt) {
        const hashedPassword = await cryptoEngine.hashPassword(password, salt);

        const encrypted = await cryptoEngine.encrypt(msg, hashedPassword);

        // we use the hashed password in the HMAC because this is effectively what will be used a password (so we can store
        // it in localStorage safely, we don't use the clear text password)
        const hmac = await cryptoEngine.signMessage(hashedPassword, encrypted);

        return hmac + encrypted;
    }
    exports.encode = encode;

    /**
     * Encode using a password that has already been hashed. This is useful to encode multiple messages in a row, that way
     * we don't need to hash the password multiple times.
     *
     * @param {string} msg
     * @param {string} hashedPassword
     *
     * @returns {string} The encoded text
     */
    async function encodeWithHashedPassword(msg, hashedPassword) {
        const encrypted = await cryptoEngine.encrypt(msg, hashedPassword);

        // we use the hashed password in the HMAC because this is effectively what will be used a password (so we can store
        // it in localStorage safely, we don't use the clear text password)
        const hmac = await cryptoEngine.signMessage(hashedPassword, encrypted);

        return hmac + encrypted;
    }
    exports.encodeWithHashedPassword = encodeWithHashedPassword;

    /**
     * Top-level function for decoding a message.
     * Includes signature check and decryption.
     *
     * @param {string} signedMsg
     * @param {string} hashedPassword
     * @param {string} salt
     * @param {int} backwardCompatibleAttempt
     * @param {string} originalPassword
     *
     * @returns {Object} {success: true, decoded: string} | {success: false, message: string}
     */
    async function decode(signedMsg, hashedPassword, salt, backwardCompatibleAttempt = 0, originalPassword = "") {
        const encryptedHMAC = signedMsg.substring(0, 64);
        const encryptedMsg = signedMsg.substring(64);
        const decryptedHMAC = await cryptoEngine.signMessage(hashedPassword, encryptedMsg);

        if (decryptedHMAC !== encryptedHMAC) {
            // we have been raising the number of iterations in the hashing algorithm multiple times, so to support the old
            // remember-me/autodecrypt links we need to try bringing the old hashes up to speed.
            originalPassword = originalPassword || hashedPassword;
            if (backwardCompatibleAttempt === 0) {
                const updatedHashedPassword = await cryptoEngine.hashThirdRound(originalPassword, salt);

                return decode(signedMsg, updatedHashedPassword, salt, backwardCompatibleAttempt + 1, originalPassword);
            }
            if (backwardCompatibleAttempt === 1) {
                let updatedHashedPassword = await cryptoEngine.hashSecondRound(originalPassword, salt);
                updatedHashedPassword = await cryptoEngine.hashThirdRound(updatedHashedPassword, salt);

                return decode(signedMsg, updatedHashedPassword, salt, backwardCompatibleAttempt + 1, originalPassword);
            }

            return { success: false, message: "Signature mismatch" };
        }

        return {
            success: true,
            decoded: await cryptoEngine.decrypt(encryptedMsg, hashedPassword),
        };
    }
    exports.decode = decode;

    return exports;
}
exports.init = init;

  return exports;
})());
const decode = codec.init(cryptoEngine).decode;

/**
 * Initialize the staticrypt module, that exposes functions callbable by the password_template.
 *
 * @param {{
 *  staticryptEncryptedMsgUniqueVariableName: string,
 *  isRememberEnabled: boolean,
 *  rememberDurationInDays: number,
 *  staticryptSaltUniqueVariableName: string,
 * }} staticryptConfig - object of data that is stored on the password_template at encryption time.
 *
 * @param {{
 *  rememberExpirationKey: string,
 *  rememberPassphraseKey: string,
 *  replaceHtmlCallback: function,
 *  clearLocalStorageCallback: function,
 * }} templateConfig - object of data that can be configured by a custom password_template.
 */
function init(staticryptConfig, templateConfig) {
    const exports = {};

    /**
     * Decrypt our encrypted page, replace the whole HTML.
     *
     * @param {string} hashedPassword
     * @returns {Promise<boolean>}
     */
    async function decryptAndReplaceHtml(hashedPassword) {
        const { staticryptEncryptedMsgUniqueVariableName, staticryptSaltUniqueVariableName } = staticryptConfig;
        const { replaceHtmlCallback } = templateConfig;

        const result = await decode(
            staticryptEncryptedMsgUniqueVariableName,
            hashedPassword,
            staticryptSaltUniqueVariableName
        );
        if (!result.success) {
            return false;
        }
        const plainHTML = result.decoded;

        // if the user configured a callback call it, otherwise just replace the whole HTML
        if (typeof replaceHtmlCallback === "function") {
            replaceHtmlCallback(plainHTML);
        } else {
            document.write(plainHTML);
            document.close();
        }

        return true;
    }

    /**
     * Attempt to decrypt the page and replace the whole HTML.
     *
     * @param {string} password
     * @param {boolean} isRememberChecked
     *
     * @returns {Promise<{isSuccessful: boolean, hashedPassword?: string}>} - we return an object, so that if we want to
     *   expose more information in the future we can do it without breaking the password_template
     */
    async function handleDecryptionOfPage(password, isRememberChecked) {
        const { staticryptSaltUniqueVariableName } = staticryptConfig;

        // decrypt and replace the whole page
        const hashedPassword = await cryptoEngine.hashPassword(password, staticryptSaltUniqueVariableName);
        return handleDecryptionOfPageFromHash(hashedPassword, isRememberChecked);
    }
    exports.handleDecryptionOfPage = handleDecryptionOfPage;

    async function handleDecryptionOfPageFromHash(hashedPassword, isRememberChecked) {
        const { isRememberEnabled, rememberDurationInDays } = staticryptConfig;
        const { rememberExpirationKey, rememberPassphraseKey } = templateConfig;

        const isDecryptionSuccessful = await decryptAndReplaceHtml(hashedPassword);

        if (!isDecryptionSuccessful) {
            return {
                isSuccessful: false,
                hashedPassword,
            };
        }

        // remember the hashedPassword and set its expiration if necessary
        if (isRememberEnabled && isRememberChecked) {
            window.localStorage.setItem(rememberPassphraseKey, hashedPassword);

            // set the expiration if the duration isn't 0 (meaning no expiration)
            if (rememberDurationInDays > 0) {
                window.localStorage.setItem(
                    rememberExpirationKey,
                    (new Date().getTime() + rememberDurationInDays * 24 * 60 * 60 * 1000).toString()
                );
            }
        }

        return {
            isSuccessful: true,
            hashedPassword,
        };
    }
    exports.handleDecryptionOfPageFromHash = handleDecryptionOfPageFromHash;

    /**
     * Clear localstorage from staticrypt related values
     */
    function clearLocalStorage() {
        const { clearLocalStorageCallback, rememberExpirationKey, rememberPassphraseKey } = templateConfig;

        if (typeof clearLocalStorageCallback === "function") {
            clearLocalStorageCallback();
        } else {
            localStorage.removeItem(rememberPassphraseKey);
            localStorage.removeItem(rememberExpirationKey);
        }
    }

    async function handleDecryptOnLoad() {
        let isSuccessful = await decryptOnLoadFromUrl();

        if (!isSuccessful) {
            isSuccessful = await decryptOnLoadFromRememberMe();
        }

        return { isSuccessful };
    }
    exports.handleDecryptOnLoad = handleDecryptOnLoad;

    /**
     * Clear storage if we are logging out
     *
     * @returns {boolean} - whether we logged out
     */
    function logoutIfNeeded() {
        const logoutKey = "staticrypt_logout";

        // handle logout through query param
        const queryParams = new URLSearchParams(window.location.search);
        if (queryParams.has(logoutKey)) {
            clearLocalStorage();
            return true;
        }

        // handle logout through URL fragment
        const hash = window.location.hash.substring(1);
        if (hash.includes(logoutKey)) {
            clearLocalStorage();
            return true;
        }

        return false;
    }

    /**
     * To be called on load: check if we want to try to decrypt and replace the HTML with the decrypted content, and
     * try to do it if needed.
     *
     * @returns {Promise<boolean>} true if we derypted and replaced the whole page, false otherwise
     */
    async function decryptOnLoadFromRememberMe() {
        const { rememberDurationInDays } = staticryptConfig;
        const { rememberExpirationKey, rememberPassphraseKey } = templateConfig;

        // if we are login out, terminate
        if (logoutIfNeeded()) {
            return false;
        }

        // if there is expiration configured, check if we're not beyond the expiration
        if (rememberDurationInDays && rememberDurationInDays > 0) {
            const expiration = localStorage.getItem(rememberExpirationKey),
                isExpired = expiration && new Date().getTime() > parseInt(expiration);

            if (isExpired) {
                clearLocalStorage();
                return false;
            }
        }

        const hashedPassword = localStorage.getItem(rememberPassphraseKey);

        if (hashedPassword) {
            // try to decrypt
            const isDecryptionSuccessful = await decryptAndReplaceHtml(hashedPassword);

            // if the decryption is unsuccessful the password might be wrong - silently clear the saved data and let
            // the user fill the password form again
            if (!isDecryptionSuccessful) {
                clearLocalStorage();
                return false;
            }

            return true;
        }

        return false;
    }

    async function decryptOnLoadFromUrl() {
        const passwordKey = "staticrypt_pwd";
        const rememberMeKey = "remember_me";

        // try to get the password from the query param (for backward compatibility - we now want to avoid this method,
        // since it sends the hashed password to the server which isn't needed)
        const queryParams = new URLSearchParams(window.location.search);
        const hashedPasswordQuery = queryParams.get(passwordKey);
        const rememberMeQuery = queryParams.get(rememberMeKey);

        const urlFragment = window.location.hash.substring(1);
        // get the password from the url fragment
        const hashedPasswordRegexMatch = urlFragment.match(new RegExp(passwordKey + "=([^&]*)"));
        const hashedPasswordFragment = hashedPasswordRegexMatch ? hashedPasswordRegexMatch[1] : null;
        const rememberMeFragment = urlFragment.includes(rememberMeKey);

        const hashedPassword = hashedPasswordFragment || hashedPasswordQuery;
        const rememberMe = rememberMeFragment || rememberMeQuery;

        if (hashedPassword) {
            return handleDecryptionOfPageFromHash(hashedPassword, rememberMe);
        }

        return false;
    }

    return exports;
}
exports.init = init;

  return exports;
})());
            const templateError = "Bad password!",
                templateToggleAltShow = "Show password",
                templateToggleAltHide = "Hide password",
                isRememberEnabled = true,
                staticryptConfig = {"staticryptEncryptedMsgUniqueVariableName":"f7068336ba6278ebdff2628b9d71b1772366139af28bb73bdb4ed5b31166ee472a44d02bd8d637bc92e8b71ce8a3209c1f556c6822fc054e318376e481c0175f80ef9fff8d9bd73ba141840ee004fddbb21a505a2f3c3a135ccc7be71bb9c118d7572093c6f7e48b43e94002908071a34efbf7ba2ede5a7ac8e933600fa7a848dd3da43a5a8abd369f1ea532842f5a6c7ea5c2bb34a32a8144774efba9b6eb6fa749dfec4131796b74609a609227e9a66e732d387a91f575f62d6fd385d7c2846f640ff809f2714266b67eecbe353e5c7b1ad616d9e6c5d24dd41d5250b10b724bcf3b98cb196a4bef1658b8bfd916998b003f5b1f8748d583e5ae12f938b489e8bec4a7b147fdca42127d5c8dbfe8c7f9dacd6a84d1d01d6e898d1e42f5b9d0b1f61b66d0d86fc4220dbcec3f926dec424eb98eb2074e996498ab10a792692171fcac2afa3eb87df41b8bcdf0afbd07498f0798f81214a2ff542a6666fbbff2a7c22f231a986123af005069d690469916a8ef013767baebc883da78a3e5505a3867ebcc6bd19624d095f57b7a958506971b229d0b6f789bb2614b4712cc2a6d0c94908cd0a63461e3cf64d01aa231e30c72318c28ad445e178523645fb12681210f6f4010696d6f457cde14a0edc61e8368cdb985718eb1473b5d212b7af0eef5f36d19b58e80c09b739519a66da76405105b167d46f6bae234bfa5beaa99f72adb10a90774fb5598ac6e83b1e33626c82690f7d4324fe030295b1df8d8bdae742f57c5bd65c82ca7376d64d11f831900aa5961dc99010721d78faf9b88b5e7acdc653534ce8a7a226f8dc9690cb80c276412ac3e48d24e9e5560ad9b3755423ff50f5a3041dbc3e53841e7eb5feb866d943e1ccd2687083efc65a7c8ae5ce83a87cf04fae29eb07df792f6e7b46b1b8d3840eedda2803cba689c9dbca9257c9d397f83ff9a82d4199b1a44b6e133d925edd2370ec06cfdcd8da9f029f06bdaa78fadae124003f4b17b27f4f28ecfab620037bbeeb4936b1e36dd7b471c9332c448c57bfd2dd7dae20b16a02a6df0f81e20bcd1e531e5d5c43cd31f7b5d8e0f674cd7475a811f6b61dae20687e57383a9164e4529dec8277fbacf6f26c5e4cc580802b5678d43cac95abb683d7845dd5de041260354b13069971b6cc523e2682a4e39790ea013d922befad2029044fe63cfe23b13fca406d56c6844e10f63234e494dde2df3f082d07c77d29815150d7e5cdaebd8d8de4f25435c55e5a1b8f531bd2a98fe7fe32b3451981718b0b92c73c385ab137fec1fd3a7a9114ce096d1b178f9392d5951dac2a3c9e5d12adf86241e6c62895f78523defcd9e4ee3c5ca3ac55a2ceefcb42cf0997ae8db4def7eff5f31708679509fe9015c918c2ff71afa51e2d77c2f3e59d6adf740c956e0e0c4b3c3c7b6b44cf5f9d84d0501533523ee34034b16db6dc1f40e2ec86d9f85e0a150abf56be32ea0de17017c2d9bdd5a047764422f6235e89c7632b9b2b0b4a4d61e835c1609571cb66e4122b45cec543b89653b6e4804ab990a31afd8feaab63af043a22c2f8a5ae028612fc6de2fc7b61d309a891b6f03597bb5a6b33d9c1a4e97e700ab168b9f0739ec5601910813e403dd61ab4b003f2ff0cd75172fc7c4570b757d0ddc8c4d3fbab7727a96f4e8f363fbe60fc534ca2c4d2f004bb413963d7e2487e9497a80baae6d1e29486b2686b2fb52ef06c01fe8b69c4e91f2b48dc05cb2995fdf93978a59026113ebc7f0ca0b19587251f76bc1c6af6054521f3b02f95ea186b04390da3083ea9687116138f542049074008b1bff023e31b95737042a4950478ef87e90f31702b062ebfdc14044d07ff1028ea1a000feb1f122b27d6ad6a9879f49d0cae7b0ded1b2cbfde97613734b5f7ebc125b33c597a8b13f9d651d4c508204bcaf8486f5b2149c6227315195d7920f7629cc22f0a185d063dcc22e453bd8222023d0048aa6fc8e4259a9018c9f3c371cd609d4892059bc8d8e16afcfdb3c8ac37f9a2b3a598a52e34065d9e8660dca4f10cec0661653f92403be9602257707fa9722be3f9b0c8d45a87da44b86f2e709b895667ff1be41bc533c09b2659d9e21a9f53bb5635a81a95e86fdc63d42ae18c062b92f9ad617e641a993d0553e72cc8c98ca46aa3e22e1dae0358961b091289f1f68df70fb3f79972e5f2b00e647382a1938ddac7974431625000c5091dc906e0bc91b390327d9bac43a60ba20bb6bf407ac223af0d97e5bc4c6f2c3a42be43b9953d4dfee4f0343753d65024caf88b3d9d685179a799432c0f65cd568e65de4d18fa4865ca0979c4574d07cbc190668f2e0d36f721cbc16723209007bf92b84c3811acabc97bb02c5e8045a496a2cafab1c349428543686e27fe50d17d596662dad3bb8e2eb8e9f1feb8851d53f46d39c179ca1b77c569268325e2f25291c2fe9d69c476c1c5aaf0d724a78ef5be8d0fbc17b6447a04121bf2dbc4b226054a19388178ac63549f11b0bd9106d3fc26a94a84a4dfe67b2a848bad2f7662424a0a2d512e357203e8d428b792837d1e5b22a1ad2333aa5d9cc955965ff6eaf12e79dd3abc2e87aa0e02f08835dd9a42d9ed64e0244cf91a3ab5a494e6672fe5ffdc9754a9daae4afd681cfc086e11c668ea5c368312f2d3d6ddf65cd7df2ae61fe01d2f73c518d42dca0b07a682216ca67ee00b4841ba98eb8e675a4f2e85a524ff4aa9076cbf2ef3cff07177279e9cc026e9ea2128924e1271c6fb8d094e05c08c8e1da7e808edf58db33742bdf1bd2f4bd0c79537c2eac6faaf904f00ea6142cd7b963cf36ef26387b241a451c6033ea2e624a96da20a20aad17d330411160a27eec3ca9cbdbaa9066e9af9bbe0c01b93449d0a2859cd7973e53968e101f72b0ebed34800333f167dc3fce59e981d638cce8984b853f508d340441e2d1790bb81fad93369d108257f1645eead980b3f6f8422e205faaa5f09bb27745495f640a4db45575dd4fed7e1487d5ef795b2451ae7726ac685e8c337195b65f1c0debc037d73f45b50e14482ec1ad102b1881500d03e89df781eda96365b888eafc9c199b10cab26406cedad262dafe9bc6810bc15159f06b144bd8584f53da903b999a0deba69a729190c514e0ab8f686f8274f3030fb25a242ca38473df53eeaec7d48a8970f68af5fde2001c6478819837e2421eff65613a01bfdacd62394bb6cf96a190a825a7bfc427befdb2206f0ae04182fe38159aa3f0679479069bc233efea6f4640d163ee657c9cbc3cc937f3e34be70fa09fa986e3d8be6a187ccda35b5ab6782ee197c60574a2562d299a6387eaa0befa2601024245e6fae4fe19facd329752277f88a0247263575d8d62acb3489b5af1cc435777a346785dbb0ca5ddf18d65af821c9143b684866a51b5df12c4eb04c3b1401138943dc585662ff5a051b4cf5b2e81483a6e63db487f48100ea948987f34ad9ad11b9def4a415e8809f2f4c0502590015f655fbb680d9cdec9cf3f43455aeddd354ace1a7cd101791079152b78e7d1011c96187aa03ecaa7bb4f5126d41a9a3ff44dd4c14b92162e43b639b52231895b0980af3fe8eb382038a13484906a708a715347918d5047e6ad0deb83d9652c9e3ac15864af5a048a3f78ee9bfe992e99ac63479613c2a2a06c49f4706dbf3091dad4dbd4ee25f88873344e598fbf0e6902167e06a64ef7d98eb6c8f2835182092be1e6ab51537489e1e2cdbd478f1b41ac898675755613faa53191625cbd357e7811c64b3bb13b5523c11a329e8a0870a8131357e5fb5582aed624031aab3041b4498ada61c61515de2c4af7317945f3ca277821431311f2a3ea80d1eefa5d4637a178bf51318b59e9f27c718b25fb538dc6019908fa7d09a847c79eadfbc7418c554dc4ad2420383af83e4014b22ba0e984c371e9d15ee7b41b5810ff3f6795abf3959d3b18bceaff036505da2bebd7079306595bde663aed055166ed6c174fc693058bd5eef9b1f0b1dbd6a950e484eae0a5b08703fed038db9e5ea13bfa1dbc3a2f3743299a2fe260c49239b5eb9522e39d048ad40c685bcd3e9e553c02f3324dbe27d880067e18d7383015800fb1db3c90eafada8263370f7c95496bdece5ca9de161312831d90576b8f22c5873c03688ae72b97da4b36ef168ce707d7ce41fa06f7a630afb16b5a95eab4a4a68050df442a46ad16d4fec90dd2c42170e7ec1bb735a1bc9f419ca93138546e135ce945034c392497e8bf25a65828c4ab121cd0795b4759cd0786e59d19d786c66a6da6b7a601216fae90e44f07408739415642c98a5aab265340f5b6cffeead3cb37355a95cc266586c5645ac841d5ddcf20b067c6951e67851bb6ad442c92be9eb31c038f34bd15b750c0c8f1bf5f7a0d4fcff2a13da33f0f1c5d06040d31355bc267034d450fe2048d46b52f75ad40fa96fa909d3176bbbf0c798a51ee934c85dfc0b71de7baa8f18219626b53a08b83dbd7b101b39da11d89c4cdd447979298e270ac79f0d866da946ae2a87b40f3ae4b11a65cbafa5c6a494b94a63bafdb5e0518fcbd9d6a074bc419c4c99435d8e5f694147d34b0c5f6b0f279eac1e814cd282957d4554dcee73b713685884b4a8d4c28b110610dece3c2656688be109a991865ce2a7a2ae7dac18a909241ecd612d1c903afd7ee1219673acd5753a5e42471d91d329f3ff84c99fdf1b013b7592683420160026302e27f84b51ddb5db6e07b96c9f02b0e79d27c2c4068f779514773e52b1c49f23eac15adb271083bee5b6f997bbc76a4915dbbdcfbe0e8b0f30b0290ab567e78645e7348d399710d30ed0bbe81991dbf1dd217096c0950eb9c7ef4cf4297d8bd5a82624d43e7bba26228b8a74ff0e9c198d3c8fb5e7d9ab13741be416a26abf69412db45dc6b10717173901e3669902f3eaf08ba1dff53ca39af4d4684f016f4e5a6a27336f1840a56cc3ff8733e3ab754f03ba9a85bc669037c94c46ee1d4a07fe90cf967c05b7647fadb41092e91f89ea56f921b8a3cb0b65676a1c1d7e49b793a3a8dd6fcc03b90309c3d8b7e9a5ba915b12a0430bf9e5b4972c29a6484e52d008cacddcc2e9455138e08c78edde749d41ad7c8784d6becc01e49b9ce43d796cfb46a14c4c1e0ca9e9e3eb1fcffd71813327b068cfb761d2afcebd5d48b92b3b591e151f205996479e974065f61d1b789db8f7bc65932aeca9fe79e19aed6644d4585289a5eb38444b65c3fb638dd8fd12e984af80fe1d695b93e12eee6f4a94f6980942fcf6f5ca9b05bc75839ab1bf6ee921bbcaa4391713918c1674040a1cc5c95df7e4194e9dfb6eabd10f7ab048c5fbd459f09bba3b0cbc0cd0917b963f608d5d06df70bc128d508dd74d51bb6c441381f636ac6d8426bf06118e6d42f29406a43fc4295a969ee92a50b12159bcdae8642c0c2a33eabcc0a2b7509c16b9c2a70a75864cf96c82856ccc6a89b8c2fa6a846d68dfd35b8187f96d540de5fe87546d13a61a2d71fa4a8d614426604cefa55e3a64b65274715d6e5c8d88d0c07399a87a835d3bf7a029493db6879d1b0b27f327ec43cc2f8b0764749a5977a24f9407a64f4d8ca8eb13eb7d66bf544b67d40cba12b67a5c9d49b5ef81b1ccc0a3ce664a8174c22dd00c998f22ecddad829ce4a0e76ed820e3109a6856bef4098ca8550468a3f6f650927976892ff22f6ae9e10248bf50b04f5fca0559d8ae68925e3c4ed05715370050f75a4a9a2ef2f8ca570f31da1a3e2487280b627345c163182c658ea095ba0eb833929f66305676d2afd7e545fbf8b1ca5c52c6b6917c66325a0f64d90591202a38846a44c2b2b32b5af8745cb846ad5d7f13d677bf9743beef9be991e1d0454941acbb8a3ea22c15f15ddec2e64a1a5886d9dd4861f4fca2206a94cae49670d72f25f4f39e6ae494ffc823d898f7c1a61b066e32ec70ff2aae8068ffbbd4bc55271c1235fd86cd62bffa319da392988cc4c226fbb45c82c5884a3fba3502026be2adaf21b92685ee6a7cfbd732f1e472d36554fd9d1f31a4e088a731d8263f7e7c62e37a80af9eb42b26314319318c299bdfd48d9af30075cffcdf08e639804bb09a2e8e7ec7822cf83d32b899bcd450f172c4d3f3d52aa3009d640ecd60ab69991f81b1eb317e06afa7d7f719b98757f53f0f527fd6bc83fe804ec3e4fdee1f2fabd15390a396ed9c6a12e99cb4fef6b3a6535a01ddcf5b68b934fb2362d6dea32669ccaa864f5d087cb178258c21c62e05181e23b381f6fc357c5ed1fd0c6a11f8ff20ff0aec9f824818749aac739a910653a6e22fa7beefd368288bb157c7843a36de448e92f78ad88c79b38113b77754b4c1d2d6b8dd0d5902857622f1d1a2300b4da06fc063e36c56f5fe795a230953327ad32306a3093f8d639a27b659d9290ee9bc93744c5299c4fe81b6955cb8615408c87891bd52e5b40dac42ad07f426a96342122ff94408a0c7845416351fcc609657d496567e9d4e93bcd028654ea4e10622139c91de80eaf8f4fd7f035411f7488c4caa1afdbb39d990569fd9ce9d4b816aabd58f169e7d560520258ae833cd45007dd43bafcdfe16a8e6c0758af0cf8a5ea88666b71e054b980151ee9aee4b4973da65a8bfa06f978ed83aa5b41ae1a21bf5c37c8c2b9753eb9a7cf9277ac0df3858a627c2cb941097b33d3f8186867377a76f7f299a7c1d847df46c02fdc56afb63ac08138d729fc334743a68df4646f726008d21d7741fd1fff9b21ccc804731581a51169a3488e9f8e123784fa9a3ecb765a81e1e44f0d711796e2f68231d3711809773d1f405ab5a0c33f12eca7384cbc6a1536e5e5957a0101a6332dc5cd23bf4357cb33414454900bf926016d36e03505ef80dc017622bf3951793a820742308ad879ae370f9c07da5dc716ea0bdcf8eeabf055ba3c0c23f8186cb84f08572cb08f49b181564d55fec5eb56bdd192ec0ad302471e85ce6ed9f5b40d0a3b4f93311749cf062074ce3a671a68d1e808003c313c7c438b495373595a7eb1682a707fadf58bd121d63a0e8c6b50f795605f2b939dc3dac72758b2ee44fb03b362ff67b5826c1bfdc5343f45db28139813a6fe6b7d8c2207dd8f94d1a8c7e290958a10f10751ff97097014cdac4c66be654760129be25ee6a7593e239aada71848a9f9e9000bbee617722b3cc540e0266473ab2050cd3590811467f3bc888004dd4c438fb152262fa15d87d245ee83e3592fd12d97d4c90d4479ff2e80dcb8bda197952dccb2e0a6dfe695d8c9ad598e5ceb720b4df6bd15899d3ca5c703a22b43c135d257e68b6a189f5e4552df4e3ab8f3fa416f1a78155908850f363b57f4d045e9e60ffefe912ffc00878fb9d2b6ce89a003acba12e856004a9746e26fa2be40d96563ef7b7feb652e6bb6b52c80e4a4c5ead2139139a38217a6397a997eedc61cb7535dc9aaea7eb5225127ac55380f2bf174f350b1b3161517342fe1f192e8fb6a71ceddb796d7c9c26305548626a9a052cccde7ddf0c3cfb902e5f29e1e7db54991151d1dacf4abf3a88cf4fa30676f4c34bb28cfea6eabf91d651cebc19c62871131c5944a4d8bce03b96804d16de8ee70279e4bc88461442cca8045bbb3256ca676123cc727473637dbef76027d750eb3ae1197a8e39c60d572e87ae5db2afaeb305c7e567c05975792c2b32c404877558a0fae390cc4f8f9a186a05a0a48745ef578f1b3191f1151d63b74b55eda4cce57e7a4faa8ad6dc3430aea4b8ad257365b7e2a35bdbc58354a5b6960402d38346814687a8bb77ea6dd31af2f6707cc6928122d21d70b6fd3a767908d617a79fe233719745276a4d36f0fd8e6158348db11bae5c7d32d3564ad8c666cae7318c50fe67adfebf745ecea3dfea08ff5e187738d610ae56c357c87a99f8cdb89a1e34b7140dbfcb999809e364aaf76f4fdc5a9d258fb62fb249fed75bbefb1e1b2dd12b80931cd4e628adc09111f369478f0dc8925a89de4d8bc8b9061ec09a57860596cf791ebdb672e7709864fc2d05246c3a64d083302bd9a05f7133e09e3d8cd7411b1bf485dc8c23632df4ba2df367bb239840ce9023ba6a5d8adf828c328f0184480d94365e73ed3c3f1a364926461d315a20806eb5fc0926d38dcfc3ff35c7c51d63b6aaf09715a214b0e1a9749d1194388eb52ee23a95cb0b5f1306f46488a69c4751f3d3a973b7c1002e99aee241b1502a86fa560ad7fe971548d7c60894ef2bf272f705c3a367873bdff09ff7e0052203d1315048b089c00c236adfba316d50fcedda4a4b282accefc0b003f59bfe8da6ebfc25d7dcff7397bf6876cbf5c6b2cf1ff71fcb49eb08e1dbc06e6ee566d72741107a5d8e29e3fc1c57615c58f744789c93ac93ae89e36941209b4838d6aec736cc7c341f9bd9a604b9d0eef8c8f199204a33c147d6f54152bb72e8f424bd3d6d68e1e4a16b54f02fe50491a8dfdaeb84239b1ca003f5219f51b6ac73c8cd3d40fde714c83cd85735551c362c7822a5f17097d87a70407bb0732759afa8dfb13c80b0f994f36f27e83d0cbe78ea80d22a72843529c176e24a1b23db78404a3e51af146f3a19305a374ec8116fb36ce43141ace4f42c6564ebf889766ca31b6d0108c536df4380fca5f872fd327d37c34aabc6fb2734219804c3068703e65ccaa7abe1dceaa4f73fe36cfcd2683880f20258169519212109c94ed26ff52b39c6fac5ce8b83783df8393b95b804ccc90f80b7046919c4b4d6be0d0050d0659ce87c5bfe0037de51aacae4ba9a22f6bcf0793eb5d18c9c2575886d0db4776b9a9733b5c4dafe154bee0ec4f86c061f13b94c0bebf27d7fce87f88fef58cbb5dc7a2aa42d53fbc7dff4df3d50c3e87ae9c7397175c623534e9dcd4a873b1edd5a5f04eee234966bf92ffada3b8683c460f73ce35b5626767b2912c27e7026082579e1cfa1f5575abb19f0bfce28f49c81bf67160126eceea8c33531c8ba3f387e808dab80319b564473896717bdd61927376dd659fd01835379cd4023e7e3194caee111f9da4931cc682fc2c4bc6f1f42027f889273837f6105b4c5e745c87de19f624267f883df51e10c60a6068364387041e612894b6ce6c25134eb47af5140c0f8a53b82f24bd69edfd01d7b6dd9497c368b271cc34bd7e218a22a8ca8bcb93f84c0dafb35338e942e321ce2faae6ca2b52a585cf31b16000e09e3e2c462780fa4f68ea874d7cfa40333f5bbe6f61517497538372ff0bd1f0b7998817b983f1f8a135d97ea1a910584a026affc34d6a6e5f4fab1536e4971e1b61d10f534176fef29210fb0c40e7bb4da776954cf42e65a86a12ef5e426b50cddebbe22615b70e1056aff450c86fe3e0e8cc9859cbbb7662932df4cb49239edd049ef67cf23111b3aafbee0cca52991eaffb547f14fbad2011d7e8d9e3f0d123e09d1a6a0896311ffd9fc578981da544090180c2e64b2dc562e7d9f14abc31157e69abb766a715ed65ce5fa59aa74f5cc24be3fd6fcd0f9b1e540e0d59d369d072762a8b08a37a35b943308c88c4ae7e186acd2a7b5b7488f80fb6e02a1be2fa77a0d82384e2d2a9a9aa216c6b4b0aa38fd10b38e09dd874f86aae8c9f8796cef26f53d0a068b7df34bb52942e9abfd66a84633e09ac2b3b067e8fe5e534677c1cabfa40306593002d327c1daa3fc0acfd10930f906a5b730f99c56b57e18129afa6f08334e2193a4793d3afc1f5f0c9eafdfc2ae56a7d842308fd7b1f7d52df244397b69b416fb01860a7c50882ea17567a04a3a31f2b6600e2c89a36b8ac430c349b5e4ea4a777d6088c5aa8ce19a6b1807657e3d8655b2976cb1c1f4f2ea2bca87ac3e13e6cf82b56cc50d54eff7ddefeae60cb5b97144a9fef8b5c830ad75237ad15dfa93ccffc9ad1e24a4336674670b30eafda5962faf9546dd40ad32b2f04c833f2cfaa12f7b2a5a98d074214ca61eb7baa539d4559cc08236954bb013a80c1ba69cdde048e2f4f5a6f0ba7647b4902eda73180da3cc7e558ae47ffa3f9528cf4c1e5fdd52e96cf11d188be42c2f9cd6d09a2f58806e250228a727accb0abeeb3f914245064120e1120310aec20dd71b89543b9c2d76a4b614041900e8fc065428d059bdc590c6a4e85daba9c7cc669bd7908e3dbc3eb0c21977f7e39c76211483445c201bce9e4a3a64bd6aad975eb77dc5be480043a2aabef002793d74eed9434a4a89520d9f788ad55adfac912e9a00a5082c2de7b5bff88a91a3850333e5de4f90bee3c9cfcd2c0698bfb20c44404b3b931e3c59debf4b137c80af74290d6db9f2273b0abbff6ea50f4ac84c0ecea04b0d1c9de3a9137dea6615b71a11706b8576fd206978e9249d77814d0551b8f25dc77149faca3976c47360a20f94931ed7767b4c646b0153e28bb6b4b9b5f4a37aba6437612d3ea099b0923497bd7f41a19577a54f784a6f29b6cf8317e564acdaab79c7499854c0f4bbea88bcc3b16853957b98ba8c6483982a13fb7b952d8417e7a098b8427959a94be91f622698a613acb8e303f957f80f0908ef203e46c777644e11f57838c164abd2cc4cb9d184ba306285bec094323d11e8e4a971d5f4d19304ed1999f7eb6d076e1f0e6bd152bc1d6fef0990ffa6f8159f39c9ba734acbbf22101c10337e7b4708146c58d0d444d3fa4ad035a2143a7750cf48ccbc41881990c8e4ece5410bd9e0b18251a64229bc2e88754f46ef62c1b04e1469ad19d0336f4ce5ddad00d20b72b6ce62a11e2500e641cc6283c495d4829165c95a32dd135710448ee319520fdf24337972703b9c073b9d5bfd9880434de377f7ab84bd8c7fa997bc9a68b5785082a53b5b52bfd965cab66e6e4432339ac57cd04761ee983ffb7fc84ff7266b8ed841f6e4573484528ef74cff4ae35b6c2bd48b4b53ca0de82c02217afe8cd05c1b946c925e140981023570c637fb8a41e394a918ddf1ba65be62aec8f8751fe8914dab4da41641e950164669df2e9cd07375fe7d965c18d0004c962157c32e54b43b271dc10c25c4e675a74a4a1f0b41881bb4394f9629cb8bbbbb0c30ba3ee332604218be11c3bc615be16170f4951cf2a50fc32d81df20844af0275bfa8c5575ee7514b37ea2983f98d201e5bae95970686e98a70b0b45e3829e4838fbbdb60576060451cda5de6315541ce66d828d4d71ea21126e24761502c5f7afdeabd04189b9c4bc01bd80d82489f8121ca83bb96c8887dca9b0191541fcaaa49bb822351dadfbf876c78e72051fd1750ea8831f0a6ba3589c1ea404e113a44779f54c562b14f525dd8b2e49b19bde047e211a1006abfe90ba9a33a9441d13ae18f4fbfb49f6386ca6f02126da2fd24140ae3f5b223a06f8f2b82af644e441f6baf968286c990813ec66e6d85fe31c36ff3a2ab904459090695dec89f670d5ddc5dd9b008638386309d7a1a241b1c37c51220381c8f7116c566a5cd601ac0f899e53d18d25b05f635e598ec1ceff4b3e5ceb4fd9e5587c7ffe368973041fe8a3c5ef668f310a81506270e646910967c8bdfa993e750608e6a006f4a7d60768b18326042e411663f7fa6bf7b4679985ea8ec754ebdae5926fe42478661023a434ce7b5705a94a996e65b9e8e804f526ed89a0c205b38f6c80738c298b3d977e8cfe928fc70032dd337be449d3281b65bc57084803aaf91d7baf64edb12751e6871227abd0549fa8639bb3d3e7eed171c4350b9a763a92e3f366fb088de2bef34ccd193af116b1ea6081d34c4d8b6fc9b80fd5bbaf9dc92a90f49933539ff310e5706ab9774b147ead18da8ba6ff217d741df78815ff0924e93d0c499e6a24cbdaeb04575dcb0be92c7727f51063761abbd21fe9a0a2d8b5b7ab1159f780ef17cb5a1861cd18f5ed2a1b6e82595f11658089e1911e413caecb2eada458f808313b8b05d67096bf99b5b227d7e33bb48a2f4c5dd6bb8345dfb7f2cb9e9b5c9db46dfb3b3511d6ff00c05c718b60b1ce91961694561026caee26373725c5efdce7d7930b52aaf4ee5ae336aa99ea53c66ba964a211a8428dbec6b5533aa06022b536e99faf981f78efa4472356db5f38fca52f358c80905a43dd5ce6b665ddbcfb7689e8ae16b8f352b3563a516628040f4e207935250f8ed1accb0741a25411955022e47912ee0431d7387d589debcd6c75784fd036c227b4fb84664c4f1574141a58f6c519c5aae97628ce39530493b3cbbe7cd372eae98e9fa76f513ce9ca21a126fc3a46f743ecc33d54a7121ba5b8c658caa0a5154a0a8400b98c23c149c9c2cbf4a5b927d05a3c1889e8d4c587335d88d43ece9d5b4af9d43885e2d4d0117bea301356372aa10040b5a36a36376f3b1fa2a3350e9caccb4ff5b6b3c795b32ec2ba90ab14daa6c4ee905b8b329a9cff381322675b4c2ce90c957d20fcb59e113528681e7ff54a2a97fa5a0e7001e24ead0fc9d5755119b6dd3e3a3220d9317df470f27cc2828cec03568c379a571391db8f5266e51df675be1ab97ccd380dbd06d393f06f7912503b5aa4fbafc1d3c5959e66ea3f6997ede185507cf3533e20839afbbe6d8a9b3e2b875958dad502c53fc10565f9ecb03439a76593fcfb36c47d369f4a0a9d7a95dedd9d6faef68a1ecf5d6dfc43816d7422c0cac56761b14dd77f4a02412def920717b7e3c0690c5b3af8642936872fa38b82978a29209f329d1e2a9212295072724c955bf58bba78d824c89bd2bd61d68103be557b11537376e9b6137f57738e67e7351301fc01f58711b5f715950a291db7c1730d49cb2dd891f9ee6beca65614172fe821db81d542bca8681a126e9294e294cabfa47f99cb5d510bdaaafb5821c20519d1f23a8aad879d945bcca9f577576b9d45b5df0cbd2c14d1ef43d8c1307e1e0deb0998a2723ddd227b7065bcbe30ecaf5af57d8bd83c9d2d01e72a9e8e2f03ce7dca10e0cbfcd33c7c9cfa3e2fbcc2cd7a08df401ab5f64f525642c4df200208119ef08a2f72444448cf3efc8d9be4c9a85a506f91a523512c200e9763a3eccee6890cdf64da3b90f36ee430243bdbf601a0127ffa1a2eb4c533d0bd85ba1e98596cee03400d4d07c23588ff6fd283342ad00fed6d3ecf8d911e622a3907873cfb494aa3694f04671940436fc672f765890ebbfa1f3b6347e30d08ba7142121b852e002fece162a61f0e4f1dd71d62546f7477aabcf5f99a54fe4ae7ea9143db1bd9353077d20ad39e463a92e9ea24abc4a1f3c3f4863b42e736bf24f1ee2301ecf10bf73dfba5c64329524708cc18f2e94e0b302509fc300ae9fa37c00fd3db4840a7df75ad9a22ce316ba244e6ed2a54a00ab6c637d3c7b3819ef8a2af0a8c1465d0e44cc57b59b2082ec95aaeba80020bb9f205f02f0e263a3fc33811ea674677cf987143bcadf642776c804873f2c704503d7d313b8722858a437201fd10f3df77e9bb2d49760f51169927e3152fb115b05137985976233d8c450a83f556562347b36a450906450190ea79acfdfa6fd5b77856e3b011cbd247720d01830830e4e4a57bb8d85767a1dfa2b3b19248f2892e4823303db280f2bf102d4add31979a0fa87687b8e86354f28e33a7b3943a156b9c1731c60458ff7da0a91bcd553c5f5bc4bbe070f80f8f84814db9815102aeaffabac358d4ae9884fefff61973cc55262d2a83456740a8867c84a53a41f019b196fdbcca4bb0a02cf08d614f9d03488fd984bd71a8b2c0833802549c812c73ef076942f0df179fff41183cea4f795220ed8388c657ad526a1940c673c1602036ba2a29469f1ca539812437bbafadacc5da2a7f3468563e136fbf0f29442e408d63d6fbc232d43b56f73018aa81f914b7041fbfcd4e4104218ad31c419c00b5338630f2531de1d2d432ec31832fee9ca81d830d796da015c91ba587c36aa3875dc234806822d3de8b09279b5a5902a0b70d0d55dd2d2f86d1c8f1aff4fcd230f7ae8d0bcd648d14c07426f56de7249c6458f0489e21941fcc69504356cf1867bbb1b0cbbf3a035bff3200a4ea0008c19bfe72522772c19108cb515af315174f5715057144322ca11dfa30307dacc77fcca444ff988922a9af5da4d303e77b1dc78eaef8da90a670ec9fe057ae1de09d5e9ac7d87c857d64e1513e012e3e56d3a206469bcb7c24f1a7a06c086ba83218a8f4d5d4ad3d1cf67f911ad99aba109def68251ff31a62b70cad01147e7c6762fd5ebbab6c615f44d3de21d3a8aaac49d0dd13e34623e030c37695c7449b3c7568e7ab1e3c1bb6b857b099fa6341981ef6b7bd43de95ae0aaea63a57f5dc5c63140491d8171ca86707005a5143e7769a36f737502281687e0e2e0c30384031dcb4f360c7a9a9b3bd257498b2d94b933049538fb111cf323e4cf8b5b2aa8f5f2cc6e53ed244a66d44352f88de7cb9b5ce7e10508eb40fe4591a5f144dc0346628c6a2fbc876b39fb117bda4efd9d1c717adc2736b5dca24b3b8491d0c20d637c442c8edb0d7875f295fb8b5639ba0132db19da6c04301760ecb86abd6355b2fd0cbfdbedb54d4719c86919f15591bc2b9733c81c2d501f862bc4744826ef208db998a9d5fc1a4173ffae41b6fd6f55d260ef0f2c1b277a875f0820374d00438c595653ff621cd4e089b73ef920addac1d11911556bac8978fe96122b0c6af21052d4014148aac7080d4410fb0fadbc415f95397926d6bc1c291d38c40da149acfc8ddd803003d056d0d179783096ccd8a0a4b802f58f2edf892f35bde2401811859baa2f8ce715fd05c25bf0a2bd50e22a4bed55e206d3063c349398c2647c269fde216c872331de2e658f7b369569e44a557df71872f65e7af8f345aaa6822de89d5714cd64f9db07d829ec18a28abb8706a7368b510edc3d00c5861a55deb50115d304db1aa3745b941d2a2fe6bd7cd162782813c40dae6a28e226668b45372fd9da9fdd70d1d860e0f2f4ff480a7e38931e38190c2b4ce020f5ebf707ade517d99ddfc5edd61bfd30574410c61f868884e2861c1e7c1d8fa2d69c3f883daf51f8c172e4a6c734efb6645041a52ad13059cc17decd01feeeec77cfa6e2062eae830dfa6b550207d326f4a8020c39fdb16ca69253295304962b05be66491bcf191a820acb49b33e63a1187804f8497b78a1b0c46f9339c34a3dd60e9a3a1f19a50743c322c43166623a6e55f6a8e6abc0d931faa02edcd20fe329429dfd445a2f20c8aaa9c39f2d23faee0666c554bc7111a832a01f0a4b64e98a741b900c","isRememberEnabled":true,"rememberDurationInDays":0,"staticryptSaltUniqueVariableName":"4290edf5ab9c348d0d7d0b9e329b1e38"};

            // you can edit these values to customize some of the behavior of StatiCrypt
            const templateConfig = {
                rememberExpirationKey: "staticrypt_expiration",
                rememberPassphraseKey: "staticrypt_passphrase",
                replaceHtmlCallback: null,
                clearLocalStorageCallback: null,
            };

            // init the staticrypt engine
            const staticrypt = staticryptInitiator.init(staticryptConfig, templateConfig);

            // try to automatically decrypt on load if there is a saved password
            window.onload = async function () {
                const { isSuccessful } = await staticrypt.handleDecryptOnLoad();

                // if we didn't decrypt anything on load, show the password prompt. Otherwise the content has already been
                // replaced, no need to do anything
                if (!isSuccessful) {
                    // hide loading screen
                    document.getElementById("staticrypt_loading").classList.add("hidden");
                    document.getElementById("staticrypt_content").classList.remove("hidden");
                    document.getElementById("staticrypt-password").focus();

                    // show the remember me checkbox
                    if (isRememberEnabled) {
                        document.getElementById("staticrypt-remember-label").classList.remove("hidden");
                    }
                }
            };

            // toggle password visibility
            const toggleIcon = document.querySelector(".staticrypt-toggle-password-visibility");
            // these two icons are coming from FontAwesome
            const imgSrcEyeClosed =
                "data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA2NDAgNTEyIj48IS0tIUZvbnQgQXdlc29tZSBGcmVlIDYuNS4yIGJ5IEBmb250YXdlc29tZSAtIGh0dHBzOi8vZm9udGF3ZXNvbWUuY29tIExpY2Vuc2UgLSBodHRwczovL2ZvbnRhd2Vzb21lLmNvbS9saWNlbnNlL2ZyZWUgQ29weXJpZ2h0IDIwMjQgRm9udGljb25zLCBJbmMuLS0+PHBhdGggZD0iTTM4LjggNS4xQzI4LjQtMy4xIDEzLjMtMS4yIDUuMSA5LjJTLTEuMiAzNC43IDkuMiA0Mi45bDU5MiA0NjRjMTAuNCA4LjIgMjUuNSA2LjMgMzMuNy00LjFzNi4zLTI1LjUtNC4xLTMzLjdMNTI1LjYgMzg2LjdjMzkuNi00MC42IDY2LjQtODYuMSA3OS45LTExOC40YzMuMy03LjkgMy4zLTE2LjcgMC0yNC42Yy0xNC45LTM1LjctNDYuMi04Ny43LTkzLTEzMS4xQzQ2NS41IDY4LjggNDAwLjggMzIgMzIwIDMyYy02OC4yIDAtMTI1IDI2LjMtMTY5LjMgNjAuOEwzOC44IDUuMXpNMjIzLjEgMTQ5LjVDMjQ4LjYgMTI2LjIgMjgyLjcgMTEyIDMyMCAxMTJjNzkuNSAwIDE0NCA2NC41IDE0NCAxNDRjMCAyNC45LTYuMyA0OC4zLTE3LjQgNjguN0w0MDggMjk0LjVjOC40LTE5LjMgMTAuNi00MS40IDQuOC02My4zYy0xMS4xLTQxLjUtNDcuOC02OS40LTg4LjYtNzEuMWMtNS44LS4yLTkuMiA2LjEtNy40IDExLjdjMi4xIDYuNCAzLjMgMTMuMiAzLjMgMjAuM2MwIDEwLjItMi40IDE5LjgtNi42IDI4LjNsLTkwLjMtNzAuOHpNMzczIDM4OS45Yy0xNi40IDYuNS0zNC4zIDEwLjEtNTMgMTAuMWMtNzkuNSAwLTE0NC02NC41LTE0NC0xNDRjMC02LjkgLjUtMTMuNiAxLjQtMjAuMkw4My4xIDE2MS41QzYwLjMgMTkxLjIgNDQgMjIwLjggMzQuNSAyNDMuN2MtMy4zIDcuOS0zLjMgMTYuNyAwIDI0LjZjMTQuOSAzNS43IDQ2LjIgODcuNyA5MyAxMzEuMUMxNzQuNSA0NDMuMiAyMzkuMiA0ODAgMzIwIDQ4MGM0Ny44IDAgODkuOS0xMi45IDEyNi4yLTMyLjVMMzczIDM4OS45eiIvPjwvc3ZnPg==";
            const imgSrcEyeOpened =
                "data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA1NzYgNTEyIj48IS0tIUZvbnQgQXdlc29tZSBGcmVlIDYuNS4yIGJ5IEBmb250YXdlc29tZSAtIGh0dHBzOi8vZm9udGF3ZXNvbWUuY29tIExpY2Vuc2UgLSBodHRwczovL2ZvbnRhd2Vzb21lLmNvbS9saWNlbnNlL2ZyZWUgQ29weXJpZ2h0IDIwMjQgRm9udGljb25zLCBJbmMuLS0+PHBhdGggZD0iTTI4OCAzMmMtODAuOCAwLTE0NS41IDM2LjgtMTkyLjYgODAuNkM0OC42IDE1NiAxNy4zIDIwOCAyLjUgMjQzLjdjLTMuMyA3LjktMy4zIDE2LjcgMCAyNC42QzE3LjMgMzA0IDQ4LjYgMzU2IDk1LjQgMzk5LjRDMTQyLjUgNDQzLjIgMjA3LjIgNDgwIDI4OCA0ODBzMTQ1LjUtMzYuOCAxOTIuNi04MC42YzQ2LjgtNDMuNSA3OC4xLTk1LjQgOTMtMTMxLjFjMy4zLTcuOSAzLjMtMTYuNyAwLTI0LjZjLTE0LjktMzUuNy00Ni4yLTg3LjctOTMtMTMxLjFDNDMzLjUgNjguOCAzNjguOCAzMiAyODggMzJ6TTE0NCAyNTZhMTQ0IDE0NCAwIDEgMSAyODggMCAxNDQgMTQ0IDAgMSAxIC0yODggMHptMTQ0LTY0YzAgMzUuMy0yOC43IDY0LTY0IDY0Yy03LjEgMC0xMy45LTEuMi0yMC4zLTMuM2MtNS41LTEuOC0xMS45IDEuNi0xMS43IDcuNGMuMyA2LjkgMS4zIDEzLjggMy4yIDIwLjdjMTMuNyA1MS4yIDY2LjQgODEuNiAxMTcuNiA2Ny45czgxLjYtNjYuNCA2Ny45LTExNy42Yy0xMS4xLTQxLjUtNDcuOC02OS40LTg4LjYtNzEuMWMtNS44LS4yLTkuMiA2LjEtNy40IDExLjdjMi4xIDYuNCAzLjMgMTMuMiAzLjMgMjAuM3oiLz48L3N2Zz4=";
            toggleIcon.addEventListener("click", function () {
                const passwordInput = document.getElementById("staticrypt-password");
                if (passwordInput.type === "password") {
                    passwordInput.type = "text";
                    toggleIcon.src = imgSrcEyeOpened;
                    toggleIcon.alt = templateToggleAltHide;
                    toggleIcon.title = templateToggleAltHide;
                } else {
                    passwordInput.type = "password";
                    toggleIcon.src = imgSrcEyeClosed;
                    toggleIcon.alt = templateToggleAltShow;
                    toggleIcon.title = templateToggleAltShow;
                }
            });

            // handle password form submission
            document.getElementById("staticrypt-form").addEventListener("submit", async function (e) {
                e.preventDefault();

                const password = document.getElementById("staticrypt-password").value,
                    isRememberChecked = document.getElementById("staticrypt-remember").checked;

                const { isSuccessful } = await staticrypt.handleDecryptionOfPage(password, isRememberChecked);

                if (!isSuccessful) {
                    alert(templateError);
                }
            });
        </script>
    </body>
</html>
