<!DOCTYPE html>
<html class="staticrypt-html">
    <head>
        <meta charset="utf-8" />
        <title>Private preview</title>
        <meta name="viewport" content="width=device-width, initial-scale=1" />

        <!-- do not cache this page -->
        <meta http-equiv="cache-control" content="max-age=0" />
        <meta http-equiv="cache-control" content="no-cache" />
        <meta http-equiv="expires" content="0" />
        <meta http-equiv="expires" content="Tue, 01 Jan 1980 1:00:00 GMT" />
        <meta http-equiv="pragma" content="no-cache" />

        <style>
            .staticrypt-hr {
                margin-top: 20px;
                margin-bottom: 20px;
                border: 0;
                border-top: 1px solid #eee;
            }

            .staticrypt-page {
                width: 360px;
                padding: 8% 0 0;
                margin: auto;
                box-sizing: border-box;
            }

            .staticrypt-form {
                position: relative;
                z-index: 1;
                background: #ffffff;
                max-width: 360px;
                margin: 0 auto 100px;
                padding: 45px;
                text-align: center;
                box-shadow: 0 0 20px 0 rgba(0, 0, 0, 0.2), 0 5px 5px 0 rgba(0, 0, 0, 0.24);
            }

            .staticrypt-form input[type="password"],
            input[type="text"] {
                background: inherit;
                border: 0;
                box-sizing: border-box; /* This ensures padding is included in the total width */
                font-size: 14px;
                outline: 0;
                padding: 15px 30px 15px 15px; /* Adjust the padding to ensure there is space for the icon */
                width: 100%;
            }

            .staticrypt-password-container {
                position: relative;
                outline: 0;
                background: #f2f2f2;
                width: 100%;
                border: 0;
                margin: 0 0 15px;
                box-sizing: border-box;
            }

            .staticrypt-toggle-password-visibility {
                cursor: pointer;
                height: 20px;
                opacity: 60%;
                padding: 13px;
                position: absolute;
                right: 0;
                top: 50%;
                transform: translateY(-50%);
                width: 20px;
            }

            .staticrypt-form .staticrypt-decrypt-button {
                text-transform: uppercase;
                outline: 0;
                background: #4CAF50;
                width: 100%;
                border: 0;
                padding: 15px;
                color: #ffffff;
                font-size: 14px;
                cursor: pointer;
            }

            .staticrypt-form .staticrypt-decrypt-button:hover,
            .staticrypt-form .staticrypt-decrypt-button:active,
            .staticrypt-form .staticrypt-decrypt-button:focus {
                background: #4CAF50;
                filter: brightness(92%);
            }

            .staticrypt-html {
                height: 100%;
            }

            .staticrypt-body {
                height: 100%;
                margin: 0;
            }

            .staticrypt-content {
                height: 100%;
                margin-bottom: 1em;
                background: #76B852;
                font-family: "Arial", sans-serif;
                -webkit-font-smoothing: antialiased;
                -moz-osx-font-smoothing: grayscale;
            }

            .staticrypt-instructions {
                margin-top: -1em;
                margin-bottom: 1em;
            }

            .staticrypt-title {
                font-size: 1.5em;
            }

            label.staticrypt-remember {
                display: flex;
                align-items: center;
                margin-bottom: 1em;
            }

            .staticrypt-remember input[type="checkbox"] {
                transform: scale(1.5);
                margin-right: 1em;
            }

            .hidden {
                display: none !important;
            }

            .staticrypt-spinner-container {
                height: 100%;
                display: flex;
                align-items: center;
                justify-content: center;
            }

            .staticrypt-spinner {
                display: inline-block;
                width: 2rem;
                height: 2rem;
                vertical-align: text-bottom;
                border: 0.25em solid gray;
                border-right-color: transparent;
                border-radius: 50%;
                -webkit-animation: spinner-border 0.75s linear infinite;
                animation: spinner-border 0.75s linear infinite;
                animation-duration: 0.75s;
                animation-timing-function: linear;
                animation-delay: 0s;
                animation-iteration-count: infinite;
                animation-direction: normal;
                animation-fill-mode: none;
                animation-play-state: running;
                animation-name: spinner-border;
            }

            @keyframes spinner-border {
                100% {
                    transform: rotate(360deg);
                }
            }

            @media screen and (-webkit-min-device-pixel-ratio: 0) {
                .staticrypt-form input[type="password"],
                input[type="text"] {
                    font-size: 16px;
                }
            }
        </style>
    </head>

    <body class="staticrypt-body">
        <div id="staticrypt_loading" class="staticrypt-spinner-container">
            <div class="staticrypt-spinner"></div>
        </div>

        <div id="staticrypt_content" class="staticrypt-content hidden">
            <div class="staticrypt-page">
                <div class="staticrypt-form">
                    <div class="staticrypt-instructions">
                        <p class="staticrypt-title">Private preview</p>
                        <p>Enter the preview password.</p>
                    </div>

                    <hr class="staticrypt-hr" />

                    <form id="staticrypt-form" action="#" method="post">
                        <div class="staticrypt-password-container">
                            <input
                                id="staticrypt-password"
                                type="password"
                                name="password"
                                placeholder="Password"
                                autofocus
                            />

                            <img
                                class="staticrypt-toggle-password-visibility"
                                alt="Show password"
                                title="Show password"
                                src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA2NDAgNTEyIj48IS0tIUZvbnQgQXdlc29tZSBGcmVlIDYuNS4yIGJ5IEBmb250YXdlc29tZSAtIGh0dHBzOi8vZm9udGF3ZXNvbWUuY29tIExpY2Vuc2UgLSBodHRwczovL2ZvbnRhd2Vzb21lLmNvbS9saWNlbnNlL2ZyZWUgQ29weXJpZ2h0IDIwMjQgRm9udGljb25zLCBJbmMuLS0+PHBhdGggZD0iTTM4LjggNS4xQzI4LjQtMy4xIDEzLjMtMS4yIDUuMSA5LjJTLTEuMiAzNC43IDkuMiA0Mi45bDU5MiA0NjRjMTAuNCA4LjIgMjUuNSA2LjMgMzMuNy00LjFzNi4zLTI1LjUtNC4xLTMzLjdMNTI1LjYgMzg2LjdjMzkuNi00MC42IDY2LjQtODYuMSA3OS45LTExOC40YzMuMy03LjkgMy4zLTE2LjcgMC0yNC42Yy0xNC45LTM1LjctNDYuMi04Ny43LTkzLTEzMS4xQzQ2NS41IDY4LjggNDAwLjggMzIgMzIwIDMyYy02OC4yIDAtMTI1IDI2LjMtMTY5LjMgNjAuOEwzOC44IDUuMXpNMjIzLjEgMTQ5LjVDMjQ4LjYgMTI2LjIgMjgyLjcgMTEyIDMyMCAxMTJjNzkuNSAwIDE0NCA2NC41IDE0NCAxNDRjMCAyNC45LTYuMyA0OC4zLTE3LjQgNjguN0w0MDggMjk0LjVjOC40LTE5LjMgMTAuNi00MS40IDQuOC02My4zYy0xMS4xLTQxLjUtNDcuOC02OS40LTg4LjYtNzEuMWMtNS44LS4yLTkuMiA2LjEtNy40IDExLjdjMi4xIDYuNCAzLjMgMTMuMiAzLjMgMjAuM2MwIDEwLjItMi40IDE5LjgtNi42IDI4LjNsLTkwLjMtNzAuOHpNMzczIDM4OS45Yy0xNi40IDYuNS0zNC4zIDEwLjEtNTMgMTAuMWMtNzkuNSAwLTE0NC02NC41LTE0NC0xNDRjMC02LjkgLjUtMTMuNiAxLjQtMjAuMkw4My4xIDE2MS41QzYwLjMgMTkxLjIgNDQgMjIwLjggMzQuNSAyNDMuN2MtMy4zIDcuOS0zLjMgMTYuNyAwIDI0LjZjMTQuOSAzNS43IDQ2LjIgODcuNyA5MyAxMzEuMUMxNzQuNSA0NDMuMiAyMzkuMiA0ODAgMzIwIDQ4MGM0Ny44IDAgODkuOS0xMi45IDEyNi4yLTMyLjVMMzczIDM4OS45eiIvPjwvc3ZnPg=="
                            />
                        </div>

                        <label id="staticrypt-remember-label" class="staticrypt-remember hidden">
                            <input id="staticrypt-remember" type="checkbox" name="remember" />
                            Remember me
                        </label>

                        <input type="submit" class="staticrypt-decrypt-button" value="DECRYPT" />
                    </form>
                </div>
            </div>
        </div>

        <script>
            // these variables will be filled when generating the file - the template format is 'variable_name'
            const staticryptInitiator = ((function(){
  const exports = {};
  const cryptoEngine = ((function(){
  const exports = {};
  const { subtle } = crypto;

const IV_BITS = 16 * 8;
const HEX_BITS = 4;
const ENCRYPTION_ALGO = "AES-CBC";

/**
 * Translates between utf8 encoded hexadecimal strings
 * and Uint8Array bytes.
 */
const HexEncoder = {
    /**
     * hex string -> bytes
     * @param {string} hexString
     * @returns {Uint8Array}
     */
    parse: function (hexString) {
        if (hexString.length % 2 !== 0) throw "Invalid hexString";
        const arrayBuffer = new Uint8Array(hexString.length / 2);

        for (let i = 0; i < hexString.length; i += 2) {
            const byteValue = parseInt(hexString.substring(i, i + 2), 16);
            if (isNaN(byteValue)) {
                throw "Invalid hexString";
            }
            arrayBuffer[i / 2] = byteValue;
        }
        return arrayBuffer;
    },

    /**
     * bytes -> hex string
     * @param {Uint8Array} bytes
     * @returns {string}
     */
    stringify: function (bytes) {
        const hexBytes = [];

        for (let i = 0; i < bytes.length; ++i) {
            let byteString = bytes[i].toString(16);
            if (byteString.length < 2) {
                byteString = "0" + byteString;
            }
            hexBytes.push(byteString);
        }
        return hexBytes.join("");
    },
};

/**
 * Translates between utf8 strings and Uint8Array bytes.
 */
const UTF8Encoder = {
    parse: function (str) {
        return new TextEncoder().encode(str);
    },

    stringify: function (bytes) {
        return new TextDecoder().decode(bytes);
    },
};

/**
 * Salt and encrypt a msg with a password.
 */
async function encrypt(msg, hashedPassword) {
    // Must be 16 bytes, unpredictable, and preferably cryptographically random. However, it need not be secret.
    // https://developer.mozilla.org/en-US/docs/Web/API/SubtleCrypto/encrypt#parameters
    const iv = crypto.getRandomValues(new Uint8Array(IV_BITS / 8));

    const key = await subtle.importKey("raw", HexEncoder.parse(hashedPassword), ENCRYPTION_ALGO, false, ["encrypt"]);

    const encrypted = await subtle.encrypt(
        {
            name: ENCRYPTION_ALGO,
            iv: iv,
        },
        key,
        UTF8Encoder.parse(msg)
    );

    // iv will be 32 hex characters, we prepend it to the ciphertext for use in decryption
    return HexEncoder.stringify(iv) + HexEncoder.stringify(new Uint8Array(encrypted));
}
exports.encrypt = encrypt;

/**
 * Decrypt a salted msg using a password.
 *
 * @param {string} encryptedMsg
 * @param {string} hashedPassword
 * @returns {Promise<string>}
 */
async function decrypt(encryptedMsg, hashedPassword) {
    const ivLength = IV_BITS / HEX_BITS;
    const iv = HexEncoder.parse(encryptedMsg.substring(0, ivLength));
    const encrypted = encryptedMsg.substring(ivLength);

    const key = await subtle.importKey("raw", HexEncoder.parse(hashedPassword), ENCRYPTION_ALGO, false, ["decrypt"]);

    const outBuffer = await subtle.decrypt(
        {
            name: ENCRYPTION_ALGO,
            iv: iv,
        },
        key,
        HexEncoder.parse(encrypted)
    );

    return UTF8Encoder.stringify(new Uint8Array(outBuffer));
}
exports.decrypt = decrypt;

/**
 * Salt and hash the password so it can be stored in localStorage without opening a password reuse vulnerability.
 *
 * @param {string} password
 * @param {string} salt
 * @returns {Promise<string>}
 */
async function hashPassword(password, salt) {
    // we hash the password in multiple steps, each adding more iterations. This is because we used to allow less
    // iterations, so for backward compatibility reasons, we need to support going from that to more iterations.
    let hashedPassword = await hashLegacyRound(password, salt);

    hashedPassword = await hashSecondRound(hashedPassword, salt);

    return hashThirdRound(hashedPassword, salt);
}
exports.hashPassword = hashPassword;

/**
 * This hashes the password with 1k iterations. This is a low number, we need this function to support backwards
 * compatibility.
 *
 * @param {string} password
 * @param {string} salt
 * @returns {Promise<string>}
 */
function hashLegacyRound(password, salt) {
    return pbkdf2(password, salt, 1000, "SHA-1");
}
exports.hashLegacyRound = hashLegacyRound;

/**
 * Add a second round of iterations. This is because we used to use 1k, so for backwards compatibility with
 * remember-me/autodecrypt links, we need to support going from that to more iterations.
 *
 * @param hashedPassword
 * @param salt
 * @returns {Promise<string>}
 */
function hashSecondRound(hashedPassword, salt) {
    return pbkdf2(hashedPassword, salt, 14000, "SHA-256");
}
exports.hashSecondRound = hashSecondRound;

/**
 * Add a third round of iterations to bring total number to 600k. This is because we used to use 1k, then 15k, so for
 * backwards compatibility with remember-me/autodecrypt links, we need to support going from that to more iterations.
 *
 * @param hashedPassword
 * @param salt
 * @returns {Promise<string>}
 */
function hashThirdRound(hashedPassword, salt) {
    return pbkdf2(hashedPassword, salt, 585000, "SHA-256");
}
exports.hashThirdRound = hashThirdRound;

/**
 * Salt and hash the password so it can be stored in localStorage without opening a password reuse vulnerability.
 *
 * @param {string} password
 * @param {string} salt
 * @param {int} iterations
 * @param {string} hashAlgorithm
 * @returns {Promise<string>}
 */
async function pbkdf2(password, salt, iterations, hashAlgorithm) {
    const key = await subtle.importKey("raw", UTF8Encoder.parse(password), "PBKDF2", false, ["deriveBits"]);

    const keyBytes = await subtle.deriveBits(
        {
            name: "PBKDF2",
            hash: hashAlgorithm,
            iterations,
            salt: UTF8Encoder.parse(salt),
        },
        key,
        256
    );

    return HexEncoder.stringify(new Uint8Array(keyBytes));
}

function generateRandomSalt() {
    const bytes = crypto.getRandomValues(new Uint8Array(128 / 8));

    return HexEncoder.stringify(new Uint8Array(bytes));
}
exports.generateRandomSalt = generateRandomSalt;

async function signMessage(hashedPassword, message) {
    const key = await subtle.importKey(
        "raw",
        HexEncoder.parse(hashedPassword),
        {
            name: "HMAC",
            hash: "SHA-256",
        },
        false,
        ["sign"]
    );
    const signature = await subtle.sign("HMAC", key, UTF8Encoder.parse(message));

    return HexEncoder.stringify(new Uint8Array(signature));
}
exports.signMessage = signMessage;

function getRandomAlphanum() {
    const possibleCharacters = "abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789";

    let byteArray;
    let parsedInt;

    // Keep generating new random bytes until we get a value that falls
    // within a range that can be evenly divided by possibleCharacters.length
    do {
        byteArray = crypto.getRandomValues(new Uint8Array(1));
        // extract the lowest byte to get an int from 0 to 255 (probably unnecessary, since we're only generating 1 byte)
        parsedInt = byteArray[0] & 0xff;
    } while (parsedInt >= 256 - (256 % possibleCharacters.length));

    // Take the modulo of the parsed integer to get a random number between 0 and totalLength - 1
    const randomIndex = parsedInt % possibleCharacters.length;

    return possibleCharacters[randomIndex];
}

/**
 * Generate a random string of a given length.
 *
 * @param {int} length
 * @returns {string}
 */
function generateRandomString(length) {
    let randomString = "";

    for (let i = 0; i < length; i++) {
        randomString += getRandomAlphanum();
    }

    return randomString;
}
exports.generateRandomString = generateRandomString;

  return exports;
})());
const codec = ((function(){
  const exports = {};
  /**
 * Initialize the codec with the provided cryptoEngine - this return functions to encode and decode messages.
 *
 * @param cryptoEngine - the engine to use for encryption / decryption
 */
function init(cryptoEngine) {
    const exports = {};

    /**
     * Top-level function for encoding a message.
     * Includes password hashing, encryption, and signing.
     *
     * @param {string} msg
     * @param {string} password
     * @param {string} salt
     *
     * @returns {string} The encoded text
     */
    async function encode(msg, password, salt) {
        const hashedPassword = await cryptoEngine.hashPassword(password, salt);

        const encrypted = await cryptoEngine.encrypt(msg, hashedPassword);

        // we use the hashed password in the HMAC because this is effectively what will be used a password (so we can store
        // it in localStorage safely, we don't use the clear text password)
        const hmac = await cryptoEngine.signMessage(hashedPassword, encrypted);

        return hmac + encrypted;
    }
    exports.encode = encode;

    /**
     * Encode using a password that has already been hashed. This is useful to encode multiple messages in a row, that way
     * we don't need to hash the password multiple times.
     *
     * @param {string} msg
     * @param {string} hashedPassword
     *
     * @returns {string} The encoded text
     */
    async function encodeWithHashedPassword(msg, hashedPassword) {
        const encrypted = await cryptoEngine.encrypt(msg, hashedPassword);

        // we use the hashed password in the HMAC because this is effectively what will be used a password (so we can store
        // it in localStorage safely, we don't use the clear text password)
        const hmac = await cryptoEngine.signMessage(hashedPassword, encrypted);

        return hmac + encrypted;
    }
    exports.encodeWithHashedPassword = encodeWithHashedPassword;

    /**
     * Top-level function for decoding a message.
     * Includes signature check and decryption.
     *
     * @param {string} signedMsg
     * @param {string} hashedPassword
     * @param {string} salt
     * @param {int} backwardCompatibleAttempt
     * @param {string} originalPassword
     *
     * @returns {Object} {success: true, decoded: string} | {success: false, message: string}
     */
    async function decode(signedMsg, hashedPassword, salt, backwardCompatibleAttempt = 0, originalPassword = "") {
        const encryptedHMAC = signedMsg.substring(0, 64);
        const encryptedMsg = signedMsg.substring(64);
        const decryptedHMAC = await cryptoEngine.signMessage(hashedPassword, encryptedMsg);

        if (decryptedHMAC !== encryptedHMAC) {
            // we have been raising the number of iterations in the hashing algorithm multiple times, so to support the old
            // remember-me/autodecrypt links we need to try bringing the old hashes up to speed.
            originalPassword = originalPassword || hashedPassword;
            if (backwardCompatibleAttempt === 0) {
                const updatedHashedPassword = await cryptoEngine.hashThirdRound(originalPassword, salt);

                return decode(signedMsg, updatedHashedPassword, salt, backwardCompatibleAttempt + 1, originalPassword);
            }
            if (backwardCompatibleAttempt === 1) {
                let updatedHashedPassword = await cryptoEngine.hashSecondRound(originalPassword, salt);
                updatedHashedPassword = await cryptoEngine.hashThirdRound(updatedHashedPassword, salt);

                return decode(signedMsg, updatedHashedPassword, salt, backwardCompatibleAttempt + 1, originalPassword);
            }

            return { success: false, message: "Signature mismatch" };
        }

        return {
            success: true,
            decoded: await cryptoEngine.decrypt(encryptedMsg, hashedPassword),
        };
    }
    exports.decode = decode;

    return exports;
}
exports.init = init;

  return exports;
})());
const decode = codec.init(cryptoEngine).decode;

/**
 * Initialize the staticrypt module, that exposes functions callbable by the password_template.
 *
 * @param {{
 *  staticryptEncryptedMsgUniqueVariableName: string,
 *  isRememberEnabled: boolean,
 *  rememberDurationInDays: number,
 *  staticryptSaltUniqueVariableName: string,
 * }} staticryptConfig - object of data that is stored on the password_template at encryption time.
 *
 * @param {{
 *  rememberExpirationKey: string,
 *  rememberPassphraseKey: string,
 *  replaceHtmlCallback: function,
 *  clearLocalStorageCallback: function,
 * }} templateConfig - object of data that can be configured by a custom password_template.
 */
function init(staticryptConfig, templateConfig) {
    const exports = {};

    /**
     * Decrypt our encrypted page, replace the whole HTML.
     *
     * @param {string} hashedPassword
     * @returns {Promise<boolean>}
     */
    async function decryptAndReplaceHtml(hashedPassword) {
        const { staticryptEncryptedMsgUniqueVariableName, staticryptSaltUniqueVariableName } = staticryptConfig;
        const { replaceHtmlCallback } = templateConfig;

        const result = await decode(
            staticryptEncryptedMsgUniqueVariableName,
            hashedPassword,
            staticryptSaltUniqueVariableName
        );
        if (!result.success) {
            return false;
        }
        const plainHTML = result.decoded;

        // if the user configured a callback call it, otherwise just replace the whole HTML
        if (typeof replaceHtmlCallback === "function") {
            replaceHtmlCallback(plainHTML);
        } else {
            document.write(plainHTML);
            document.close();
        }

        return true;
    }

    /**
     * Attempt to decrypt the page and replace the whole HTML.
     *
     * @param {string} password
     * @param {boolean} isRememberChecked
     *
     * @returns {Promise<{isSuccessful: boolean, hashedPassword?: string}>} - we return an object, so that if we want to
     *   expose more information in the future we can do it without breaking the password_template
     */
    async function handleDecryptionOfPage(password, isRememberChecked) {
        const { staticryptSaltUniqueVariableName } = staticryptConfig;

        // decrypt and replace the whole page
        const hashedPassword = await cryptoEngine.hashPassword(password, staticryptSaltUniqueVariableName);
        return handleDecryptionOfPageFromHash(hashedPassword, isRememberChecked);
    }
    exports.handleDecryptionOfPage = handleDecryptionOfPage;

    async function handleDecryptionOfPageFromHash(hashedPassword, isRememberChecked) {
        const { isRememberEnabled, rememberDurationInDays } = staticryptConfig;
        const { rememberExpirationKey, rememberPassphraseKey } = templateConfig;

        const isDecryptionSuccessful = await decryptAndReplaceHtml(hashedPassword);

        if (!isDecryptionSuccessful) {
            return {
                isSuccessful: false,
                hashedPassword,
            };
        }

        // remember the hashedPassword and set its expiration if necessary
        if (isRememberEnabled && isRememberChecked) {
            window.localStorage.setItem(rememberPassphraseKey, hashedPassword);

            // set the expiration if the duration isn't 0 (meaning no expiration)
            if (rememberDurationInDays > 0) {
                window.localStorage.setItem(
                    rememberExpirationKey,
                    (new Date().getTime() + rememberDurationInDays * 24 * 60 * 60 * 1000).toString()
                );
            }
        }

        return {
            isSuccessful: true,
            hashedPassword,
        };
    }
    exports.handleDecryptionOfPageFromHash = handleDecryptionOfPageFromHash;

    /**
     * Clear localstorage from staticrypt related values
     */
    function clearLocalStorage() {
        const { clearLocalStorageCallback, rememberExpirationKey, rememberPassphraseKey } = templateConfig;

        if (typeof clearLocalStorageCallback === "function") {
            clearLocalStorageCallback();
        } else {
            localStorage.removeItem(rememberPassphraseKey);
            localStorage.removeItem(rememberExpirationKey);
        }
    }

    async function handleDecryptOnLoad() {
        let isSuccessful = await decryptOnLoadFromUrl();

        if (!isSuccessful) {
            isSuccessful = await decryptOnLoadFromRememberMe();
        }

        return { isSuccessful };
    }
    exports.handleDecryptOnLoad = handleDecryptOnLoad;

    /**
     * Clear storage if we are logging out
     *
     * @returns {boolean} - whether we logged out
     */
    function logoutIfNeeded() {
        const logoutKey = "staticrypt_logout";

        // handle logout through query param
        const queryParams = new URLSearchParams(window.location.search);
        if (queryParams.has(logoutKey)) {
            clearLocalStorage();
            return true;
        }

        // handle logout through URL fragment
        const hash = window.location.hash.substring(1);
        if (hash.includes(logoutKey)) {
            clearLocalStorage();
            return true;
        }

        return false;
    }

    /**
     * To be called on load: check if we want to try to decrypt and replace the HTML with the decrypted content, and
     * try to do it if needed.
     *
     * @returns {Promise<boolean>} true if we derypted and replaced the whole page, false otherwise
     */
    async function decryptOnLoadFromRememberMe() {
        const { rememberDurationInDays } = staticryptConfig;
        const { rememberExpirationKey, rememberPassphraseKey } = templateConfig;

        // if we are login out, terminate
        if (logoutIfNeeded()) {
            return false;
        }

        // if there is expiration configured, check if we're not beyond the expiration
        if (rememberDurationInDays && rememberDurationInDays > 0) {
            const expiration = localStorage.getItem(rememberExpirationKey),
                isExpired = expiration && new Date().getTime() > parseInt(expiration);

            if (isExpired) {
                clearLocalStorage();
                return false;
            }
        }

        const hashedPassword = localStorage.getItem(rememberPassphraseKey);

        if (hashedPassword) {
            // try to decrypt
            const isDecryptionSuccessful = await decryptAndReplaceHtml(hashedPassword);

            // if the decryption is unsuccessful the password might be wrong - silently clear the saved data and let
            // the user fill the password form again
            if (!isDecryptionSuccessful) {
                clearLocalStorage();
                return false;
            }

            return true;
        }

        return false;
    }

    async function decryptOnLoadFromUrl() {
        const passwordKey = "staticrypt_pwd";
        const rememberMeKey = "remember_me";

        // try to get the password from the query param (for backward compatibility - we now want to avoid this method,
        // since it sends the hashed password to the server which isn't needed)
        const queryParams = new URLSearchParams(window.location.search);
        const hashedPasswordQuery = queryParams.get(passwordKey);
        const rememberMeQuery = queryParams.get(rememberMeKey);

        const urlFragment = window.location.hash.substring(1);
        // get the password from the url fragment
        const hashedPasswordRegexMatch = urlFragment.match(new RegExp(passwordKey + "=([^&]*)"));
        const hashedPasswordFragment = hashedPasswordRegexMatch ? hashedPasswordRegexMatch[1] : null;
        const rememberMeFragment = urlFragment.includes(rememberMeKey);

        const hashedPassword = hashedPasswordFragment || hashedPasswordQuery;
        const rememberMe = rememberMeFragment || rememberMeQuery;

        if (hashedPassword) {
            return handleDecryptionOfPageFromHash(hashedPassword, rememberMe);
        }

        return false;
    }

    return exports;
}
exports.init = init;

  return exports;
})());
            const templateError = "Bad password!",
                templateToggleAltShow = "Show password",
                templateToggleAltHide = "Hide password",
                isRememberEnabled = true,
                staticryptConfig = {"staticryptEncryptedMsgUniqueVariableName":"316fe39440ae604b9d00ba271f2de3a772f22cb3c5b0211fba5bfc46980f7fb6f35265a4abb3a95ceefd63579e771a372ee36c64056e01bf0f5e48f1104dfa2ae7a70a37457f48d3f151f4c1fd610f133585b777293ccab9822b10beeb6e1005462cd5c369153463e6464ab42f69fa9b37ba1f1a45ca9d4250e3280c420d3d6024b0b130698258f4c65999677ec0fe6952c255a03a85b3502d498109a2f73235a76262460ecf84ffdab75adf6b5b1c94d540b7ed32ca89dca0aeaef29d1af7f889b8b909bc0d34f01967682d16b07c0887b4b585098ea24761d09b8c1d03ee4d14882a07a3e89e7870f9e01091f2ef0531872ebbb76c75ae2ac34083929537347ceebad31c045956d479329859f9ea5331310ef0aa679916edf57a8676a51ebba9274b7259e478a84f9d61b66f3e0ce81d9fc13dea51ed19035a630fbb662020a50016cd197cb8da219746c8219bb11809bdc11b955e8ed54427f5f30e92fe4876081a1f8b3bd4e68c354e6e6fef0933271e42cdc4d015c4432cf7c2fa4e07e43473cd00c118b4e1694bac0db0de2ada8ee5752a9531d3df1b9ad7ef0dfdd574f72b4cb10e0d2efa27379676f84109bf79bccf587a9eed1e0d1417dba6f564486c19c056ad1b11238996e16d00ebc77b8024c610afbda3f4830b6fa9b4ea4a9da8fed1960292c56330421980447bb4a022e857200ffccb1aac1ad861113ec8ad9910202fcc77422592189618c8cf900518ba19ff17769f61b1ced15e5b82780bee9e289e5b72d61760651cc9c9e3a9d4aa0a77407f065bf54c92a708653918f6968fac21e30c1ab81adf3b54592e1bffd6cc73ca3fe6b31f2a998dfc923b0713d848c30346ec9c8ab1f7c411786448aa4993d15253855d3e71f66abbbef84892ba7881ae6f632717c028318c247fa585ab8b7da8200496eed525a3766a069506768edbc0da29a46c59aded41ae86e3afce5a80019652a7c75e956dc9f01e6c83b0a1e13d65c2711676c6dde02a0815e858b14ed9ae7d6119efab33fd0335427161d603cbacbdfd95a84bf6adcfcbc68cb26da8204db750e1aeada7a2b0bc61d15a55df8fad99899b76430a9ed5a9b4131afeb9af29c814395aa627fb02cad1865dd292f8b70d2ed1fb1c1439a43384b134e86cd04749a9ff2024b37b7e77197da0f70480285366fdb3f709c63c015d9df64a15089e179af1c597a6f272c5bed28ceb74f319e000825030232aa10b547b0bd556733f76f8a483d58dc37a9916b4bb2973ce8a7a2273a96ce8bf57d0504a0cca2ec260bc5e6a2f35acfc254de96078e08e8a04d10e8e3193e04793898d10c8a3c84a1baeb37cf6004997d0a2f88216950f76615a96617c6fd518fdcef46f564e5e45346e6fc5dd2ef9596e62dc8cde636a6d12d9ff34703941c4abeaacd79481b340d879ced9ef0e34ec2df73235402b38311c249a22b444e875ada62a1142ac8cd7888b155566012158a161c42dfa90d7c2591cd377cbe7c08e96d626f840d803728b032a3e20025e66260d2bac838abebf95cd39d3b1ef8c28c41833113cc542ee0df60ca6d99febf13fc45cedd54da2f1ff04efd6db250a58a1d069f5426cdf9ccfa27c35b2905d629ef785aee71f321bb8ffc64234c80af8d517d6cfa8180da0a04f536d07a8aab0da31880ab7bd53a55f1d62c307275713945ff17152e832251d3a2eadca9db45ace1af338547995450ad7a99c48be77eb3de3d75f9eb565991964992b749d4fe456decb98afd6210e4b8954d1587f40a86b3ce40a012b2b66b982b77867044007a3b5c870666abe94edd32a43c0225496ad64850d99b9938a67afe4129f9a2c78204a97b0a0162a59bc89d84fc0873f111d304ea167fca2c87c437f24c27b60854df593c5efe7df7149a863fa2674da55d996b18bac665549dd71feac2f9378c3105662ada5e495dd370ac3a5b74b3c0fef25d14a4a74eff77d083e0da38739c6bc8ce738af8549a5b0221cfe906f35295c616a68d69c5e60c219578d7d6d053214dd6b21ed7da9f31908019229473ae5313efe6823ef6ad0c0d96f1522ab5ff0dd0da28c21d82a906c2ab1823d3e95076ead996b2d618e7262759939d139f7d699e09eaa8f2843aa425d5b6dd17cbe702fa56ac868833e41b468b8362657437436f45010a3024f0e2d07c34e70eafb18d2029eb7dde6e8f1a71391c1edb71e8c16bc2e7600ae49ec9670f8d8c48c3bcde49637fb0e91a1c5d111489f661e4e0e3f74991552938c50ef32f3477590f701596a60b6eb7733c69fa46d1c76d582e47cffa3b3addb45b365a7a25fee4edecad9a82f1c72a6283ca7f6b14208399ebc61336c7a1a2b08c3a0c0fb829263920706650a6b630577cb0cca075bdbb8734a2b248ea07b22f5c7cb31fd34dbdb734b8b9e7ac3267545f1f3f43b7aedf04bd5dd0a37223bf32012d2764910f2636baca648a279d879ed5f2d94d0e8e8664854f961ecc3340b815968055f09a1572f4829f0ec32f4f356e26dc14e9cde5a76c42c35d66968f967076500143f4e188c80ed7c3815597769e672ce0ba80efd306ebc6f963e70e196b836c826278e04653e4c7785dc3b94bda877c09b9140cb0ca4ea4212d47da0e0184602fcee4a2a2aa39aa2f6a4c800ad04e11129f2169742e610a7b21df3fbb94f1d29adf774a4639617e6d21c860109358678e063cc092f2d725ad5083a3eb3fc8a1a868cfbc5074d40a5709de561f37440bab2b4d50fc1871578b325a4b3442e1019c102e5593e612e6870f3d07e928581ea2e35888a90a74e00f8ba8ce7d51f17f3cbd571d9cee9bb664077ac2f10fe628fccab5385dc88d1e0471f938eedf30acab3ce197a097721191df7ce2bc499e885ee80d93dcd0f826d45d8cb17a2ac2da974ec0e5c36aa241b4f66465311a02c26c223d5b7f4a05a22ddff27060b5723f90c2ef9f535bab91fcea9358558c145fec25edccee748583aecbb0db3f9c42394df6043eed04e5f0cc8519dbc4ac8b2cf9da3a5419cc3f9d3edc91678002b981049e04ab54619953abcfd0dda81fc2e128ac3a9cbc58c996027314d9127593863aea897759be7808368fa43b7159835502acdb6a733f60ec32be1e7900fe40ab32a7695110583f724f12ba68f787db223d1fbf2dc5da64efb630a5a394e7ab959a9074fa6fc4222aca846ab6164dafb65dfab53d2d58613a5e5432ec50487f0f99d1cc8249c59f6898f7cc844f3d21a4556b4df2f3aec26a02e0df569a5307c38b5c0554abe4e1b705ad4893e28b881c506c8408c58b7955b0195d463e652f614369d0bdef0a6b161e686d8598449193da6ed3894ae9732595e0dba708cd0a7f1db8eee6580158c98e8bb0f9af3702278ee7dc8e5858baad0072c9322ffa59e5a8622fe1bc7d1be38bf33b451b19daf09612e78198243d7c433cde7ad8d9986a26944e988094665745dbba5f150b3aacbb7a9899f30ef6fec3c8543304322e1c08f7d9ac684b7f2ef9585c51774266c2eeb87684de9dbd9225f7fea976e23abd54e73e4493d4f14ce44875f6fcf086c82aaa4b77ed1a563ed0ff323999569c4634b3d757d6d186b8230e1cdd7e00bae33fe8e501625b486c12a6dd7dcbe9c1ab8242d48931e2a589acf88c0b7925c428a7863b85cf7d53f31e35084bd4d56ad9e6a22e15de57cf0b997d3fa3c099e2fd40756913e328a412b10a9879cf64b0ea8a950858be37294dd93b70681309d345702b67baa639b4907cdedbb655528e8412bebe2e4556c462378d9ecdd3a27f9248329ba7ea674cbe9eb136fdaaa08e48264c9161901a7417e470362d39e2905b9781437e5b766faa86010d6279c54775df236fccd5373d4ad31aa1eb0f4f10ff38459ac2ac7c451983d2662de8c25ab03fd7000e90977363af68fd5f41c4730f21795529c3d0230fb5e67f7da4dab78926c71552be1c864804329652104d12d7d4de1dbc8afaed90b2a2146795feb7b4b2b6a406e5c181aee345153b98ab020765bbd3ab1a8f29f10dce3018f101234f7876a7d23ad44c1baf471d4e965018b9144aa4aff185f94450e0fda4130a9eb7a28052d183007e168786348fe8bd0a5f7c9f50e99c6c18d5bd92cc652f2d348b245d7fc9f4711c7b885b517cfb33d6d8126ac476837be87341fcf2465ac93ab37195c2b6bc2739e7993ae8dea136076bbc2d41566fa22012bea612e9c37d62726ca12430720239c5f1e859fb034e595bbe0bb91c1bb8027ec078621d95e9369f9a775106aadab5bb246d23f33fa3596418a9cb4e98327a6ddeaeb25f9d67d2ce952321cf6a08247a09454bb0704e1239fa67c98fdefb02d48028f197bbdb24dda95f00fcce98e6ddb7aafd7ff5d99536f27a1b6910f66523bac1bcd15753e8b8540e5529b1d1427d3d99371bb8f52738492c9376dc43ac39357db6a301ec9acee35baab7fa09b41ae16d72be063ccc24f2daddb9b28071e570c035fb2a0f28db250e4903656ee54cf369b95a0ba426fbb1516e4511a8f0c3f92ffbb14a807a21a5026982eb97fde9c5a0a579f808a188daf2c6e8e34201696826dd074196229b1253545628148d7c53209e4831414c03971427f25329e93ebd9336a551ca60cdf40977beb3ea95aa24c531cf6166e19173ee1aa5fa6224c0aca294978bb57778b553f05c5309f10877d2a7a478d1697340bb482c40725617a68341a806787bd1590e6ab9477150f5fd2ab1436ff721891d00e746dfed7fa00f9ab8ce90d465608c574d2e53044eaa810f7bf62f6deb8d16735c402c1104fa88c46812fd8fc696505cf6efc2648f98f62dde858744fdbe5a52b7d2d714c9150bdec47b04f549b1c6f951a4d50f9faa6b4a3241129d86accc513c7c7a9121351ff3c45a5aed7b98d3f4a40ccdf25b3ddb17a39aa50cdb1223f09fec33e6a92e8569040a5a0032d0cc4581fae574aebb5ee768b64f3d7e51430bad717a35b06f0d29bdda26afaef8cbdd51effad9b20b4bc329be92b8461f3589821566664d64ffa825d0eb506bad40697699a643823d3910af3d49182827631ac461b367002dfe6f369a2c6f6e8c82b338ae930a7901b2b62b9f4bd9c03b7636f6e2aac10b500505085a4731ad24170c3f64e3be13ce42d28bec6c58db7eca4e21331c88132858d9a1f281794eefa3286cf40ecfc7c2c36da8f9eb17ce71f3b2b238d7bea8e2723856febac2fb423c3825e01cb007f02f61c3a0987141edf544a552a91253ada316b1757bab0288f470bbaf52b0bd33cc1c49c54ba6204d3f866bcd5a29ea8a7075442442f587f728678f46b5efb9bff172ed7282176fdefe5ee49ecf455741aa54992c9c7522b56bef005f632898fb7823e9a0dff1302b1efdf79dccd123579a916289d6d913c6732a7f5923d46ad1c5fc8b31b69633bea85d5443ecb22f181b525692bfc7ab28b66ea0936b61d0e7c87ef26172e63844f7de6994708e218e2f59488dd957eeca06be10eb609186cadce6888a28b674d7be35f0094ed0335a4c4d33c4dca82cc90dcc9dcfc2b346defb0c0401a5cef06eaf540cd70b1a455abaf34f9f052dd482dfc5ca4a3257a332731f3633819913554770a3c97ce8bd2f811f66b98d1a8053d938fb70f679e1558562b7349ac7845df7ab28caf6377fe4d4748ff9b9d5df96f078f34a17976311a9409c961a4464543f18b2abc159f5e36e8dc49c21f34ad4858f0b67e3f4584cf46ef5621027bf4da7b31d00305cf8fd68fdb2c282cf9b14c28b58a24aa121c1295be44c1157bc9907f59f202f59c8a80b7c4f4ed123249b060134209009b62e5aa24305bc54c79bfbc391c2298fa12b9028106bd787111faa823c792c02b18d31f6e8929fd40d60d8562e1e812d8d0235b8d684d2e66f5225c41b5a2c4c2daa159a6853e7423ecf9637f026e8349b3cac9a4eca3d50d9e025ad2d5ed193366873bbd17c315c88a5ee91c46de58e37ca484427f80ce169dfbc84f885174a0b65ee68b5971c8b4a4ab92c749bd18acb2086cbcb694c9f1ba0b3e8249b9220a32a35c220c0e8bb0eb9a0f90ab54ad0bdadf0b3583838f2165a36505ac31102a681e05eeb4b5fce540f7e37c84f7ea4e00485b6d03b766927e28055920913005cf96ae496cbaf26ec19d309425b44a82412c86476b219b91d2c55b42528b0786d9b816d06b48eb2d9697fea6e4061183d531f06db49a0c0172c161aba2e5a4ef7b23deee7f4610e55ab9f845eafb9b4c5666369463628fb3a2d6816ea383a24eec940fdfb1ea4472c3f3743d0d2adbe105e8eb253c45cf6c687e75cb725c281dac215188e8cba915509e3092fa5c9905b8a9910e57c3d30e254d5e08dfb0790c62731b9cc94d757b8e23d56bfc3c52bd0692ebd00cb3b2567e52290cafc22cd65364ab32fc94116a9b80961467dc09b8b6dc49438fb4e82d9ede592b0d6640e1803dff56dca9b5f841ccfaa145f8bc37a81fd5ab57a8927db7d4fad50555bb2db2cdb9590b8620acfc4415679ce82038908698118311f053bcf8e4d5f2de7e0e2d3be3dab2e0f06b5fd1813130255579b41c63cefb8b7aa224e80d20119af6da466b20fe06fad69ede7dab8dac8c6d87d1df0e1dd6d210f363961b30d1c6b255f493dbbd67ed4c4aec2c4ae91948acc6a752ede34c3915ea87e6d1f5b53933a047ab9350aaa8b08af7a011528ef26ea64554168911f9ec42a03b776c695275061eb34de6657e59f82833015d1a989e87a8b82318f0ad6f2a6dc5dd9b44638aeb7fbab83cf347260547aa49420730285cfa38345798827511bf5a40bf54da2184c380826d7bdb99b760f16740f7878d13044757c0138fc126089da8331b35e1546a8e6e4dd2534fa76b559514539d1a95552be78a7ae08f7e6bdfab98d6020042609a9989ce555bc99d02358a11b0ce043fad17e6e07af803c35b78f61e6f4b64e484827a5c71e9dd98d09f5455a92390c172dcc029b82af90657ae804a313b8264a85322028f48ff4f923cb963f581237119899fe3160045f94c54e848e6d23ed4bc8d65917f202c6d1ebdee813b1f2621ba1ac49d608faf049d27d1b9982e118d6b548a47b6c46dfef9bf9fc463c876cfe0be9a71f4e2653547cdadaefb410b7160bacaa7758ff89b597900f9da7010a3b25a46c8dda0d418a54e02601a3236687d6f783776f5ddf59b3f911e93e1c1a0165bad04210bff90cce93b17e300ba0160aa35e6d1292c525adfe938aad3530489377c13bf173e55a0c6987d69aca480abb52b5094715ae016986b80c2f9b0d7ac61a9b3634dbb583f7e5ed907c55d29b52214d310abbae1a115da470cf755b00e7961fb7a43816f7237bb91714f53f4ff06d16d96ad7792f6699a94c4076f37b3c039ca8266561fba3cf07f3033ab8b7be1c9b7b7ddc977db7837ee4656159fff8232058f216f700921eb81cc90834c5ffc8fd8d808d5db85a0434958f8203f7dcda396d1eef831cbeb86238dc1872f06e63f4f9066e6e9586c578e104328c8c2dd1e8b50bf4da613fbbc64b90559ea30dd91918658e2483a526bc147ef00433ccb4044e35d796dcac4e0ac82a5869e336d5c985a1f1f739528a2915c904b7e0b936f2e1082b3156756b1ccad1c64a1b602bdbea6ac2c4df893248d0e44846273999ed2113a9133d0254a38375c7296b600d14f09bddea3a76974833c652691574f7e17091d6597648529b56c4d0bae5703416416aab93e4690b3d5a3196c37c770b95a2d3ba4763d0613ba6c577c1765b2ee9830644cbd75dd4bcab2b08efefc156c5d9e11ff5fc803e98fb595a43d9b4e103c6fd41fddb6c209e04ee9f708fe38cf922abe5a675eb2c163b9a31f244822ccd46e0ab655f9563908b654ba64fc13bf7b0f65162dc7e78bb4a6351f02024a2dea523c692350fe44c9acf5aadc2df8dfeab7030cb362ac3990d71ae56a10d12d17a241559ed6ef8a7cbe4276a55ae4ef11ad95b2ff460dc075ed7ee31ac9cc3cd46daf1f8efdbf1b4534cb02b3cabadc6e88b3194747a433459933bfd51ec692f5070f6939a99778e1f047a6ae7a1a4450d5ba818f3ae7a0470e2e577775f470bb5c4490c41cf629abb25c5f5b5b9e4eaf33fb9cfee51f3bf654ff4c770391ed03efab4db3e3e539ead3634b345d791066e45b0923a7d52d1a438ad3d2f990e72fe316dcd715f3c2ca15439b4a2086ec4cdd2a3e87f530362e32c388c95057bf214cdb3e6dcc996c78fc11914dfbe6aa245785aaa5d238176dfb7772a1b44520ffb784b01bf6ddd886bb89832a1734336b378162d2090276ab9fc1e30e43ccdfeb1afe4442055d0061d92f5a57c02615956e373ff56aa6953f2b297127b290431fcb0766855484cba174510c07a7f543c8b21948047a7d31cda02b4464b393e69eb32f1d266d1e27ce1c2b212c3382eaf6ea65e3d86fbf543fb6759596699c397b28ab8c1ec6fd07b8b05224df6953ecc08ea0a04c7f26373358c6615bd0c71b56ad29675373f5d71a2106b0cfebc33b3dde96c88d6b13668f0d010869581657aa687d802be5d161da66b26be7fb85afbc42fb1f17eeaab302436fcf1b469ae4762a75289c3cf250d83cf960accebd3e45903a2266f01bf18cbed553f7c737b6f616e6dad37fa7471beab5237ea9189b11a1ece73a33282d34d2124fca02a5362a5fc0ff7a3c6f2d2c776ab26dd10b0eb4638d7ed472cb69e102f7e4b94600e6defed099d01368ee99c7da3fcb3c170299e1c075106d6cf2edec3a5e0ab7c9812214bf5b1ba0816bc6840c45d0a26f99f757233539ce1f621843c46fdb9542ca38e3f89fd80461b6664eb6c90104b2028947e453fec8da7fd9ec8a7fb038bf0ad920b56102d567d2aa598b2cf974727320867fe7769ae795603f4cf43b6139878ca699c86acf4e16a79d7c216e2d010f0a5ee082cf2fdb0c9b7ab76b0be121b4385f53d8d692532f358145aac63e35041c72aa5ab8d7dadfbd4a3ba587120c1dc22dfe5ccb0781fa65e8bee076f6baf24454ffa6fb313d5ea0df26b7c9f9a673a2c00095dd61b0a621b34bc574a1a6be441b6d415a07c111572c74b994e2f6c62e6d6b02dba59d25e240c34828aa1581e5862177a61c57f97cc061c255b1a3ca41341b420c02b8f0518a1ddbe9d27ed81859e79f6a8ff5466ec731046996cae567314d0a3b8aff853bdd4336d879f6550c9da9b8889ea64d299c9ee95afce9c4513f8afb635cf94c69c1c46916b1d0b5e01c055d0aa1b043785791ce19c45f32dd606c86487c3051266956aadae39e8131d2453f1043e391a37b80ab32570c3fa1450d1ef68ab05b4f4a93ddc87767820ebc551c93ccdc2d72e5b5d0907c92dfccadf22e712f4e450fb1874d1947bcd7547fa540060f34e83abe87a62faa62ced51f7b049287be95a018254b9119b37fe34b68f7e00a91bd105edada7ee113ee7bf3651381a728298bdb6727ed4e0283514e55a4aade5bb1d49182c25dd03163f378b5f27a6302f626e7831898178ec1476bd71a217620d9c2d859800c2561b8b15f8a6eb78151d1d1302e4bf86412c4b7ffaf7749648ce257a81b65f0b8afdc1b500a32cf5f879318d22507b759d1cf07930be06fe05c78d59be31a781696b8dcbb38f7aac65841668b794ee1b34a8146797e3ca13c40e9c941df818c184b54f1cc55d37e8dfe1ce4827aa4398e90d559f273fa21338d3a31dffffabe7cbae2b4ce82d2789ff459d787eb84d6040edd81a1977677651ccd4080ba92e3fafd208c3d718855ba5667bc95384ff69b23ad88dc79d26d08c638e9baa1ce798ec1efa474774e0a1994bf726f092f34cfc35d6dcf06f0489871cc1e2265727f237a9ddd1f2edc8b2bb3e5ef332e39e04d6c51824f454c1f2332c0ef56ea00be776fcc7026db260896ea02a69d1e523d5309c211d15d4b46849231ef84a1a5621fbc9a46fd475bbc61ffad955b83fdf1fab45b408ae16b2b22cbb649bfb2cb00732d3efdb8615e89097b5342c59f96f052ac4f41887fc70bd6e8315d610ca0c0e8092ffbd981cc8b256f2f24b7968e5dd97c48dc77859e97caa987f2901d56ba0914562594ba5fcb36e34397c6b7da2c751dfa8d30420503fc4338682c51f1183fcf1595320544e109358cf9e96b23f30c6f3a14262fb06224a4c88c3474f0e5e25defb592d6459b455dee2d4eb497ccd0adf7b4174c25b23bb7dd4354e8060c56c6e84bd2d15a80fdcef79c6b853f59f2e42df7965a2d6ce2b7719369d928383dba58bf58d0aaf58dbb070f9f0bf4f635243d5494bcdab7c0c01b64c21fe58b2ac813d80feee5d88b4a93ad9e41770708fd28280b4c52cd1a8206e4f2b6714f2334ce7e7267787a23c1fc893ad059c528b11186749299590129788b86df235337ce363a47fcaa7b93c567a89dd09a20057d4d467a1497043a9d78d60b3094feef792292c0d5593a359879ed80043e03c4aabdada6817180cb0b254f9a76813d0773865b8d542f6bfd5406842ab97d7604e62dab56bc025454787bb9691459fc4b7062c5f4d023ec33b816110ef2936e516eaa8b244426874095d9c765bb8546d2793868428f955acc4613da07527b9aee2b26544487ead324f1f1505697ab7ee8ead352518dd3c0e18476c4d850842f4d7c67d9d3358e660605f34090a463ee9df48b91991de07464cf5ecc28197d2fcb715ffdbf8ac2c8295cc92a178b8e502ff14c0703372fdd6852780e7476bc1cf138252df7b9cb13b3f3922ebb788b6eb59b8da4c670ff51f6d60be3d5759b99ac1ffd6d6e0f01ffe3a25189d041e604fe14a7bfb8b9fb74728ec70dd4608123a50a607cb88948e7e37ce1b507c8cd2104bdb721198d260b75dddf5a3df41f782c9ffe7fd58e8755acacbdcbffd3ec6dadf0dc30fa1f53ff814b519387ac002b1a942e6d0d2b6dce771ceb6c8641bfb76e00b6c517a7d632328cf65f18bed84818c929c2b04562305ec34cdd993b6da05dc6c3649d071ec92effd108fe8b36d3c39f5cdb90c6069b773450fae404d20abbba24acf8d02ae7d5cdb766cba8c05ae4e8c2a3cd7efc13abbfc549930b256153747501ebeaf2d0936c03311926f80ba18aac4502fc9155a661bb0ae5465be226225c843da4322371f1d7ddeb79e48507e7efa5d4fed474e5e018dbb2e86216446264dd741af92618ee71f8dfe7bc1a49682044205200b89476de0838a165e9a77b16700ec58392d3614789896a89423ba1c6abd56ed7f23863625d16e4adf79f9788df156217de7ad5f51c5ee55587fc7189b70442630b390a3c960f1de054a751755e8518b26169da7b01e9beaff8984022c9ee8d69999d34e1e20f87625e7ed67df5f4216d88e38560f7b355b2686206aaca93c635e2ebad1c53041d12753370a6ce00a1a81f61832e05ed288720fabec31de779cfbe7a418f2bbc124c638569cbbfeee01480d382ca0abc9e8ab0a87e6afa948ec6fc04530ff8c853ef8d09f1e501be3046231293a538886b42529e80bb8ab7a90dbf9817516421882ab86d2001d43a406073bafcdf643fa852d2361ac67c3581db2673cad2a98d0d8ed063892a3816dfade19ef4a4c94e817e38cffd35fc9bf8246cc353f7971e720e6c0f317f3a8aa765d900c036a91108d585b1eef478aa252d76a2d881452d9871fbe102114a73080e4b07fc55db143c0a82b4ec63a49db9d7e4c3af9c98ae5eeefb51ac0c18e2277948f900f95178f6687b7cb78ef3a2b3f682a55a843d878f89efc31eb964c24815272a0db4b6ac419dff7cf7ded16513f7c5586d7ada290ecaa3abcc69ee00ca9971162f517b010e113c8a69626f17c14227feeb6e72a6287bcfe715cef925d053faddbe608407066164be68aed9de26de4236b1efe8bc0f91fdfa1141da202c59cf219b8c43cbce3404a0e5db16d98e3aed1debf29fd8caaf8a5f686fe3fd8fcd744a8d32611a37fe0f21dc4206e3dd9792e90126dce3901e02acf5dc6038ea596f209b841cbb99cc7cd85e1fa0153843264183369bfe9f387e7bbfcfda8ba0e2909db0fadcf175f1c5936f98ff696412319ccc922c01577b1c0144e0fab01f350db3fea79a0e789e218f782276abdd82f43a559960b732a73e40863b564fa6e05efd65b954dc25e61c9dd320ab14a1f83eba5b06adfa97ff01724f234caa56e1910cc9d08e7d0b00be2b517176906fa291d2447396cafae8aa775151f41d6e066b4d9b78162f1cdf74b9fb1547459742e3adbfee9a8c13cb868d3da271142b5bfe85ea85f707dcf3bc0ec56149f8821fa3d9314500d6bec6142f710b0c7d2f5071d2ba9f982ab52330f06e56a1f74e7254049a9b404aaed74804a7cfe78b0f35d5fb249bb20372d0ba09a8061cac3742d0f3d87b0cb6046932ca245404f0a70745b0cc7176a4d733e9d4b7bea05c2a0b11a726f66255bae22f08494c8a67b48e8c441a02374af99e278e87a43373c1344d916bbe96a9a2938188e147a5364e7fe52dce29d5c0e3db49feac5141cabac4369a2e09b844db7083d13ce6156951af2cb2f8633e8fe8319d9bad0a54317326e532412a08ecd2db0307854ceef5769f23c00618cea0f1df7d6c419ee2982523b734c467987e011bcc7ee52df7aa1cd7d106beb5cdaeacc89f64cb95d666bd2199dec9c6c712614da50dcc66128ed669699beb41e0af614234cdb455dc0a35e7d059e66b9c4e215d9a0ee2279d94b3ceaecba47ffc867ed98b445b0119963cfd11515e991454ff0ebd72d2ddce4c0a78d3a3de7ffe67a110ed880b339f24178621c2044c6845d797a4111d708c7a535761fe8638363cdad33d5508f21c451b6134d0546dbe7ab5b5c0eb922faae32004ab3d54060d9b47fd9adf9a07b58980c9ef4cab7f0fb12221bb61f26b38ed4ffd25752603f5482260f75965a7a4ecc569f83184c17ba995bbbce2ba204b0ffdb6a8abc92a8f877f8bf931a1e6d579447e67e28eced98ff7cf75b010aba947c3236dbe6b3470941321d9f408893449350818de26a5f923513dea033b58248669730b464986b3c172a4e36f75622515cd6c2d442102ff1cf8dcf7268e5f35d556779564c1ef713f42f61a001004f4ba483f81fb93ecaade02645e0515b0456176fb65d9fd863719bef6d197725b8e8dcce7846425b629b5b02db79e134361fb90d9afdfd48fb25d4eb4900d79a2859c4f280c620e15c2df17533470a693ff1db9994e7b75616a99fbade56476e290ffc70bb452a50fe338b020af632e48026ad67d194d004ef9292ee439168592cbbd392a59b516031a981c9c8603cec0c460b6e9cebbd061442d48219a188f610e54ed842ddda02e47b7381ad5873b31725cede3fada633030c7184aaf27ba8e3ce4eac916c1bc8dec325649ab3c9c35ee5d7c3ae9dbd982a9dfa79b2435782317ebbc4ec0cf69194a4e4bc5265457731a8ce9f522f465bb4ffd9fd80443db9bd8168755d85f371939716a13ea9f6413036c80653cf0b62a71fc873e6488c7faa569b1afbe1daba1ce7de2f06a3582e7323b6014fb915850900bde10ce3c8566cb5adb539a21768c709b2164ee127e8745ecc4ac062f78870261f45e5b2dc95e79af6f50cc3894382eed8abf28aeecda7f0c8f1f6cdc823f0013cc90c902a8d6f34f677c4c715d0ca4c49f595efd99c184375eb3efa9535e02a69c0ceefd3b334766814891ae17cd4310520de9282279e94fdcca5cd79beb78c1fc06011b4114c2298efb0a046bcb0121fa9a6c62e8308ce79ab38b444c10e98256182ab534f5219aa80c944f4b433dcefcface2c6f035377158545fc6b918630003884cc1c77a4f63b5009563e2e804d497277ee712d9c9f9bdaca3067d9d17b723cd8525230208dd67462b0efbe40aef6f1f17edf02b399c903fd17a91b662481461f95e4c34f02b05d1b7f8e9bee5e4ef6701fbf7825854cba901f8b3239444a710a3053a9e08b035aff3fba24ecc8f1658cb60da79cf403bce640e6d8890dd2a8fa38ebc8b959602001f47ecf925756fb884ae4bc17e40032900753544e3fbae5422d7dc673fca48af0370a557fc05cb00075e36de5081d724a3f4bffff2abe17156ee79969bbec3d6a8aa991e3331148096e2e3ee30f1a7541395a708e7374db037e051c30cc21fd58e70f18f550816304678e39d6f106fb0cd2e6aefcc3526c14c6cec930da356a68c9a1be94c84733d9736b738654f7b680cd1d36c6f36711d0f924e92fb7d204ab16398148f39ed8724fe39a97f354a78d3b0c24ad25be683841d1c1f2847f1f0b8907a6c5046e08e81586ea9ca97950b2f525ed491f7334ce2ec30c26ebae230ae7327d3b71c996634769661e6c0d95ec385726722d5b3c1a0ac1bd091b441546d6877d8ff78acdf54c822514a36854d6f7c5e630fe623e20895b42464fe5ec19ae6e5c0f583e0fe3b5f89839f73659aa29183f49d6c51d2b5b242fec3bcd10404ecf04f6ce49597df1d88b11fcaed8c0b96df0b8a574b11f19d9145923015fe1af4c3a26eb3bb2d8ef0e040ae3587a2c64769d5dac4e90f905ba5a041f59f99da1b0c48b87c0c859eb6acdf2c00a83080800d92d102ebba4a900a693c2acdc41f6c6fe1cfbc4113eb0b00813161ecaf2e30fefaf3bc57ddeb75a0fdb7f68f5e84a2486d3921a16d54fc64de5597795cbf7f2e48e4f3d732e32de0658f3befebdc31becce48d9be5f70d63cb9b0009daf9e8cdf8e8a4fad0fc6b25630818a7dd148d0d19bfb42ceaf45d12ba4b89d98a513e0581993fdf6a1305caae17110d653d515aebd37434a8ada3d00963c4029c464dbded7ff8989d81564c0ac4a72b79cc2bc76a2b22b64c41a2f79df99dc76a88db8223e49668ed65c4998a3ce2ce95e5c866a78b7c6ad7c163c0de48e1cd9795a9f4d2834d63b22d017b2ef21e22ac3f5e1d9587b5747c5f6c949032a90e4e127ef1e44e848339673ad823088a05f6e5a13dd94486bdee6f898306abb1f4932ddac88e2e5bd216f2341628c2d02310431f97ca6e51494efad8d3da387cdc1d8adeae6100ebd5975333343eb60b22bb551ce1557af98cdceb6a51b3344a938725badad87d9b3d280cc16e3d30b7ca57f102144a40a881854bfc69bd72ef247d06014c99017f3ff7ccf1683abc5444cc90b5c4a263035f21924f7cf2a9f810dded7f7860ba294d76403b932b2b2ef74d8ebd219a344c7a45a68b5f04a915933844b44e20371b89cabe87864fdc747b305397cc9e45982e0f486f39ea6df0dbd26d6ec2d189f62ca567641eb","isRememberEnabled":true,"rememberDurationInDays":0,"staticryptSaltUniqueVariableName":"4290edf5ab9c348d0d7d0b9e329b1e38"};

            // you can edit these values to customize some of the behavior of StatiCrypt
            const templateConfig = {
                rememberExpirationKey: "staticrypt_expiration",
                rememberPassphraseKey: "staticrypt_passphrase",
                replaceHtmlCallback: null,
                clearLocalStorageCallback: null,
            };

            // init the staticrypt engine
            const staticrypt = staticryptInitiator.init(staticryptConfig, templateConfig);

            // try to automatically decrypt on load if there is a saved password
            window.onload = async function () {
                const { isSuccessful } = await staticrypt.handleDecryptOnLoad();

                // if we didn't decrypt anything on load, show the password prompt. Otherwise the content has already been
                // replaced, no need to do anything
                if (!isSuccessful) {
                    // hide loading screen
                    document.getElementById("staticrypt_loading").classList.add("hidden");
                    document.getElementById("staticrypt_content").classList.remove("hidden");
                    document.getElementById("staticrypt-password").focus();

                    // show the remember me checkbox
                    if (isRememberEnabled) {
                        document.getElementById("staticrypt-remember-label").classList.remove("hidden");
                    }
                }
            };

            // toggle password visibility
            const toggleIcon = document.querySelector(".staticrypt-toggle-password-visibility");
            // these two icons are coming from FontAwesome
            const imgSrcEyeClosed =
                "data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA2NDAgNTEyIj48IS0tIUZvbnQgQXdlc29tZSBGcmVlIDYuNS4yIGJ5IEBmb250YXdlc29tZSAtIGh0dHBzOi8vZm9udGF3ZXNvbWUuY29tIExpY2Vuc2UgLSBodHRwczovL2ZvbnRhd2Vzb21lLmNvbS9saWNlbnNlL2ZyZWUgQ29weXJpZ2h0IDIwMjQgRm9udGljb25zLCBJbmMuLS0+PHBhdGggZD0iTTM4LjggNS4xQzI4LjQtMy4xIDEzLjMtMS4yIDUuMSA5LjJTLTEuMiAzNC43IDkuMiA0Mi45bDU5MiA0NjRjMTAuNCA4LjIgMjUuNSA2LjMgMzMuNy00LjFzNi4zLTI1LjUtNC4xLTMzLjdMNTI1LjYgMzg2LjdjMzkuNi00MC42IDY2LjQtODYuMSA3OS45LTExOC40YzMuMy03LjkgMy4zLTE2LjcgMC0yNC42Yy0xNC45LTM1LjctNDYuMi04Ny43LTkzLTEzMS4xQzQ2NS41IDY4LjggNDAwLjggMzIgMzIwIDMyYy02OC4yIDAtMTI1IDI2LjMtMTY5LjMgNjAuOEwzOC44IDUuMXpNMjIzLjEgMTQ5LjVDMjQ4LjYgMTI2LjIgMjgyLjcgMTEyIDMyMCAxMTJjNzkuNSAwIDE0NCA2NC41IDE0NCAxNDRjMCAyNC45LTYuMyA0OC4zLTE3LjQgNjguN0w0MDggMjk0LjVjOC40LTE5LjMgMTAuNi00MS40IDQuOC02My4zYy0xMS4xLTQxLjUtNDcuOC02OS40LTg4LjYtNzEuMWMtNS44LS4yLTkuMiA2LjEtNy40IDExLjdjMi4xIDYuNCAzLjMgMTMuMiAzLjMgMjAuM2MwIDEwLjItMi40IDE5LjgtNi42IDI4LjNsLTkwLjMtNzAuOHpNMzczIDM4OS45Yy0xNi40IDYuNS0zNC4zIDEwLjEtNTMgMTAuMWMtNzkuNSAwLTE0NC02NC41LTE0NC0xNDRjMC02LjkgLjUtMTMuNiAxLjQtMjAuMkw4My4xIDE2MS41QzYwLjMgMTkxLjIgNDQgMjIwLjggMzQuNSAyNDMuN2MtMy4zIDcuOS0zLjMgMTYuNyAwIDI0LjZjMTQuOSAzNS43IDQ2LjIgODcuNyA5MyAxMzEuMUMxNzQuNSA0NDMuMiAyMzkuMiA0ODAgMzIwIDQ4MGM0Ny44IDAgODkuOS0xMi45IDEyNi4yLTMyLjVMMzczIDM4OS45eiIvPjwvc3ZnPg==";
            const imgSrcEyeOpened =
                "data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA1NzYgNTEyIj48IS0tIUZvbnQgQXdlc29tZSBGcmVlIDYuNS4yIGJ5IEBmb250YXdlc29tZSAtIGh0dHBzOi8vZm9udGF3ZXNvbWUuY29tIExpY2Vuc2UgLSBodHRwczovL2ZvbnRhd2Vzb21lLmNvbS9saWNlbnNlL2ZyZWUgQ29weXJpZ2h0IDIwMjQgRm9udGljb25zLCBJbmMuLS0+PHBhdGggZD0iTTI4OCAzMmMtODAuOCAwLTE0NS41IDM2LjgtMTkyLjYgODAuNkM0OC42IDE1NiAxNy4zIDIwOCAyLjUgMjQzLjdjLTMuMyA3LjktMy4zIDE2LjcgMCAyNC42QzE3LjMgMzA0IDQ4LjYgMzU2IDk1LjQgMzk5LjRDMTQyLjUgNDQzLjIgMjA3LjIgNDgwIDI4OCA0ODBzMTQ1LjUtMzYuOCAxOTIuNi04MC42YzQ2LjgtNDMuNSA3OC4xLTk1LjQgOTMtMTMxLjFjMy4zLTcuOSAzLjMtMTYuNyAwLTI0LjZjLTE0LjktMzUuNy00Ni4yLTg3LjctOTMtMTMxLjFDNDMzLjUgNjguOCAzNjguOCAzMiAyODggMzJ6TTE0NCAyNTZhMTQ0IDE0NCAwIDEgMSAyODggMCAxNDQgMTQ0IDAgMSAxIC0yODggMHptMTQ0LTY0YzAgMzUuMy0yOC43IDY0LTY0IDY0Yy03LjEgMC0xMy45LTEuMi0yMC4zLTMuM2MtNS41LTEuOC0xMS45IDEuNi0xMS43IDcuNGMuMyA2LjkgMS4zIDEzLjggMy4yIDIwLjdjMTMuNyA1MS4yIDY2LjQgODEuNiAxMTcuNiA2Ny45czgxLjYtNjYuNCA2Ny45LTExNy42Yy0xMS4xLTQxLjUtNDcuOC02OS40LTg4LjYtNzEuMWMtNS44LS4yLTkuMiA2LjEtNy40IDExLjdjMi4xIDYuNCAzLjMgMTMuMiAzLjMgMjAuM3oiLz48L3N2Zz4=";
            toggleIcon.addEventListener("click", function () {
                const passwordInput = document.getElementById("staticrypt-password");
                if (passwordInput.type === "password") {
                    passwordInput.type = "text";
                    toggleIcon.src = imgSrcEyeOpened;
                    toggleIcon.alt = templateToggleAltHide;
                    toggleIcon.title = templateToggleAltHide;
                } else {
                    passwordInput.type = "password";
                    toggleIcon.src = imgSrcEyeClosed;
                    toggleIcon.alt = templateToggleAltShow;
                    toggleIcon.title = templateToggleAltShow;
                }
            });

            // handle password form submission
            document.getElementById("staticrypt-form").addEventListener("submit", async function (e) {
                e.preventDefault();

                const password = document.getElementById("staticrypt-password").value,
                    isRememberChecked = document.getElementById("staticrypt-remember").checked;

                const { isSuccessful } = await staticrypt.handleDecryptionOfPage(password, isRememberChecked);

                if (!isSuccessful) {
                    alert(templateError);
                }
            });
        </script>
    </body>
</html>
