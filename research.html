<!DOCTYPE html>
<html class="staticrypt-html">
    <head>
        <meta charset="utf-8" />
        <title>Private preview</title>
        <meta name="viewport" content="width=device-width, initial-scale=1" />

        <!-- do not cache this page -->
        <meta http-equiv="cache-control" content="max-age=0" />
        <meta http-equiv="cache-control" content="no-cache" />
        <meta http-equiv="expires" content="0" />
        <meta http-equiv="expires" content="Tue, 01 Jan 1980 1:00:00 GMT" />
        <meta http-equiv="pragma" content="no-cache" />

        <style>
            .staticrypt-hr {
                margin-top: 20px;
                margin-bottom: 20px;
                border: 0;
                border-top: 1px solid #eee;
            }

            .staticrypt-page {
                width: 360px;
                padding: 8% 0 0;
                margin: auto;
                box-sizing: border-box;
            }

            .staticrypt-form {
                position: relative;
                z-index: 1;
                background: #ffffff;
                max-width: 360px;
                margin: 0 auto 100px;
                padding: 45px;
                text-align: center;
                box-shadow: 0 0 20px 0 rgba(0, 0, 0, 0.2), 0 5px 5px 0 rgba(0, 0, 0, 0.24);
            }

            .staticrypt-form input[type="password"],
            input[type="text"] {
                background: inherit;
                border: 0;
                box-sizing: border-box; /* This ensures padding is included in the total width */
                font-size: 14px;
                outline: 0;
                padding: 15px 30px 15px 15px; /* Adjust the padding to ensure there is space for the icon */
                width: 100%;
            }

            .staticrypt-password-container {
                position: relative;
                outline: 0;
                background: #f2f2f2;
                width: 100%;
                border: 0;
                margin: 0 0 15px;
                box-sizing: border-box;
            }

            .staticrypt-toggle-password-visibility {
                cursor: pointer;
                height: 20px;
                opacity: 60%;
                padding: 13px;
                position: absolute;
                right: 0;
                top: 50%;
                transform: translateY(-50%);
                width: 20px;
            }

            .staticrypt-form .staticrypt-decrypt-button {
                text-transform: uppercase;
                outline: 0;
                background: #4CAF50;
                width: 100%;
                border: 0;
                padding: 15px;
                color: #ffffff;
                font-size: 14px;
                cursor: pointer;
            }

            .staticrypt-form .staticrypt-decrypt-button:hover,
            .staticrypt-form .staticrypt-decrypt-button:active,
            .staticrypt-form .staticrypt-decrypt-button:focus {
                background: #4CAF50;
                filter: brightness(92%);
            }

            .staticrypt-html {
                height: 100%;
            }

            .staticrypt-body {
                height: 100%;
                margin: 0;
            }

            .staticrypt-content {
                height: 100%;
                margin-bottom: 1em;
                background: #76B852;
                font-family: "Arial", sans-serif;
                -webkit-font-smoothing: antialiased;
                -moz-osx-font-smoothing: grayscale;
            }

            .staticrypt-instructions {
                margin-top: -1em;
                margin-bottom: 1em;
            }

            .staticrypt-title {
                font-size: 1.5em;
            }

            label.staticrypt-remember {
                display: flex;
                align-items: center;
                margin-bottom: 1em;
            }

            .staticrypt-remember input[type="checkbox"] {
                transform: scale(1.5);
                margin-right: 1em;
            }

            .hidden {
                display: none !important;
            }

            .staticrypt-spinner-container {
                height: 100%;
                display: flex;
                align-items: center;
                justify-content: center;
            }

            .staticrypt-spinner {
                display: inline-block;
                width: 2rem;
                height: 2rem;
                vertical-align: text-bottom;
                border: 0.25em solid gray;
                border-right-color: transparent;
                border-radius: 50%;
                -webkit-animation: spinner-border 0.75s linear infinite;
                animation: spinner-border 0.75s linear infinite;
                animation-duration: 0.75s;
                animation-timing-function: linear;
                animation-delay: 0s;
                animation-iteration-count: infinite;
                animation-direction: normal;
                animation-fill-mode: none;
                animation-play-state: running;
                animation-name: spinner-border;
            }

            @keyframes spinner-border {
                100% {
                    transform: rotate(360deg);
                }
            }

            @media screen and (-webkit-min-device-pixel-ratio: 0) {
                .staticrypt-form input[type="password"],
                input[type="text"] {
                    font-size: 16px;
                }
            }
        </style>
    </head>

    <body class="staticrypt-body">
        <div id="staticrypt_loading" class="staticrypt-spinner-container">
            <div class="staticrypt-spinner"></div>
        </div>

        <div id="staticrypt_content" class="staticrypt-content hidden">
            <div class="staticrypt-page">
                <div class="staticrypt-form">
                    <div class="staticrypt-instructions">
                        <p class="staticrypt-title">Private preview</p>
                        <p>Enter the preview password.</p>
                    </div>

                    <hr class="staticrypt-hr" />

                    <form id="staticrypt-form" action="#" method="post">
                        <div class="staticrypt-password-container">
                            <input
                                id="staticrypt-password"
                                type="password"
                                name="password"
                                placeholder="Password"
                                autofocus
                            />

                            <img
                                class="staticrypt-toggle-password-visibility"
                                alt="Show password"
                                title="Show password"
                                src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA2NDAgNTEyIj48IS0tIUZvbnQgQXdlc29tZSBGcmVlIDYuNS4yIGJ5IEBmb250YXdlc29tZSAtIGh0dHBzOi8vZm9udGF3ZXNvbWUuY29tIExpY2Vuc2UgLSBodHRwczovL2ZvbnRhd2Vzb21lLmNvbS9saWNlbnNlL2ZyZWUgQ29weXJpZ2h0IDIwMjQgRm9udGljb25zLCBJbmMuLS0+PHBhdGggZD0iTTM4LjggNS4xQzI4LjQtMy4xIDEzLjMtMS4yIDUuMSA5LjJTLTEuMiAzNC43IDkuMiA0Mi45bDU5MiA0NjRjMTAuNCA4LjIgMjUuNSA2LjMgMzMuNy00LjFzNi4zLTI1LjUtNC4xLTMzLjdMNTI1LjYgMzg2LjdjMzkuNi00MC42IDY2LjQtODYuMSA3OS45LTExOC40YzMuMy03LjkgMy4zLTE2LjcgMC0yNC42Yy0xNC45LTM1LjctNDYuMi04Ny43LTkzLTEzMS4xQzQ2NS41IDY4LjggNDAwLjggMzIgMzIwIDMyYy02OC4yIDAtMTI1IDI2LjMtMTY5LjMgNjAuOEwzOC44IDUuMXpNMjIzLjEgMTQ5LjVDMjQ4LjYgMTI2LjIgMjgyLjcgMTEyIDMyMCAxMTJjNzkuNSAwIDE0NCA2NC41IDE0NCAxNDRjMCAyNC45LTYuMyA0OC4zLTE3LjQgNjguN0w0MDggMjk0LjVjOC40LTE5LjMgMTAuNi00MS40IDQuOC02My4zYy0xMS4xLTQxLjUtNDcuOC02OS40LTg4LjYtNzEuMWMtNS44LS4yLTkuMiA2LjEtNy40IDExLjdjMi4xIDYuNCAzLjMgMTMuMiAzLjMgMjAuM2MwIDEwLjItMi40IDE5LjgtNi42IDI4LjNsLTkwLjMtNzAuOHpNMzczIDM4OS45Yy0xNi40IDYuNS0zNC4zIDEwLjEtNTMgMTAuMWMtNzkuNSAwLTE0NC02NC41LTE0NC0xNDRjMC02LjkgLjUtMTMuNiAxLjQtMjAuMkw4My4xIDE2MS41QzYwLjMgMTkxLjIgNDQgMjIwLjggMzQuNSAyNDMuN2MtMy4zIDcuOS0zLjMgMTYuNyAwIDI0LjZjMTQuOSAzNS43IDQ2LjIgODcuNyA5MyAxMzEuMUMxNzQuNSA0NDMuMiAyMzkuMiA0ODAgMzIwIDQ4MGM0Ny44IDAgODkuOS0xMi45IDEyNi4yLTMyLjVMMzczIDM4OS45eiIvPjwvc3ZnPg=="
                            />
                        </div>

                        <label id="staticrypt-remember-label" class="staticrypt-remember hidden">
                            <input id="staticrypt-remember" type="checkbox" name="remember" />
                            Remember me
                        </label>

                        <input type="submit" class="staticrypt-decrypt-button" value="DECRYPT" />
                    </form>
                </div>
            </div>
        </div>

        <script>
            // these variables will be filled when generating the file - the template format is 'variable_name'
            const staticryptInitiator = ((function(){
  const exports = {};
  const cryptoEngine = ((function(){
  const exports = {};
  const { subtle } = crypto;

const IV_BITS = 16 * 8;
const HEX_BITS = 4;
const ENCRYPTION_ALGO = "AES-CBC";

/**
 * Translates between utf8 encoded hexadecimal strings
 * and Uint8Array bytes.
 */
const HexEncoder = {
    /**
     * hex string -> bytes
     * @param {string} hexString
     * @returns {Uint8Array}
     */
    parse: function (hexString) {
        if (hexString.length % 2 !== 0) throw "Invalid hexString";
        const arrayBuffer = new Uint8Array(hexString.length / 2);

        for (let i = 0; i < hexString.length; i += 2) {
            const byteValue = parseInt(hexString.substring(i, i + 2), 16);
            if (isNaN(byteValue)) {
                throw "Invalid hexString";
            }
            arrayBuffer[i / 2] = byteValue;
        }
        return arrayBuffer;
    },

    /**
     * bytes -> hex string
     * @param {Uint8Array} bytes
     * @returns {string}
     */
    stringify: function (bytes) {
        const hexBytes = [];

        for (let i = 0; i < bytes.length; ++i) {
            let byteString = bytes[i].toString(16);
            if (byteString.length < 2) {
                byteString = "0" + byteString;
            }
            hexBytes.push(byteString);
        }
        return hexBytes.join("");
    },
};

/**
 * Translates between utf8 strings and Uint8Array bytes.
 */
const UTF8Encoder = {
    parse: function (str) {
        return new TextEncoder().encode(str);
    },

    stringify: function (bytes) {
        return new TextDecoder().decode(bytes);
    },
};

/**
 * Salt and encrypt a msg with a password.
 */
async function encrypt(msg, hashedPassword) {
    // Must be 16 bytes, unpredictable, and preferably cryptographically random. However, it need not be secret.
    // https://developer.mozilla.org/en-US/docs/Web/API/SubtleCrypto/encrypt#parameters
    const iv = crypto.getRandomValues(new Uint8Array(IV_BITS / 8));

    const key = await subtle.importKey("raw", HexEncoder.parse(hashedPassword), ENCRYPTION_ALGO, false, ["encrypt"]);

    const encrypted = await subtle.encrypt(
        {
            name: ENCRYPTION_ALGO,
            iv: iv,
        },
        key,
        UTF8Encoder.parse(msg)
    );

    // iv will be 32 hex characters, we prepend it to the ciphertext for use in decryption
    return HexEncoder.stringify(iv) + HexEncoder.stringify(new Uint8Array(encrypted));
}
exports.encrypt = encrypt;

/**
 * Decrypt a salted msg using a password.
 *
 * @param {string} encryptedMsg
 * @param {string} hashedPassword
 * @returns {Promise<string>}
 */
async function decrypt(encryptedMsg, hashedPassword) {
    const ivLength = IV_BITS / HEX_BITS;
    const iv = HexEncoder.parse(encryptedMsg.substring(0, ivLength));
    const encrypted = encryptedMsg.substring(ivLength);

    const key = await subtle.importKey("raw", HexEncoder.parse(hashedPassword), ENCRYPTION_ALGO, false, ["decrypt"]);

    const outBuffer = await subtle.decrypt(
        {
            name: ENCRYPTION_ALGO,
            iv: iv,
        },
        key,
        HexEncoder.parse(encrypted)
    );

    return UTF8Encoder.stringify(new Uint8Array(outBuffer));
}
exports.decrypt = decrypt;

/**
 * Salt and hash the password so it can be stored in localStorage without opening a password reuse vulnerability.
 *
 * @param {string} password
 * @param {string} salt
 * @returns {Promise<string>}
 */
async function hashPassword(password, salt) {
    // we hash the password in multiple steps, each adding more iterations. This is because we used to allow less
    // iterations, so for backward compatibility reasons, we need to support going from that to more iterations.
    let hashedPassword = await hashLegacyRound(password, salt);

    hashedPassword = await hashSecondRound(hashedPassword, salt);

    return hashThirdRound(hashedPassword, salt);
}
exports.hashPassword = hashPassword;

/**
 * This hashes the password with 1k iterations. This is a low number, we need this function to support backwards
 * compatibility.
 *
 * @param {string} password
 * @param {string} salt
 * @returns {Promise<string>}
 */
function hashLegacyRound(password, salt) {
    return pbkdf2(password, salt, 1000, "SHA-1");
}
exports.hashLegacyRound = hashLegacyRound;

/**
 * Add a second round of iterations. This is because we used to use 1k, so for backwards compatibility with
 * remember-me/autodecrypt links, we need to support going from that to more iterations.
 *
 * @param hashedPassword
 * @param salt
 * @returns {Promise<string>}
 */
function hashSecondRound(hashedPassword, salt) {
    return pbkdf2(hashedPassword, salt, 14000, "SHA-256");
}
exports.hashSecondRound = hashSecondRound;

/**
 * Add a third round of iterations to bring total number to 600k. This is because we used to use 1k, then 15k, so for
 * backwards compatibility with remember-me/autodecrypt links, we need to support going from that to more iterations.
 *
 * @param hashedPassword
 * @param salt
 * @returns {Promise<string>}
 */
function hashThirdRound(hashedPassword, salt) {
    return pbkdf2(hashedPassword, salt, 585000, "SHA-256");
}
exports.hashThirdRound = hashThirdRound;

/**
 * Salt and hash the password so it can be stored in localStorage without opening a password reuse vulnerability.
 *
 * @param {string} password
 * @param {string} salt
 * @param {int} iterations
 * @param {string} hashAlgorithm
 * @returns {Promise<string>}
 */
async function pbkdf2(password, salt, iterations, hashAlgorithm) {
    const key = await subtle.importKey("raw", UTF8Encoder.parse(password), "PBKDF2", false, ["deriveBits"]);

    const keyBytes = await subtle.deriveBits(
        {
            name: "PBKDF2",
            hash: hashAlgorithm,
            iterations,
            salt: UTF8Encoder.parse(salt),
        },
        key,
        256
    );

    return HexEncoder.stringify(new Uint8Array(keyBytes));
}

function generateRandomSalt() {
    const bytes = crypto.getRandomValues(new Uint8Array(128 / 8));

    return HexEncoder.stringify(new Uint8Array(bytes));
}
exports.generateRandomSalt = generateRandomSalt;

async function signMessage(hashedPassword, message) {
    const key = await subtle.importKey(
        "raw",
        HexEncoder.parse(hashedPassword),
        {
            name: "HMAC",
            hash: "SHA-256",
        },
        false,
        ["sign"]
    );
    const signature = await subtle.sign("HMAC", key, UTF8Encoder.parse(message));

    return HexEncoder.stringify(new Uint8Array(signature));
}
exports.signMessage = signMessage;

function getRandomAlphanum() {
    const possibleCharacters = "abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789";

    let byteArray;
    let parsedInt;

    // Keep generating new random bytes until we get a value that falls
    // within a range that can be evenly divided by possibleCharacters.length
    do {
        byteArray = crypto.getRandomValues(new Uint8Array(1));
        // extract the lowest byte to get an int from 0 to 255 (probably unnecessary, since we're only generating 1 byte)
        parsedInt = byteArray[0] & 0xff;
    } while (parsedInt >= 256 - (256 % possibleCharacters.length));

    // Take the modulo of the parsed integer to get a random number between 0 and totalLength - 1
    const randomIndex = parsedInt % possibleCharacters.length;

    return possibleCharacters[randomIndex];
}

/**
 * Generate a random string of a given length.
 *
 * @param {int} length
 * @returns {string}
 */
function generateRandomString(length) {
    let randomString = "";

    for (let i = 0; i < length; i++) {
        randomString += getRandomAlphanum();
    }

    return randomString;
}
exports.generateRandomString = generateRandomString;

  return exports;
})());
const codec = ((function(){
  const exports = {};
  /**
 * Initialize the codec with the provided cryptoEngine - this return functions to encode and decode messages.
 *
 * @param cryptoEngine - the engine to use for encryption / decryption
 */
function init(cryptoEngine) {
    const exports = {};

    /**
     * Top-level function for encoding a message.
     * Includes password hashing, encryption, and signing.
     *
     * @param {string} msg
     * @param {string} password
     * @param {string} salt
     *
     * @returns {string} The encoded text
     */
    async function encode(msg, password, salt) {
        const hashedPassword = await cryptoEngine.hashPassword(password, salt);

        const encrypted = await cryptoEngine.encrypt(msg, hashedPassword);

        // we use the hashed password in the HMAC because this is effectively what will be used a password (so we can store
        // it in localStorage safely, we don't use the clear text password)
        const hmac = await cryptoEngine.signMessage(hashedPassword, encrypted);

        return hmac + encrypted;
    }
    exports.encode = encode;

    /**
     * Encode using a password that has already been hashed. This is useful to encode multiple messages in a row, that way
     * we don't need to hash the password multiple times.
     *
     * @param {string} msg
     * @param {string} hashedPassword
     *
     * @returns {string} The encoded text
     */
    async function encodeWithHashedPassword(msg, hashedPassword) {
        const encrypted = await cryptoEngine.encrypt(msg, hashedPassword);

        // we use the hashed password in the HMAC because this is effectively what will be used a password (so we can store
        // it in localStorage safely, we don't use the clear text password)
        const hmac = await cryptoEngine.signMessage(hashedPassword, encrypted);

        return hmac + encrypted;
    }
    exports.encodeWithHashedPassword = encodeWithHashedPassword;

    /**
     * Top-level function for decoding a message.
     * Includes signature check and decryption.
     *
     * @param {string} signedMsg
     * @param {string} hashedPassword
     * @param {string} salt
     * @param {int} backwardCompatibleAttempt
     * @param {string} originalPassword
     *
     * @returns {Object} {success: true, decoded: string} | {success: false, message: string}
     */
    async function decode(signedMsg, hashedPassword, salt, backwardCompatibleAttempt = 0, originalPassword = "") {
        const encryptedHMAC = signedMsg.substring(0, 64);
        const encryptedMsg = signedMsg.substring(64);
        const decryptedHMAC = await cryptoEngine.signMessage(hashedPassword, encryptedMsg);

        if (decryptedHMAC !== encryptedHMAC) {
            // we have been raising the number of iterations in the hashing algorithm multiple times, so to support the old
            // remember-me/autodecrypt links we need to try bringing the old hashes up to speed.
            originalPassword = originalPassword || hashedPassword;
            if (backwardCompatibleAttempt === 0) {
                const updatedHashedPassword = await cryptoEngine.hashThirdRound(originalPassword, salt);

                return decode(signedMsg, updatedHashedPassword, salt, backwardCompatibleAttempt + 1, originalPassword);
            }
            if (backwardCompatibleAttempt === 1) {
                let updatedHashedPassword = await cryptoEngine.hashSecondRound(originalPassword, salt);
                updatedHashedPassword = await cryptoEngine.hashThirdRound(updatedHashedPassword, salt);

                return decode(signedMsg, updatedHashedPassword, salt, backwardCompatibleAttempt + 1, originalPassword);
            }

            return { success: false, message: "Signature mismatch" };
        }

        return {
            success: true,
            decoded: await cryptoEngine.decrypt(encryptedMsg, hashedPassword),
        };
    }
    exports.decode = decode;

    return exports;
}
exports.init = init;

  return exports;
})());
const decode = codec.init(cryptoEngine).decode;

/**
 * Initialize the staticrypt module, that exposes functions callbable by the password_template.
 *
 * @param {{
 *  staticryptEncryptedMsgUniqueVariableName: string,
 *  isRememberEnabled: boolean,
 *  rememberDurationInDays: number,
 *  staticryptSaltUniqueVariableName: string,
 * }} staticryptConfig - object of data that is stored on the password_template at encryption time.
 *
 * @param {{
 *  rememberExpirationKey: string,
 *  rememberPassphraseKey: string,
 *  replaceHtmlCallback: function,
 *  clearLocalStorageCallback: function,
 * }} templateConfig - object of data that can be configured by a custom password_template.
 */
function init(staticryptConfig, templateConfig) {
    const exports = {};

    /**
     * Decrypt our encrypted page, replace the whole HTML.
     *
     * @param {string} hashedPassword
     * @returns {Promise<boolean>}
     */
    async function decryptAndReplaceHtml(hashedPassword) {
        const { staticryptEncryptedMsgUniqueVariableName, staticryptSaltUniqueVariableName } = staticryptConfig;
        const { replaceHtmlCallback } = templateConfig;

        const result = await decode(
            staticryptEncryptedMsgUniqueVariableName,
            hashedPassword,
            staticryptSaltUniqueVariableName
        );
        if (!result.success) {
            return false;
        }
        const plainHTML = result.decoded;

        // if the user configured a callback call it, otherwise just replace the whole HTML
        if (typeof replaceHtmlCallback === "function") {
            replaceHtmlCallback(plainHTML);
        } else {
            document.write(plainHTML);
            document.close();
        }

        return true;
    }

    /**
     * Attempt to decrypt the page and replace the whole HTML.
     *
     * @param {string} password
     * @param {boolean} isRememberChecked
     *
     * @returns {Promise<{isSuccessful: boolean, hashedPassword?: string}>} - we return an object, so that if we want to
     *   expose more information in the future we can do it without breaking the password_template
     */
    async function handleDecryptionOfPage(password, isRememberChecked) {
        const { staticryptSaltUniqueVariableName } = staticryptConfig;

        // decrypt and replace the whole page
        const hashedPassword = await cryptoEngine.hashPassword(password, staticryptSaltUniqueVariableName);
        return handleDecryptionOfPageFromHash(hashedPassword, isRememberChecked);
    }
    exports.handleDecryptionOfPage = handleDecryptionOfPage;

    async function handleDecryptionOfPageFromHash(hashedPassword, isRememberChecked) {
        const { isRememberEnabled, rememberDurationInDays } = staticryptConfig;
        const { rememberExpirationKey, rememberPassphraseKey } = templateConfig;

        const isDecryptionSuccessful = await decryptAndReplaceHtml(hashedPassword);

        if (!isDecryptionSuccessful) {
            return {
                isSuccessful: false,
                hashedPassword,
            };
        }

        // remember the hashedPassword and set its expiration if necessary
        if (isRememberEnabled && isRememberChecked) {
            window.localStorage.setItem(rememberPassphraseKey, hashedPassword);

            // set the expiration if the duration isn't 0 (meaning no expiration)
            if (rememberDurationInDays > 0) {
                window.localStorage.setItem(
                    rememberExpirationKey,
                    (new Date().getTime() + rememberDurationInDays * 24 * 60 * 60 * 1000).toString()
                );
            }
        }

        return {
            isSuccessful: true,
            hashedPassword,
        };
    }
    exports.handleDecryptionOfPageFromHash = handleDecryptionOfPageFromHash;

    /**
     * Clear localstorage from staticrypt related values
     */
    function clearLocalStorage() {
        const { clearLocalStorageCallback, rememberExpirationKey, rememberPassphraseKey } = templateConfig;

        if (typeof clearLocalStorageCallback === "function") {
            clearLocalStorageCallback();
        } else {
            localStorage.removeItem(rememberPassphraseKey);
            localStorage.removeItem(rememberExpirationKey);
        }
    }

    async function handleDecryptOnLoad() {
        let isSuccessful = await decryptOnLoadFromUrl();

        if (!isSuccessful) {
            isSuccessful = await decryptOnLoadFromRememberMe();
        }

        return { isSuccessful };
    }
    exports.handleDecryptOnLoad = handleDecryptOnLoad;

    /**
     * Clear storage if we are logging out
     *
     * @returns {boolean} - whether we logged out
     */
    function logoutIfNeeded() {
        const logoutKey = "staticrypt_logout";

        // handle logout through query param
        const queryParams = new URLSearchParams(window.location.search);
        if (queryParams.has(logoutKey)) {
            clearLocalStorage();
            return true;
        }

        // handle logout through URL fragment
        const hash = window.location.hash.substring(1);
        if (hash.includes(logoutKey)) {
            clearLocalStorage();
            return true;
        }

        return false;
    }

    /**
     * To be called on load: check if we want to try to decrypt and replace the HTML with the decrypted content, and
     * try to do it if needed.
     *
     * @returns {Promise<boolean>} true if we derypted and replaced the whole page, false otherwise
     */
    async function decryptOnLoadFromRememberMe() {
        const { rememberDurationInDays } = staticryptConfig;
        const { rememberExpirationKey, rememberPassphraseKey } = templateConfig;

        // if we are login out, terminate
        if (logoutIfNeeded()) {
            return false;
        }

        // if there is expiration configured, check if we're not beyond the expiration
        if (rememberDurationInDays && rememberDurationInDays > 0) {
            const expiration = localStorage.getItem(rememberExpirationKey),
                isExpired = expiration && new Date().getTime() > parseInt(expiration);

            if (isExpired) {
                clearLocalStorage();
                return false;
            }
        }

        const hashedPassword = localStorage.getItem(rememberPassphraseKey);

        if (hashedPassword) {
            // try to decrypt
            const isDecryptionSuccessful = await decryptAndReplaceHtml(hashedPassword);

            // if the decryption is unsuccessful the password might be wrong - silently clear the saved data and let
            // the user fill the password form again
            if (!isDecryptionSuccessful) {
                clearLocalStorage();
                return false;
            }

            return true;
        }

        return false;
    }

    async function decryptOnLoadFromUrl() {
        const passwordKey = "staticrypt_pwd";
        const rememberMeKey = "remember_me";

        // try to get the password from the query param (for backward compatibility - we now want to avoid this method,
        // since it sends the hashed password to the server which isn't needed)
        const queryParams = new URLSearchParams(window.location.search);
        const hashedPasswordQuery = queryParams.get(passwordKey);
        const rememberMeQuery = queryParams.get(rememberMeKey);

        const urlFragment = window.location.hash.substring(1);
        // get the password from the url fragment
        const hashedPasswordRegexMatch = urlFragment.match(new RegExp(passwordKey + "=([^&]*)"));
        const hashedPasswordFragment = hashedPasswordRegexMatch ? hashedPasswordRegexMatch[1] : null;
        const rememberMeFragment = urlFragment.includes(rememberMeKey);

        const hashedPassword = hashedPasswordFragment || hashedPasswordQuery;
        const rememberMe = rememberMeFragment || rememberMeQuery;

        if (hashedPassword) {
            return handleDecryptionOfPageFromHash(hashedPassword, rememberMe);
        }

        return false;
    }

    return exports;
}
exports.init = init;

  return exports;
})());
            const templateError = "Bad password!",
                templateToggleAltShow = "Show password",
                templateToggleAltHide = "Hide password",
                isRememberEnabled = true,
                staticryptConfig = {"staticryptEncryptedMsgUniqueVariableName":"cf4fbc73b5ac7f8001941d7845a3e79a7101f967f1034ec0a2ecad0be03df225b994ecb54f9546b9c5f0a07841376dd1ff8e41217a0a38e09baaae56685698cb3bff4d566f8f59606a2f550f2ab80d1369e2a1b6b2ae7fa886ce92dba76be6645952fd137ea196cbbb499c88fa0c8a95278f58d87243a63f37e298c591e8ed9eb1d8debf794fb77698bd761cef1ed45b4ef69e8e043cda5c958a4a3be87f568eb03a9e6ff9ec21b17c011258774cd5b98c8cacd625bf708fc2ca075b20f8bd2aafaa0dd85d12645cda46077bccd112e3b776a52bd0e76d2c77d30fdf0fe794f8804970d0ebe013ab9cdb31fb3f239c1a52fb72842864930ab7c0fcf75ec4b633252b22c33fc11273498f84af7b4367cc3b91fbeee99bf08e059ad413ae42561824ec8e3bc5e5ded9ed0c4dcdf78d98d342333d17d644655622a462e04e49f32d241a5703a36f4d85e4ec9a56adc978a4c31461f61c9732bd88d5738e646bd62db3e07ca7ead8057d682d6caa24298207588c3819cc1d7fc1c182f373a1275455a23430e7f643860bd0e4018662b9c4c71e8d933d1c2101a43d29edf6a51f4a110965a1f0fb2e3ed884b8b879b6f48bf653761ac183262e023c2b8b5f3da8669b6d7525bc912e38be81af661db6725bba90a178afb3edcb3d6755e4fcd5865eddaaa2e220cdf7c412ad16b05638fb3eb28c4a7c7ad4513476598d4840816773981fb234db9a6dda6f7212d8b7c17a755b214da88a8a58cee21f772686c00435799b9689ffd0f11614d5338d26569c1ef17018deeac02a607488673715f9ed3c7fbceabddf6d64cea2d5db63ebd5421dd0787dcdeddb97c9ffa52f6a6bbed42215b30b4e90910dae9d5061606a7fcb1fd7c4cab309f25fd1db5d531eccc501178d1c4a7493231030f8ec983263cba2c370b73826fcb9a10eb622f2f87302ba6eb1d4b3ba138bcb3f92ae616d9ef3b6a1f2119d2df536edb64dcaae52264cdf57173c7a262b90f774779d4215248c0bd3f5f91cbbb2b6442f3fa5c807866936f032c78daa754f2bcb82e1df289f13fa7190077f3f0f5b3579844f0ab4633b2b4a0cab9454f7adbce14eff053276746af9d9fd41cc53b8799d0a8b5e6003d9665ae051a8ef292cadf32e70f0bf53a999134c20903c32fb9f645f6793ce0fa626019378769a45008cee0baa546710a7d0d403b574dd83009451faabf3084321f131266607cd5a99aa5aa6bbc14e0cd4cd52333ba441c8134e1f6c2f80ab11e5b24340e689bba7b3e8fdad036c78ffb833b1725212b5b6d48198755f0ddfe97149d75a4e225ac67f311a2bc5bf8542caa17fa0285e3c268e990670d26ba26173a2669721098cb72929f717267d3c84ada32b56bdccd0180ef4505f804112bba46ee6dc1eb46bd998839c4aa07b3616126d1d26c95d63ea4b4eddcc1d7a9567d71413702e6bd9ba38fe8256de05d6c6d807b4c62577acf6b62b14e847099d07657b2e0c7e4f6f72812df5453d34fa9ff9d9e1ef62608d3b2cb72b91ee9c38d81cfec52bae5e8146b8a643087c6c62d730e9e925a930172e3ca234764b8a577b138ec3122a7b45c98fe528c9406987dc58eab9f849a429542bea62563c982a9317762af3be0b2ad5bcd4c9a8cc78a61a12873492768dcbc5bcad054bb94e7457541654f22e34ae872c711b4d5b1aec26fc179e3533bbaf48e20b90e4a497474db4791613208b353e585c2aab288ade71b2955481fb389436c6d138ec86a39466c75bf1c41509c59772afa416dfe608878c1abc8032085a507b9c42ced9ac3b7efe5d3ac1ccad88d93fb919006bd2aa36d683bd4fb1e68507643dfcc1b82c25825c89d8643d85a46f6a6d109a5cefa0a5f876b993cb719b8240b988fc24f395bdb6c5089989315458f48f98baec6d1f5ac20dfe53f1846b24f71259510fde41315d8d224031109ecf1c2e5820c308c6831ceb5e9021854f66bdcba473846896d5817bd77dc4c248942b51bc94be766b003259110a6ebb31fe5ce9d9ba954809f6f9427bb7c8d757e996b29d8a750ef1453e43f2562ef4741af631e7a4e55ec8005d2e7f19b4994b90ef1e1cd6a4244f2bcc4992d61936a16062ff8337bdbea61d71c103e18d9cac9ef7f14781447279d9f80a3f2e240b108192761125513ec97302beaf2e106f8508981471d79dd5c232b0bf729606b74f0631cbb85b9296f99415ae32fd8ebfabf8474bcf4bb53181cff4d38e243cba32b7819c93e46c9f2ae480718cb4b6d842c89861f9184c12bf8f6ac26b75c00d83e4eebf35988bbb1a1d7bf11845592d5f883f9102d37dc0d95b7214673d11369922e42361d9e9cc61d1279cb6ae671ff9f69baafa9c6e1b2f85d830e1df23b158e374bcd72a1cc1a63d81d7950c85fa33676270b21a259310e09294d4e3a60488139b3ab8be6811489d6af8d7986d41af7d499f608e514e98fc001f74d89e8932d46bbc1848595cf713ff28cbfa2574c1ee3d26fb778dd5d28e9bd57dbed71f59a9d7935472dcf252f1d7a5a3141c7cff47f0dd8e24d90b49372062b97bf7c2ddf472f59bc5dfba002233b9be038fe3895a20a614c57cd2fe08b5626d3bd4495959b8ad139992142a78e8ec2812154c9a9dd683963913861a9f54c2cab49b01d9a6779b6cf9bcf693795f14c00e124660fd70a0e02e5de35aebb5e79bc6d929ae658617967ae3de481c557ab389b899655f41c774a78fe420fc828270ae5d56d3d16cdddeca286f2c30e529bb9b1ad2d63a0f3e49f8b11749ef2798fc3e487d1f2d7246eb05b3108702918a7ee572f56122234ab068df974feda6636aa78fd690d9fbe9331374184022d82ac2bde12bd65281d13a51cdb9ce04c06ef5829faa0d52f0f6261a701186ebd6f419b574b4bf47d4cbc661f35732007a9487a26f60e8f6a1bdea17cbb1c0eee46490c7dcdb89c93df8973b131225d712d00f348da771610d9b7659e6898d80c7e8c4c636c158d357a18862d2e02e5afff4ec726d877e4a604c471c8ff7f03d3982422917496e4323784fa8c2a7b12d762990a786dc822ea4ee2af4358f06a4d330d75f64a196bd9c6be5e2e38fea361ca471b2e0526e08de423ff6334db901bdc21bc01ca4c0120feffb04f2b1c00a0ab75ef7b23b97b2c6746b144a3b201eb05cb605d93408f2c77c5db05e8283b89b5ce765a4a883c478090fc3bc6c64c508bcb36ff10fb00ce75a41a69e16349a9c414929de2999fae5816cbb8d01ed53e77a7e91e8f30576a9e60f3634f92a4eb739584980cc0ea408d42f77673aedd84fc28ed89e1b87ad9629ad5570f6aa3e89bcb8e1da6a2b475d5a5d1efe6d207e7676ea8840d81aa139b9938d5560065fae750a5466970703034fbd5c13bcb0ec68e4c349f8bb23f1c07b42d373ac3f49b14dbf44d07fcc57fbd34db1bd7eb224f8a8b61fce2e69d84759cde9c0ff415e4e0087e3ec1bdb460f099a9d578100dbea7110e8c918f5d8e1d1ac827e363fb789207c33762031ec102af84b97b77c0bf44c640783082184f08357c2f29989e5a1eb6dc77c3ea9e93f438b46d61bd797927bfcd708208323322026866f9f94a7751b9008d47b9fc0b276703dcf29135aee46bbdc5a7fb166c4448405c0ffc5dfee31908a649f28d48e011e6c40587a862735ac1293ec8143f7b288c87ccf7828b2066370eae7f859d0dec0321591f676bd3c3284c74591257b3a4dbd436f4cc9fe786bac3e73ac9114ae5a55ee6098f7531586b89b75b72109744ede3913e38fc84829d2325bd019c4900ba28470f8a6dd71ac509ef0ce76e047de3c2ca36ccd8c2584beafa9037351b7f9a1e235a993f8775141894e0b5b39c2343d5290549a761874f051198c4ef2472f403403825716e43139b46be3ecab1d46bb7ae5419e6963019e5e1be49bfb7ae27e7fb28e9fba3e1d5a7095b4add7524e7029d641b1c365007b68f1762436e779ecdc41b4c65842db40d62f0d97f6709f9af56344fd3133cd25c2da6468ad3d4a69b57cea09beb880a35a2fffdad5ea3191e8a1ed03d6904f5afc7d8475faf4ad3827801f6bfe72816667f73a431c768f3cf9ce98ba65afc7a16857e00c20754cdced65ed42ef3c86d247996f5009040a669127f279dc40fe5e8a5fb578c1f128b99fa02cc0b1d12b75c4bcb5c2e73df2b9ba1782beee78295879a06820a8451156a6183089f84d56205bfe288568aa1206d3abe07f5319e6e5f1d637902e638959e4a76ce354ba6cf9f7e441cd5d99cd187e6793c51003a88bd7aa0386926e343873acf428dfd2238fed94276a0a6fb68edb3d718fad93245790ee8b9b974cab9766ef92fdff187fea6b6f4c54cb0f05212dbde795b380cb45535205689247a984210730057070042807fa841760bc48ee068efb18ea3a175a1b89860006b04ff4c12778f923b01b9b4e4399b99c341d6500e486301e32f2dda77d78ab7a21e028dc3c016d2f0f741d141bae118ca0b762337a18b62bed4ab217c006a80dc9777ec8f079e29576f25b5ab90f5fa58635f4ea3115afb97470e081beafcea0fe0771437b9d97a4a2b592bd79bd637bad8ddce042dd69795b87a198685faa8569dbee64fb22e62b7ccd316b56895ce68c22f5eb0f14a3b9c9dbb244f8e9676d5a938adabea175ed766c5bf24fcc2a6224be031e1b212949f037355fb7d212f8c9d1016533200b970bfbd3db52689459b01c10e8b6ffa83aa6ac1d21399e90223af814732df6677ba608c8c4c893fbc88c458ad7f78ed8a5b14e4d6a4c0363b29cd5b366eaea14931b88fef964c9c7c3ff4df07a73b134a22852dc4f2c62935653ce6e2fe600121d3793e2633779d3c07a4d8b5473a09a02ea7d4dbd1ebe6cd088f1ceca4988c282a2ec02a88d9d33b16a736fb42020a7c4def7016710ddb6e3ed3506478341e0f861c9d6aa77b4eba5ac2db920c5795e855299ee9c085aa9743f6dee136e1473ecf18e3d76fa8795310d65462b55a39f27f12235b50158f419e456dc8605b258c4a4c30a612076dc84c76b461dd2ec9cd80a362f58f649f460338b51410387e0dafad876b3d6bb256a0c057a090b5453d3c7169c56c65db27518c79296760c4f4af6a751261c88b45f6f733eddd4a2c3a42ec2683c58a27acaf1b19286b7ac6da9785619e732b17855c43c8e48b1fdb70b745e3d30ccd852edfd8db373fca4235310c4c919184975a3317d7fd71ea12325aa5ddafebc95b39e973663b8e7dc1e9b015f09e3cbf51fa1f05f02b878b5fda8987668415e062227ad1bd0f861deeb1fb239de436433869f8c2772889d8be26bd3fc2158bd2d7c75240f77a747cd60ea1f74ea41f62e4b77e3138c3b8b4f6e9ec15c8a1e957f4390e4a866cd52050423ba2137750dbf39b14273e203ad537882cdc82be17b37de4ed9f14c84eaf83921e5e4bba8bfc13bd2f28663c7a3c7c354851baa2fe760caa36e0835d9f871f89a67d013d6c8e2f05801e2e5d858e4614cd5f855e806491a5920ec37e6c987e49f90d1d7292e19b4ae71c3f5f030de66176339b5e3a7c617184c188ad86bb90e161d949d7378db6cd1d392410fd397bcc45421855aa1a08ffdac32ca9336254f72ff39dc9a881b1fb80123536b3b59a560dfc1997dfe551b7a3a7bd5742c9c37f074b494935a5e1a35bfd9644e5415030bd9cd8da376feaf6c8cb6b5f8397bb7bc0e3137846c25a784d29268ea00bc079a9b65f075be7af309e2bc73ccee01ec72b90d697e963638b010430e0b2fe164e64e7cbf641a51083594ee10803292def56c0efd51489cd7be592c3664b1c16b3adcb4eb5c7278c64fdff9f576ecd33b851524f9520e9cf85ae9d4eb1c8269916962d7051fe030297f0d828e7ab6bce476f0a28b66057294986f3adaea043dc1c7d37bc82c3ef5f44f3bdd86d682dcb0fb88d0420079ab5ac0be90fade8fb82efb9898efb562963ba6407a0e8ac8a3e244a4ad37936a74fec0864f08a62909ba39780579c6f4bd45ca7c0e5b12119b2323d03b4abf0bde156a8438cd744990d485bf9413e59121491c0c940b821a0247eca1f0a9f6fc276d5eecfb677253066b3037ae468946e6077e13c5883dcd505b93f06ef33318de08ed347d9bf4c0d4d0995992ca29d736f9b40564684999c8b20f052a75412a4e78f4cfb97d1ab845829694cca6778b115f84afa88eae9d319122f253f2931c6fbcdcb70824a432f79c21da4206878ec12e74b032e527cdbc9a51312b33c36941cf2ab734784294bad612fa1be69930e9d32d3780af0eea6302e443e022299e06a303181bb793f102198b9304f658d0e714cccad13c08d00cfb0ecf871e4c4ad7c6fa0e042e41478d7abb80dcf84b0e0c4e260f68024668818b6a217deddaccbb7a9c84768feb8e6e205ae33d828952d0b1bafdeedc45a87afa57f6814cb9bac910c47c6114efaef2b086b57895a6ae653f67b45ad767e77f22fa3e1e1774e3164fc2b453da373c7996df375824770b4f66e5ec40c4e30a65f7bd35d85493bcb9c577a6c48ebd599f46a5ba5874aaf616745b7aa844016ea22a92f0b64e33988cc66f0ce974234516fe4db98c504191079a7543664e7cee03e15c967d58fc4492b1420eb5a691ae93b6337d0ffe0a85db5c20a676504bc955f63b17d78d3f808fec33ed16285d007f2536885b934420a048e479e8926f6370bbaa3a724b4817cdd792e26b135fa2a4e138761c9beb72c37b54399203c246b6baa2d09b669a5668a5f2eef4a2d2545c8ea9c9c7f14485e233fcef84a7ffa291a5fa9429ef3ae8da76f8ce270988932cec8fb48044e42a36a3a8dd16726fc5b377c0c4974d6a53a4ec7016185e856228e401f722e4440e30af1506b962d056a743af713d3aa5d1fd8cf9610f4b76c0150d7e51688d8149bac2c52980311d84e66cc873551b29669a4146dd5e87e4bf0094d4512b523136b0605ad52213cf8bec3e04bc078cab3ca06485269f35fab0f35026bc6f7e4051643bb779c001275d5989b4a2893d34c2dbbb015deb89d88be45e56276e053e0281a5daefa1243290a4815d4f96c715113781556c5af759fc7919eb07ae4ceb3f0ab1814c73bb1b2bf110981828f7b788b52a4365ed001133792f6d5fbeb0f036486ba9e5da4ee2334bdf22537ff81a8ea5001d0c06d5e6f5d49aa6b41af087d70251894f82f66ae7b501bba744c8fcc3ded433756d066e7d57dbb04b47da9dbc46257a2fd1d566c9c9fa01910efb5186e3bbf0d09ada895d9fb11fa298bd1c2852d9eb6f2912ce90fc3b27015f8dc2367206f83fcc19f56dd670e0b9971145475d4271619f728b70b9e94a56bfbe801a50cd26b5924c6490b9f1b3c9a3cab3171f17705868df7b2f8987a408cc46a49a7dee5b082835e0b896007f4d56f11c7c804d9f81e4bb26aafe8118314e343e09f56aac871d078ac19cc30e72bc9b389f242ca8b579bb291583ef10b8f420e5d484a5e3f5dc36a8975cfe021da2065126a856f9d412ec92630e4b45969fe7b6aa6d3ddd856907a5e2db5473ca53097973f47047e1c8a29d67ef7785700a0e06d2c81a70ae0f803892affb32ff8c1d8147bb6955e86d42f8c7ffa50a672803870d27f9065b31d53206440598697bebd2c792b6bf5c3d0f4a5ed3a6da82e32660b0405109e5aabbebe40f9aa7ece3c9ca2c6e299351394db8df4f4af502d3fef34b4012e15adf07e51655cc9dd7957ca0795ca30f3910e7d97d7a05873c63df38d23f57a415c7ff7190984a043b362f90dbf77212442d72219db38f28ad270406a54e4e8070098c6c1252314e54cd62f731107c781d3c0662e44ef039db18ab69ba828269e970fe61a80b1c47a3e62ba98cb5639e336b4f91c88a50205ebea8bb4d63d50de504cf977914644f7fe61ea1fbee784e986d34cece86898fca87d3d3679e36e006ecbf68dc2ad0fdefaba9bc9991cfe982da20d771e45bbf3b0752b6a4d64c5462b0f9826a0bcc74d547bfca1ae8d6dad2ceb2e65aacc906e09f7d771eee314d9b9d283145bd1247876662d03ef8ec36773f7aeae9b2a8fd48d903659070ed764b3282dc491084b5a3a55f199248b38ba4fa31d8c46ec531e93d7989789e3550476ba0ab414ec54b82940440eeffe2b915edb493eb19b28f278b70a8790bd526bd4cc0b7e57c0f10b53434f6f6d6c56ae9b5c8620d141b5644e4fcafb290252e07788ec10f5fa0437d74f80596b6c8c90f12acefcee71ab96f351ff2aa70c40927e20c363f84a8d6300ba018852bebd697b95e6a3ed0a54094bca64c130c89484313431a779b912c1caac464550cd062d673827a27f53896652320f465da2305d1719fc9f192ce4146b9e2aa39770cb48833463841f5f41d5cfb8f6cfc1c64b9d305b8c6f1728e7bcd3a12927bf80b1d844b7a6299d860359490d98b2cb7345d5bd1286b56f5623569c0aec9f95a4e2db3f5678c6a7832840a192f41240a14d27f20be39755f9be418c8d8c45bcde5ff1d115e5aa0e985de3fa8a60e1ffc070e36fa7e187a127cf76fa06d80cc18cdb70b111342795f0a50c2a1fa1e802f9b5cbc92c1f964a9b74de07c408274e92a1761151e041e2d07af6ee08fe7f25e891503d5385650acf6acbd0907300b9147b53d94cd9a4256556d3cb658c3439b2f4843110de7db7693d5ed9478af753b383d82ab3449cffae03271d5146503d8faecbf98d35b046d0b12f9db9135570f3cea06c76152af44a74b831f99cdf24366daf7cdb88304d2047d692154cd5a4fb9fbaa32a13d8e74eeb41ac89dc8e2bb498d6ae6533f7583030c5cac11910da625dc1bb0b875a155935f7ec731220f5a6abe3e1d71279e53780c301ccc79b5ef87d2a46e6ad3f4ea946412b51ff7006e24ec41e263ed7bf425c475dffcb8371f2441e4cd77861adea84c3404953b952f5ed3333566acdc906c6ad36f80e85ff85bcb36204c7d6aa094fadebbf8cb1b9690b218968ade5bfd6a0e0659c093a426ddd5e4cccc313286714ed0c99d0a599adc0b84502300f7fe9d6e0f6a76accd39100a364ff604252e48c080d26231b7b27e58bafc30125a8b20a7a9e421d0fbbd20b1679ad954cf66110a533e1c0057784862b86ff0e3a78393230cc933e27eada961192bdf32495418c38b423dcd63be35d7d4d36d23d71f2277937b9bffb4b2c822f2ceceec5b55398e94c6538d58c3304887b10530a5ad983df6e66034b649b25bb26bbb9cb3652e605fb963004e3c62238100db4dd197ea8e8d59c61535139ca0b7f4f96c099e60971f32eb567970263ba2cd99abffb8f0d4dac54c70fc9c478cc1e770d0a66978d55f00bfbed5f16922e6212f4574f200e3048e659243ac18d97cdbd4d2c07399b6e5ede02ff1c6916d56473f0f1e2c429569491d82b21fab2e91f37e3b694a82d23f34fdd57a2c4b9965603a466aba81c4afaa0f0d79514ac976147546447e2e78f341f12f7532ae156810b3a497aa700bb529270fe06a886b4fe5d292c26c87179dded664815cf5053feb2e4f98f42fe75f9969d45f7a9c1efc0ec2124a64681943e70d51924243ffe99c79528002b2d830bb17312585f1accec743fc8be171333e3088fbfd448cf13d699585540ed0acc47633841fc0c8207843ea115f4b45ea5432191b3bde0417765a812eb5610e189952e5ab1625211505d4de0848621b113bb98d247bc8566f7310e38e9b3e4d1a5dab73c03a065ec00bd23c9f7c10b739a0cf18bdb51fd33f04058311add41c3f7dda979e1aca342b570f1d4df724553497e2fe93e89c3f0ce78a9893ca79b88a12e1803370fe238cbdaa13cc3ef1c1e091a6e19043af90bf57a17e70f03a1a3382384e85510761215dd59cb47472ac48f25ab442c5572ec88f4b9547e6ec8fd4f94cf5d491b68eeaa1e50efdddb1e177efccd30846f8e3f620b611dde843118598035b14428489569f251ec2fce563a71d861325a05e99c6f81b38950c98a4ee7ffce3d84ca295169de1d4eeb49b4a34ca23e899660611c93a859afd265203d38565514ef317df73d14f9e87eaadf3e15bafc0b62bf70fe9c4bc8491d5a4e2b035bd7197407cdad3e21394a2b9d5bbcb80efad1efd7508405c4aff9564f2a9f0970da7c701461ea5a51fde6d3afd7f5e09569a88da79b15c487d8be257918a927334f9c5fdec142c2e76e5b26a785a473f7d6854c2af134f8ab161723cda852b0d11ae1631f13fb26c2419b0bda24f5608184c534c3b1e788c8f95da60aef91109766c4b0ba457450ff1fb1f0089f9b5d58b2ffe3a27e9d0d8f721b8892460fb6eca5887051b33dbf651b8320586365f819b36e68a4548a86815d7675da3650d7c4aaee950e4f515bc4a143db7581c6579a2552fe14be41265fa294cad59d4ff799d5a252551643f2835a1843ee740022b82a7e29ad35f012b969fa1fdb498456213740e628cf222f26debd10bdd29534f51d999721a666f227fff75a22aac2c28cea3b519af1520ee86ee4525253119ab2cd57735ce628abe51a9bb9f59eaae52f043fb8249d6c1db9d6821f9fb53205158a97eb1a262aba6d6d36dba04f148b094dc2fdedd50560502866d89118e82080ac9f41b16fec25b05b8be6a69a29940b411d9a0086c22e15ae03c9d21134fb0976879a9c5ad594f71ccb86ff2294d4fb49d0549c2fbbf84544b106526583c10ae6312e66874ca2825d9d1f6c18b5d279640188eff2d0fc3a1efc3fefab6e359f527deeb7ea5c1bca6a61f582dbcacd36982d20d4ffba501a784016e7641823ead97fa2e995a99c13c555e0e9d927dab2f376b503699d48ad8e619549e5aabc2601e8d214f2bcc96de97f071dcf86965f07e28f0f791c3fbaf350e8b64a99e6a1b47e795be5c6a061cae4cb72c30a827faea1e306c532127c6a393a01dcfbe0e1193e465b8f56b1e1096f0b0000b6a777fe7f0e2179ceeb0e5f8cd07311733523c57620fb14d339f54d86e2f771237da15c8e633e4d2f69482faf2dd4ba5f8bb64db5ccb1f874bffb404b02964bdf9f490a0e71e9a4d7974caa808de6d77e9b5f3b763faa9f2bca5e66844c53bb16763b7d9b42b5fe2310dbf4367e25d77f20441b2cb4e75a32fe749f9dcc550a68536814b563be20d1d1a076a5e9687579cf5b9f5ea16ed539ae70bb875b49192b34553be5392aa0a35bda5edf56cc3835d2d9c7262d181cc57315b8d07de202272828ed7f96c10594d6ed882a2c3a72858bad167e717b9d3c53143c350a16058725ab3375d0b71343fe9d23dca65fa40d3774f278f063a4ccf9186e9d749605975376c0fd8e1000127ea0c3633df9e84982f6e5dcca013c68f83a31085e3e78caa04049a041d318788c1ca32e3135ff686a586a9dde545346aec98f7e8b6e1ec2f5eca36cd3c1a31e7b0ef029e9bd7b68b1dd82a589c43f2fbc13cbf53fa819db90916e718aa343ceae60a5ae70bfe2f5d7ae0e8b4b6d0433913d65ce89f85cc104bde21d4e57f4ae425887c73e6d0cb6bd66741bb1fb8a2e40d3a6d98fc9032bff90ef3807eecf30c7f57b3ddff12f5c3446fe9645ff8007370141005e3725693443a117fb730302c8f8f65444b7e4e533eb771764c57780eed72379f0324e2a6b63605b37f6a4540cac9607b3c27c98cae4bdf46a7a69fc93e545a30e3b05a2e003e720921974d40fc7d34fe4843aea7eddb6b1aa85cc5cdcbcb0acab1930fc5f2b85537446f2ea71a8ed8eda487a99090ecfffb9c936f8552b538027ecbda4d9206f690e160789d277943ac0d5268a64b5403c437c4f0bf557f8d72169f11f701a63b436b15cb359c8a692b9fbeb5d6bea09df377a55c09df438c4676b4124d5ea803ea8b30cefff82c7b3831d8e613fe7a89b3e20f12a36082959950b12ab61d215f2d9ac0514fbb44b4120e9c9f859a36ffc0a99f6a5ee7592c37a00b739c7fd93011b76e379bd6e5b9e715627da1c602adcdbd1bd3751d96518f21800a3525c1c7bb6a73d49521b898085669a96515992ed89cf3b031bbcde1b221d54f920ba28a87bea5e17fc2c548080409fd83c1ce8eaa3ab3a417df2d658b84ee25379dbb50f78f2d768a3e2e1dba092b967d205e645ac27d9c697775fc97ef13be278a9091acd209e293f099302becb361b9e1e5a099d94ac1af684476fea95a1f1837421e3d7a6c4ca86ec834170165b0ff4bf9d82d20d8afa9ecbc2d231ff09809f2794b5e2c8f69b9f6326a663c804a2fbcfa72b96e725f4a559b4f7b0a3f11ab6a48937b899330aaf24cbafa9fe062fe796ec786a674d7b09f50b507a409261eb2721cdb20dbe9a3405d1cc9a525e4f8e783b6ffdb763b1e165fff6101ef9c3643a796933a14d67af61b2718db844acc094b77a54467cc63e95c1fe96d39b228132b48adeefc5d130eacc3a0f590b8d1e9df4a363c40f8193ad33f8f886067a8248dad4b98978401c3d221e4ae3c37d59b16c6fbd324cbc2912307019f3f220ef95fb37d3b2513295692e1f4fc38d1b1d2bdd2c96281f440dca6eeb4ac40b2bc8733e79b0a223256d26f4d17f998f4e342f87712d3b2f0ab468b8679278d390ee2ea4988b326ef2d2f71efd17f7a98081e41597708c30600ef1b76fe82641e80c7622bcac184969d70a925c66eb7369a463b03453dad1d82f43445cd0721c396e6aaecc6bf4ad4c1b7561cc3ee4cb3ba4e780f729225edb9aec8ae4e05d0f6b18c207e1a92a6c21713ebccf35308dea8b13d04bf11a18e4b728308e3870df3981cf2413200ca1661ca9daa5a6876c1afca55437a9641e45bed5274246482f2ed3fd9bfdd8067b48111186ee0a5fe938f8f5a5b5aeb27e737a3b615b5aa1ab5ca99948da748e727dcac16dd07ed7c77373daa2bdde1ac6d0190bac082ae9ed9d56dfdbfe6a3b758c78c4d779c627b2ad4b8bb0dc54525281d63ad48c4c01d3bb789f18d53369bd2c0b7c87ec61a0bb0ab0497537f833c778fb330a85c6070519fca18767ea080262c4c7601bb2bea3477f345ed0d80b6c0c14b629646ca9b233b7b64447557aa66eb53d133a5118f7030c9aefac5f91eb757b9c6013f1045340633a391918535112e7a0f82578ddc7178c26f509f580aed5c690d1ed525035ee2fada4bebd2b63ba55226260adbacd3f34e5ed340c5382ab1839696f1a9e0cb0b5d0f040cf44923a6bc6416d8426f89a84db279ed5f76969f7bba272c199f5253a1731b2417686a575eb43f21f87db4b8c9b0638f7be8a8d9095b8c79af77890cf3b303653cb8b1e00e8f7bfa17ed484505aa5e70ce1fb231d46b2683365f4f0be5abf13e1770bdb8b97b290e77a11421d3db77fd48c46c44a99aed730f0ff55cf4c3c61cad7d153e85d2a2da4f8f848572e9d0e786025d28c2aa7c6b25aac6d134e44d3d020ca484c2c4a944aac3248f08774a654df4f04338b198b61e95fd1697c7b08152964067ecdfd8a8c259d6530d5974d49a4b70767d5d62793cfdab764f5048c844d41bde47cfca4d3411b3b2a1ed738ad9b0b495734a6c64e5256df3acf1a4c27e5fdc1013db2602ecc4cc018f0df431493f8eb1ca20a37af6d57b5f544436456c78e54a01b2b30f06efaf99255e2acdcefa9c3a84d17cc212dcf60fbcb06b89fe4d97e365422afb539975ccb7f85cbf390d81dc81c6b1361549b8324e96cf0c5ea753372d78d1a9e10bb67a0a4ad293b2c01d7f556b1c43f1af27f1ed6274fc0187642103fdd5da61982dc2efc0cdd5caa30aaae2e42e8d21416d6a4aa61bdcaa6cbd3235b85cb04ede114868dae255bc3f2c7fa31d7d2b7db300c3518a64f723d7fb1476fc037d3bc3b6576e44c90f168c0274b4063d872b4359da659d2d731493f1d7ac1f3714ec76de9b8f16af857c17f76f9c2ce3996c6e3876a179431304f1b326d7e02dc1dc57d0c4936d73d2da7d366c501ec46c260f2da9fd664271470dfa14fc9d762eab5005b498773848b0365dee8e9b931a84fea312c2adc03e3e101b118cef1c0f5855537e7be2ed8fc3768abf4abb58951f19ba5d45ccdfe88a09a88a7053d4dfae565acf193ea15065b94499dd97372f383dbf33f81ab075bed82852630a7b4f4aae05abc98f680456e0a267b73c6e66ff6df5b3f49d714712e1879f23830c3407f4a154c94127f44cba6f533c4026a51a7d2bee431ca0df4df94b436e63535727cad08e7c0a45010f5ace0796ffd4012dded894bb03caa6e8628ad40c9e5b891ad9de444820af2384c3f07b22d9530d45d3aa8d0a9a699df522a2d27339139a262670575998b4258c56880c86e50e296f37889f8c5183688d2a7fcdb232b227ba1f952627a40cd546880b0450a8efd81131cba6500d7c9fc5a07c9380121bd6301f5fad941982fb536edf7d55b589ef6a59e94138964fca05574d9d87fe150e316c91bc5f6d87db7efbb804700ce44b285280b0affadbc979a2bdc30bc47b3b0533ca2e86aa7db9e8f19c0b71f3291a30bdcbba83c0ca1b7db68445b8e4df66b40ae2463bc3ab6afef882b479be50336ff729e5f5988712d75f4ea7d685a538553cf5a11cf4c19e89aabc1e21a3f909d71c2f9a397301fe74f9f430a70951b01a86931a86715c08f40174a7d93629faaed5d9d74c988a38f2ab12098588f5648ae34474e11e0444504c22db90b95a58f0b67e151e1cc69837bbc522bc872f8943e5eddbc1e6566c7dcafdaeab784022a7174cdccc7f458611d13eaa482ece0d6e4bdd26e1eadbd8cab3a17dff6c08be4cae87d2e55feb5bd2b5b9a61437a1cdec5d99d74e9aa9d059203cffaf138041bb97d24e41774c611671c748f1022269ef2a053eb9ad7d553f779b8da953fb6f79c320dae3c83ed267c8a752ee6e91cdc4d545c64c47185561e326d7ab99e43596e819ed4b7efbbd64b5cf181c6120f3a65c000e4dbc100a5f2dc55159cb0924226854fb3d34524df16a6d3f18e873dcf62201c85e513f9688886f6c18a3fc43d9954250e44b8a2858fab3f0346837f6c8ba09d853eb29756e94f631cb5d5f093a1c8cf9bd15e61ca376fbc2ee37f047b1b0ed28e1d86ee5d14018741050fbce85cf0734a71bcc6f81a895298c9d411fd454511666e0b38f8bd07aa849ee2abb01e7c4c9f589716c18e151f530f3dd3b0e5f2e5529b6524e6947e85e8e2619651ced4d4d2cfdca1366e18a9000e5d0c0ed1334155356be6119e5a07ce5e4ff63b181cffe1927793086452743ff5fb3f52ef412ceaabeef486849b17b450d2a0655932ff6d99cf16279bced3d55d52eacbcca07f9ea36e3567cb967793b539d94b12d38f1fe6caf1bbaf24f81b1b0fd34c58feb9ddc6215a3693dc3420f6a55d0993372c109f7f67a6988870943534edb62cf866662a4b9885fb9b82605b4f677cffd4346cb7f3d","isRememberEnabled":true,"rememberDurationInDays":0,"staticryptSaltUniqueVariableName":"4290edf5ab9c348d0d7d0b9e329b1e38"};

            // you can edit these values to customize some of the behavior of StatiCrypt
            const templateConfig = {
                rememberExpirationKey: "staticrypt_expiration",
                rememberPassphraseKey: "staticrypt_passphrase",
                replaceHtmlCallback: null,
                clearLocalStorageCallback: null,
            };

            // init the staticrypt engine
            const staticrypt = staticryptInitiator.init(staticryptConfig, templateConfig);

            // try to automatically decrypt on load if there is a saved password
            window.onload = async function () {
                const { isSuccessful } = await staticrypt.handleDecryptOnLoad();

                // if we didn't decrypt anything on load, show the password prompt. Otherwise the content has already been
                // replaced, no need to do anything
                if (!isSuccessful) {
                    // hide loading screen
                    document.getElementById("staticrypt_loading").classList.add("hidden");
                    document.getElementById("staticrypt_content").classList.remove("hidden");
                    document.getElementById("staticrypt-password").focus();

                    // show the remember me checkbox
                    if (isRememberEnabled) {
                        document.getElementById("staticrypt-remember-label").classList.remove("hidden");
                    }
                }
            };

            // toggle password visibility
            const toggleIcon = document.querySelector(".staticrypt-toggle-password-visibility");
            // these two icons are coming from FontAwesome
            const imgSrcEyeClosed =
                "data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA2NDAgNTEyIj48IS0tIUZvbnQgQXdlc29tZSBGcmVlIDYuNS4yIGJ5IEBmb250YXdlc29tZSAtIGh0dHBzOi8vZm9udGF3ZXNvbWUuY29tIExpY2Vuc2UgLSBodHRwczovL2ZvbnRhd2Vzb21lLmNvbS9saWNlbnNlL2ZyZWUgQ29weXJpZ2h0IDIwMjQgRm9udGljb25zLCBJbmMuLS0+PHBhdGggZD0iTTM4LjggNS4xQzI4LjQtMy4xIDEzLjMtMS4yIDUuMSA5LjJTLTEuMiAzNC43IDkuMiA0Mi45bDU5MiA0NjRjMTAuNCA4LjIgMjUuNSA2LjMgMzMuNy00LjFzNi4zLTI1LjUtNC4xLTMzLjdMNTI1LjYgMzg2LjdjMzkuNi00MC42IDY2LjQtODYuMSA3OS45LTExOC40YzMuMy03LjkgMy4zLTE2LjcgMC0yNC42Yy0xNC45LTM1LjctNDYuMi04Ny43LTkzLTEzMS4xQzQ2NS41IDY4LjggNDAwLjggMzIgMzIwIDMyYy02OC4yIDAtMTI1IDI2LjMtMTY5LjMgNjAuOEwzOC44IDUuMXpNMjIzLjEgMTQ5LjVDMjQ4LjYgMTI2LjIgMjgyLjcgMTEyIDMyMCAxMTJjNzkuNSAwIDE0NCA2NC41IDE0NCAxNDRjMCAyNC45LTYuMyA0OC4zLTE3LjQgNjguN0w0MDggMjk0LjVjOC40LTE5LjMgMTAuNi00MS40IDQuOC02My4zYy0xMS4xLTQxLjUtNDcuOC02OS40LTg4LjYtNzEuMWMtNS44LS4yLTkuMiA2LjEtNy40IDExLjdjMi4xIDYuNCAzLjMgMTMuMiAzLjMgMjAuM2MwIDEwLjItMi40IDE5LjgtNi42IDI4LjNsLTkwLjMtNzAuOHpNMzczIDM4OS45Yy0xNi40IDYuNS0zNC4zIDEwLjEtNTMgMTAuMWMtNzkuNSAwLTE0NC02NC41LTE0NC0xNDRjMC02LjkgLjUtMTMuNiAxLjQtMjAuMkw4My4xIDE2MS41QzYwLjMgMTkxLjIgNDQgMjIwLjggMzQuNSAyNDMuN2MtMy4zIDcuOS0zLjMgMTYuNyAwIDI0LjZjMTQuOSAzNS43IDQ2LjIgODcuNyA5MyAxMzEuMUMxNzQuNSA0NDMuMiAyMzkuMiA0ODAgMzIwIDQ4MGM0Ny44IDAgODkuOS0xMi45IDEyNi4yLTMyLjVMMzczIDM4OS45eiIvPjwvc3ZnPg==";
            const imgSrcEyeOpened =
                "data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA1NzYgNTEyIj48IS0tIUZvbnQgQXdlc29tZSBGcmVlIDYuNS4yIGJ5IEBmb250YXdlc29tZSAtIGh0dHBzOi8vZm9udGF3ZXNvbWUuY29tIExpY2Vuc2UgLSBodHRwczovL2ZvbnRhd2Vzb21lLmNvbS9saWNlbnNlL2ZyZWUgQ29weXJpZ2h0IDIwMjQgRm9udGljb25zLCBJbmMuLS0+PHBhdGggZD0iTTI4OCAzMmMtODAuOCAwLTE0NS41IDM2LjgtMTkyLjYgODAuNkM0OC42IDE1NiAxNy4zIDIwOCAyLjUgMjQzLjdjLTMuMyA3LjktMy4zIDE2LjcgMCAyNC42QzE3LjMgMzA0IDQ4LjYgMzU2IDk1LjQgMzk5LjRDMTQyLjUgNDQzLjIgMjA3LjIgNDgwIDI4OCA0ODBzMTQ1LjUtMzYuOCAxOTIuNi04MC42YzQ2LjgtNDMuNSA3OC4xLTk1LjQgOTMtMTMxLjFjMy4zLTcuOSAzLjMtMTYuNyAwLTI0LjZjLTE0LjktMzUuNy00Ni4yLTg3LjctOTMtMTMxLjFDNDMzLjUgNjguOCAzNjguOCAzMiAyODggMzJ6TTE0NCAyNTZhMTQ0IDE0NCAwIDEgMSAyODggMCAxNDQgMTQ0IDAgMSAxIC0yODggMHptMTQ0LTY0YzAgMzUuMy0yOC43IDY0LTY0IDY0Yy03LjEgMC0xMy45LTEuMi0yMC4zLTMuM2MtNS41LTEuOC0xMS45IDEuNi0xMS43IDcuNGMuMyA2LjkgMS4zIDEzLjggMy4yIDIwLjdjMTMuNyA1MS4yIDY2LjQgODEuNiAxMTcuNiA2Ny45czgxLjYtNjYuNCA2Ny45LTExNy42Yy0xMS4xLTQxLjUtNDcuOC02OS40LTg4LjYtNzEuMWMtNS44LS4yLTkuMiA2LjEtNy40IDExLjdjMi4xIDYuNCAzLjMgMTMuMiAzLjMgMjAuM3oiLz48L3N2Zz4=";
            toggleIcon.addEventListener("click", function () {
                const passwordInput = document.getElementById("staticrypt-password");
                if (passwordInput.type === "password") {
                    passwordInput.type = "text";
                    toggleIcon.src = imgSrcEyeOpened;
                    toggleIcon.alt = templateToggleAltHide;
                    toggleIcon.title = templateToggleAltHide;
                } else {
                    passwordInput.type = "password";
                    toggleIcon.src = imgSrcEyeClosed;
                    toggleIcon.alt = templateToggleAltShow;
                    toggleIcon.title = templateToggleAltShow;
                }
            });

            // handle password form submission
            document.getElementById("staticrypt-form").addEventListener("submit", async function (e) {
                e.preventDefault();

                const password = document.getElementById("staticrypt-password").value,
                    isRememberChecked = document.getElementById("staticrypt-remember").checked;

                const { isSuccessful } = await staticrypt.handleDecryptionOfPage(password, isRememberChecked);

                if (!isSuccessful) {
                    alert(templateError);
                }
            });
        </script>
    </body>
</html>
